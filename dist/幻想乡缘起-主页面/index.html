<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>ç³»ç»ŸçŠ¶æ€</title><script type="module">import "https://testingcf.jsdelivr.net/npm/pinia/+esm";

var __webpack_modules__ = {
  800: (__unused_webpack_module, exports) => {
    var __webpack_unused_export__;
    __webpack_unused_export__ = {
      value: true
    };
    exports.A = (sfc, props) => {
      const target = sfc.__vccOpts || sfc;
      for (const [key, val] of props) {
        target[key] = val;
      }
      return target;
    };
  }
};

var __webpack_module_cache__ = {};

function __webpack_require__(moduleId) {
  var cachedModule = __webpack_module_cache__[moduleId];
  if (cachedModule !== undefined) {
    return cachedModule.exports;
  }
  var module = __webpack_module_cache__[moduleId] = {
    exports: {}
  };
  __webpack_modules__[moduleId](module, module.exports, __webpack_require__);
  return module.exports;
}

(() => {
  __webpack_require__.n = module => {
    var getter = module && module.__esModule ? () => module["default"] : () => module;
    __webpack_require__.d(getter, {
      a: getter
    });
    return getter;
  };
})();

(() => {
  __webpack_require__.d = (exports, definition) => {
    for (var key in definition) {
      if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
        Object.defineProperty(exports, key, {
          enumerable: true,
          get: definition[key]
        });
      }
    }
  };
})();

(() => {
  __webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);
})();

var __webpack_exports__ = {};

const external_Vue_namespaceObject = Vue;

const external_z_namespaceObject = z;

const mkValueSchema = external_z_namespaceObject.z.string().nullable();

const PeriodAnchorSchema = external_z_namespaceObject.z.object({
  newDawn: mkValueSchema,
  newMorning: mkValueSchema,
  newNoon: mkValueSchema,
  newAfternoon: mkValueSchema,
  newDusk: mkValueSchema,
  newNight: mkValueSchema,
  newFirstHalfNight: mkValueSchema,
  newSecondHalfNight: mkValueSchema
}).partial().default({});

const SeasonAnchorSchema = external_z_namespaceObject.z.object({
  newSpring: mkValueSchema,
  newSummer: mkValueSchema,
  newAutumn: mkValueSchema,
  newWinter: mkValueSchema
}).partial().default({});

const TimeChatMkAnchorsSchema = external_z_namespaceObject.z.object({
  newPeriod: mkValueSchema,
  period: PeriodAnchorSchema,
  newDay: mkValueSchema,
  newWeek: mkValueSchema,
  newMonth: mkValueSchema,
  newSeason: mkValueSchema,
  season: SeasonAnchorSchema,
  newYear: mkValueSchema
}).partial().default({});

const createEmptyAnchors = () => ({});

const TimeChatMkSyncCacheSchema = external_z_namespaceObject.z.object({
  anchors: TimeChatMkAnchorsSchema.optional()
}).optional().default(() => ({
  anchors: createEmptyAnchors()
}));

const TimeChatMkSyncRuntimeSchema = external_z_namespaceObject.z.object({
  anchors: TimeChatMkAnchorsSchema.optional()
}).optional().default(() => ({
  anchors: createEmptyAnchors()
}));

const BY_PERIOD_KEYS = null && TIME_PERIOD_KEYS;

const BY_SEASON_KEYS = null && TIME_SEASON_KEYS;

const ClockAckSchema = external_z_namespaceObject.z.object({
  dayID: external_z_namespaceObject.z.number(),
  weekID: external_z_namespaceObject.z.number(),
  monthID: external_z_namespaceObject.z.number(),
  yearID: external_z_namespaceObject.z.number(),
  periodID: external_z_namespaceObject.z.number(),
  periodIdx: external_z_namespaceObject.z.number(),
  seasonID: external_z_namespaceObject.z.number(),
  seasonIdx: external_z_namespaceObject.z.number()
});

const NowSchema = external_z_namespaceObject.z.object({
  iso: external_z_namespaceObject.z.string(),
  year: external_z_namespaceObject.z.number(),
  month: external_z_namespaceObject.z.number(),
  day: external_z_namespaceObject.z.number(),
  weekdayIndex: external_z_namespaceObject.z.number(),
  weekdayName: external_z_namespaceObject.z.string(),
  periodName: external_z_namespaceObject.z.string(),
  periodIdx: external_z_namespaceObject.z.number(),
  minutesSinceMidnight: external_z_namespaceObject.z.number(),
  seasonName: external_z_namespaceObject.z.string(),
  seasonIdx: external_z_namespaceObject.z.number(),
  hour: external_z_namespaceObject.z.number(),
  minute: external_z_namespaceObject.z.number(),
  hm: external_z_namespaceObject.z.string()
});

const ClockFlagsSchema = external_z_namespaceObject.z.object({
  newPeriod: external_z_namespaceObject.z.boolean(),
  byPeriod: external_z_namespaceObject.z.object({
    newDawn: external_z_namespaceObject.z.boolean(),
    newMorning: external_z_namespaceObject.z.boolean(),
    newNoon: external_z_namespaceObject.z.boolean(),
    newAfternoon: external_z_namespaceObject.z.boolean(),
    newDusk: external_z_namespaceObject.z.boolean(),
    newNight: external_z_namespaceObject.z.boolean(),
    newFirstHalfNight: external_z_namespaceObject.z.boolean(),
    newSecondHalfNight: external_z_namespaceObject.z.boolean()
  }),
  newDay: external_z_namespaceObject.z.boolean(),
  newWeek: external_z_namespaceObject.z.boolean(),
  newMonth: external_z_namespaceObject.z.boolean(),
  newSeason: external_z_namespaceObject.z.boolean(),
  bySeason: external_z_namespaceObject.z.object({
    newSpring: external_z_namespaceObject.z.boolean(),
    newSummer: external_z_namespaceObject.z.boolean(),
    newAutumn: external_z_namespaceObject.z.boolean(),
    newWinter: external_z_namespaceObject.z.boolean()
  }),
  newYear: external_z_namespaceObject.z.boolean()
});

const CLOCK_ROOT_FLAG_KEYS = null && [ "newPeriod", "newDay", "newWeek", "newMonth", "newSeason", "newYear" ];

const ClockSchema = external_z_namespaceObject.z.object({
  now: NowSchema,
  flags: ClockFlagsSchema,
  mkAnchors: TimeChatMkAnchorsSchema.optional(),
  previousMkAnchors: TimeChatMkAnchorsSchema.optional()
});

const EMPTY_NOW = {
  iso: "",
  year: 0,
  month: 0,
  day: 0,
  weekdayIndex: 0,
  weekdayName: "",
  periodName: "",
  periodIdx: 0,
  minutesSinceMidnight: 0,
  seasonName: "",
  seasonIdx: 0,
  hour: 0,
  minute: 0,
  hm: ""
};

const EMPTY_FLAGS = {
  newPeriod: false,
  byPeriod: {
    newDawn: false,
    newMorning: false,
    newNoon: false,
    newAfternoon: false,
    newDusk: false,
    newNight: false,
    newFirstHalfNight: false,
    newSecondHalfNight: false
  },
  newDay: false,
  newWeek: false,
  newMonth: false,
  newSeason: false,
  bySeason: {
    newSpring: false,
    newSummer: false,
    newAutumn: false,
    newWinter: false
  },
  newYear: false
};

const OtherCharacterInfoSchema = external_z_namespaceObject.z.object({
  name: external_z_namespaceObject.z.string(),
  target: external_z_namespaceObject.z.string()
});

const AyaNewsEntrySchema = external_z_namespaceObject.z.object({
  location: external_z_namespaceObject.z.string(),
  otherCharacters: external_z_namespaceObject.z.array(OtherCharacterInfoSchema),
  target: external_z_namespaceObject.z.string(),
  clockAck: ClockAckSchema
});

const AyaNewsSchema = external_z_namespaceObject.z.object({
  entries: external_z_namespaceObject.z.array(AyaNewsEntrySchema)
});

const ERA_EVENT_NAMES = {
  INSERT_BY_OBJECT: "era:insertByObject",
  UPDATE_BY_OBJECT: "era:updateByObject",
  INSERT_BY_PATH: "era:insertByPath",
  UPDATE_BY_PATH: "era:updateByPath",
  DELETE_BY_OBJECT: "era:deleteByObject",
  DELETE_BY_PATH: "era:deleteByPath",
  GET_CURRENT_VARS: "era:getCurrentVars",
  GET_SNAPSHOT_AT_MK: "era:getSnapshotAtMk",
  GET_SNAPSHOTS_BETWEEN_MKS: "era:getSnapshotsBetweenMks",
  GET_SNAPSHOT_AT_MID: "era:getSnapshotAtMId",
  GET_SNAPSHOTS_BETWEEN_MIDS: "era:getSnapshotsBetweenMIds",
  REQUEST_WRITE_DONE: "era:requestWriteDone"
};

const ERA_BROADCAST_EVENT_NAMES = {
  WRITE_DONE: "era:writeDone",
  QUERY_RESULT: "era:queryResult"
};

const QueryResultItemSchema = external_z_namespaceObject.z.object({
  mk: external_z_namespaceObject.z.string(),
  message_id: external_z_namespaceObject.z.number(),
  is_user: external_z_namespaceObject.z.boolean(),
  stat: external_z_namespaceObject.z.any(),
  statWithoutMeta: external_z_namespaceObject.z.any()
});

const PreprocessStringifiedObject = schema => external_z_namespaceObject.z.preprocess(val => {
  if (typeof val === "string") {
    try {
      return JSON.parse(val);
    } catch (e) {
      return val;
    }
  }
  return val;
}, schema);

const TimeUnitSchema = external_z_namespaceObject.z.enum([ "period", "day", "week", "month", "season", "year" ]);

const ForgettingRuleSchema = external_z_namespaceObject.z.object({
  triggerFlag: external_z_namespaceObject.z.string(),
  decrease: external_z_namespaceObject.z.number()
});

const AffectionStageWithForgetSchema = external_z_namespaceObject.z.object({
  threshold: external_z_namespaceObject.z.number(),
  name: external_z_namespaceObject.z.string(),
  describe: external_z_namespaceObject.z.string().nullable().optional(),
  patienceUnit: TimeUnitSchema.optional(),
  visit: external_z_namespaceObject.z.object({
    enabled: external_z_namespaceObject.z.boolean().optional(),
    probBase: external_z_namespaceObject.z.number().optional(),
    probK: external_z_namespaceObject.z.number().optional(),
    coolUnit: TimeUnitSchema.optional()
  }).optional(),
  forgettingSpeed: external_z_namespaceObject.z.array(PreprocessStringifiedObject(ForgettingRuleSchema)).optional(),
  affectionGrowthLimit: external_z_namespaceObject.z.object({
    max: external_z_namespaceObject.z.number(),
    divisor: external_z_namespaceObject.z.number()
  }).optional()
}).passthrough();

const ActionSchema = external_z_namespaceObject.z.object({
  do: external_z_namespaceObject.z.string(),
  to: external_z_namespaceObject.z.string().optional(),
  from: external_z_namespaceObject.z.string().optional(),
  source: external_z_namespaceObject.z.string().optional()
});

const EntrySchema = external_z_namespaceObject.z.object({
  when: external_z_namespaceObject.z.any(),
  action: ActionSchema,
  priority: external_z_namespaceObject.z.number().optional()
});

const EntryListSchema = external_z_namespaceObject.z.array(EntrySchema);

const EntryListPreprocessSchema = external_z_namespaceObject.z.array(PreprocessStringifiedObject(EntrySchema));

const CharacterSettingsSchema = external_z_namespaceObject.z.object({
  id: external_z_namespaceObject.z.string(),
  name: external_z_namespaceObject.z.string(),
  affectionStages: external_z_namespaceObject.z.array(AffectionStageWithForgetSchema),
  specials: EntryListPreprocessSchema,
  routine: EntryListPreprocessSchema
});

const CharacterSettingsMapSchema = external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), CharacterSettingsSchema);

const IncidentDetailSchema = external_z_namespaceObject.z.object({
  å¼‚å˜ç»†èŠ‚: external_z_namespaceObject.z.string(),
  ä¸»è¦åœ°åŒº: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  å¼‚å˜é€€æ²»è€…: external_z_namespaceObject.z.union([ external_z_namespaceObject.z.string(), external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()) ]).optional(),
  å¼‚å˜å·²ç»“æŸ: external_z_namespaceObject.z.boolean()
});

const IncidentsSchema = external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), IncidentDetailSchema);

const MapSizeSchema = external_z_namespaceObject.z.object({
  width: external_z_namespaceObject.z.number(),
  height: external_z_namespaceObject.z.number()
});

const MapPositionSchema = external_z_namespaceObject.z.object({
  x: external_z_namespaceObject.z.number(),
  y: external_z_namespaceObject.z.number()
});

const MapLeafSchema = external_z_namespaceObject.z.object({
  pos: MapPositionSchema,
  htmlEle: external_z_namespaceObject.z.string(),
  aliases: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()).default([])
}).passthrough();

const MapTreeSchema = external_z_namespaceObject.z.lazy(() => external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), external_z_namespaceObject.z.union([ MapLeafSchema, MapTreeSchema ])));

const MapGraphSchema = external_z_namespaceObject.z.object({
  mapSize: MapSizeSchema,
  tree: MapTreeSchema,
  edges: external_z_namespaceObject.z.array(PreprocessStringifiedObject(external_z_namespaceObject.z.object({
    a: external_z_namespaceObject.z.string(),
    b: external_z_namespaceObject.z.string()
  }))).optional(),
  aliases: external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), external_z_namespaceObject.z.array(external_z_namespaceObject.z.string())).optional()
});

const WORLD_DEFAULTS = {
  fallbackPlace: "åšä¸½ç¥ç¤¾",
  mainStoryTag: "gensokyo"
};

const WorldSchema = external_z_namespaceObject.z.object({
  map_graph: MapGraphSchema.optional(),
  fallbackPlace: external_z_namespaceObject.z.string().default(WORLD_DEFAULTS.fallbackPlace)
}).passthrough();

const ä¸–ç•ŒSchema = external_z_namespaceObject.z.object({
  timeProgress: external_z_namespaceObject.z.number()
}).passthrough();

const WEATHER_CONDITION_TYPES = [ "clear", "partly_cloudy", "overcast", "light_rain", "heavy_rain", "storm", "snow", "fog" ];

const WeatherConditionTypeEnum = external_z_namespaceObject.z.enum(WEATHER_CONDITION_TYPES);

const WeatherConditionSchema = external_z_namespaceObject.z.object({
  type: WeatherConditionTypeEnum,
  label: external_z_namespaceObject.z.string(),
  description: external_z_namespaceObject.z.string()
});

const WeatherTemperatureSchema = external_z_namespaceObject.z.object({
  minC: external_z_namespaceObject.z.number(),
  maxC: external_z_namespaceObject.z.number()
});

const WeatherDaySchema = external_z_namespaceObject.z.object({
  condition: WeatherConditionSchema,
  temperature: WeatherTemperatureSchema,
  precipitationChance: external_z_namespaceObject.z.number().min(0).max(1),
  humidity: external_z_namespaceObject.z.number().min(0).max(1),
  windLevel: external_z_namespaceObject.z.number().min(0),
  narrative: external_z_namespaceObject.z.string()
});

const WeatherRuntimeSchema = external_z_namespaceObject.z.object({
  generatedAtISO: external_z_namespaceObject.z.string(),
  anchorDayISO: external_z_namespaceObject.z.string(),
  days: external_z_namespaceObject.z.array(WeatherDaySchema).min(1)
});

const IncidentRuntimeInfoSchema = external_z_namespaceObject.z.object({
  name: external_z_namespaceObject.z.string(),
  detail: external_z_namespaceObject.z.string(),
  solver: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  mainLoc: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  isFinished: external_z_namespaceObject.z.boolean(),
  raw: IncidentDetailSchema
});

const runtime_ActionSchema = external_z_namespaceObject.z.object({
  do: external_z_namespaceObject.z.string(),
  to: external_z_namespaceObject.z.string().optional(),
  from: external_z_namespaceObject.z.string().optional(),
  source: external_z_namespaceObject.z.string().optional()
});

const IncidentSchema = external_z_namespaceObject.z.object({
  decision: external_z_namespaceObject.z.enum([ "continue", "start_new", "daily" ]),
  current: IncidentRuntimeInfoSchema.optional(),
  spawn: IncidentRuntimeInfoSchema.optional(),
  remainingCooldown: external_z_namespaceObject.z.number().optional(),
  isIncidentActive: external_z_namespaceObject.z.boolean()
});

const CurrentFestivalInfoSchema = external_z_namespaceObject.z.object({
  name: external_z_namespaceObject.z.string(),
  host: external_z_namespaceObject.z.string(),
  customs: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  month: external_z_namespaceObject.z.number(),
  start_day: external_z_namespaceObject.z.number(),
  end_day: external_z_namespaceObject.z.number()
});

const NextFestivalInfoSchema = CurrentFestivalInfoSchema.extend({
  days_until: external_z_namespaceObject.z.number()
});

const FestivalSchema = external_z_namespaceObject.z.object({
  ongoing: external_z_namespaceObject.z.boolean(),
  upcoming: external_z_namespaceObject.z.boolean(),
  current: CurrentFestivalInfoSchema.nullable(),
  next: NextFestivalInfoSchema.nullable()
});

const CharacterDistributionSchema = external_z_namespaceObject.z.object({
  playerLocation: external_z_namespaceObject.z.string().nullable(),
  npcByLocation: external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()))
});

const CharacterRuntimeSchema = external_z_namespaceObject.z.object({
  name: external_z_namespaceObject.z.string().optional(),
  affectionStage: AffectionStageWithForgetSchema.optional(),
  decision: runtime_ActionSchema.optional(),
  companionDecision: runtime_ActionSchema.optional()
});

const BfsPathSchema = external_z_namespaceObject.z.object({
  hops: external_z_namespaceObject.z.number(),
  steps: external_z_namespaceObject.z.array(external_z_namespaceObject.z.object({
    from: external_z_namespaceObject.z.string(),
    to: external_z_namespaceObject.z.string()
  }))
});

const RouteSchema = external_z_namespaceObject.z.object({
  destination: external_z_namespaceObject.z.string(),
  path: BfsPathSchema
});

const RouteInfoSchema = external_z_namespaceObject.z.object({
  candidates: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  routes: external_z_namespaceObject.z.array(RouteSchema)
});

const FullMapLeafSchema = MapLeafSchema.extend({
  name: external_z_namespaceObject.z.string()
});

const AreaRuntimeInfoSchema = external_z_namespaceObject.z.object({
  graph: external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), external_z_namespaceObject.z.boolean())),
  legal_locations: external_z_namespaceObject.z.array(FullMapLeafSchema),
  neighbors: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  loadArea: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  route: RouteInfoSchema,
  mapSize: MapSizeSchema.optional()
});

const RuntimeSchema = external_z_namespaceObject.z.object({
  incident: IncidentSchema.optional(),
  clock: ClockSchema.optional(),
  weather: WeatherRuntimeSchema.optional(),
  area: AreaRuntimeInfoSchema.optional(),
  festival: FestivalSchema.optional(),
  characterDistribution: CharacterDistributionSchema.optional(),
  character: external_z_namespaceObject.z.object({
    chars: external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), CharacterRuntimeSchema),
    partitions: external_z_namespaceObject.z.object({
      coLocated: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
      remote: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string())
    })
  }).optional(),
  characterLog: external_z_namespaceObject.z.object({}).passthrough().optional(),
  characterSettings: CharacterSettingsMapSchema.optional(),
  snapshots: external_z_namespaceObject.z.array(QueryResultItemSchema).optional(),
  ayaNews: AyaNewsSchema.optional()
});

const CharacterCacheSchema = external_z_namespaceObject.z.object({
  visit: external_z_namespaceObject.z.object({
    cooling: external_z_namespaceObject.z.boolean().optional()
  }).optional()
});

const IncidentCacheSchema = external_z_namespaceObject.z.object({
  incidentCooldownAnchor: external_z_namespaceObject.z.number().nullable().optional()
});

const CacheSchema = external_z_namespaceObject.z.object({
  time: external_z_namespaceObject.z.object({
    clockAck: ClockAckSchema.optional()
  }).optional().default({}),
  incident: IncidentCacheSchema.optional().default({}),
  character: external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), CharacterCacheSchema).optional().default({}),
  timeChatMkSync: TimeChatMkSyncCacheSchema.optional().default({})
});

const CharacterSchema = external_z_namespaceObject.z.object({
  name: external_z_namespaceObject.z.string(),
  å¥½æ„Ÿåº¦: external_z_namespaceObject.z.number(),
  æ‰€åœ¨åœ°åŒº: external_z_namespaceObject.z.string().nullable(),
  å±…ä½åœ°åŒº: external_z_namespaceObject.z.string().nullable(),
  affectionStages: external_z_namespaceObject.z.array(PreprocessStringifiedObject(AffectionStageWithForgetSchema)).default([]),
  specials: EntryListPreprocessSchema.default([]),
  routine: EntryListPreprocessSchema.default([]),
  ç›®æ ‡: external_z_namespaceObject.z.string().optional()
});

const CharsSchema = external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), CharacterSchema);

const CHARACTER_FIELDS = {
  affection: "å¥½æ„Ÿåº¦",
  currentLocation: "æ‰€åœ¨åœ°åŒº",
  home: "å±…ä½åœ°åŒº"
};

const UiConfigSchema = external_z_namespaceObject.z.object({
  theme: external_z_namespaceObject.z.enum([ "light", "dark" ]).default("light"),
  mainFontPercent: external_z_namespaceObject.z.number().default(100),
  fontScaleStepPct: external_z_namespaceObject.z.number().default(10)
}).passthrough();

const IncidentPoolItemSchema = external_z_namespaceObject.z.object({
  name: external_z_namespaceObject.z.string(),
  detail: external_z_namespaceObject.z.string(),
  mainLoc: external_z_namespaceObject.z.union([ external_z_namespaceObject.z.string(), external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()) ])
});

const IncidentConfigSchema = external_z_namespaceObject.z.object({
  cooldownMinutes: external_z_namespaceObject.z.number(),
  forceTrigger: external_z_namespaceObject.z.boolean(),
  isRandomPool: external_z_namespaceObject.z.boolean(),
  pool: external_z_namespaceObject.z.array(PreprocessStringifiedObject(IncidentPoolItemSchema)),
  randomCore: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  randomType: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string())
});

const FlagHistoryLimitSchema = external_z_namespaceObject.z.number().int().min(0);

const PeriodFlagHistoryLimitSchema = external_z_namespaceObject.z.object({
  newDawn: FlagHistoryLimitSchema,
  newMorning: FlagHistoryLimitSchema,
  newNoon: FlagHistoryLimitSchema,
  newAfternoon: FlagHistoryLimitSchema,
  newDusk: FlagHistoryLimitSchema,
  newNight: FlagHistoryLimitSchema,
  newFirstHalfNight: FlagHistoryLimitSchema,
  newSecondHalfNight: FlagHistoryLimitSchema
}).partial().default({});

const SeasonFlagHistoryLimitSchema = external_z_namespaceObject.z.object({
  newSpring: FlagHistoryLimitSchema,
  newSummer: FlagHistoryLimitSchema,
  newAutumn: FlagHistoryLimitSchema,
  newWinter: FlagHistoryLimitSchema
}).partial().default({});

const TimeFlagHistoryLimitsSchema = external_z_namespaceObject.z.object({
  newPeriod: FlagHistoryLimitSchema.optional(),
  newDay: FlagHistoryLimitSchema.optional(),
  newWeek: FlagHistoryLimitSchema.optional(),
  newMonth: FlagHistoryLimitSchema.optional(),
  newSeason: FlagHistoryLimitSchema.optional(),
  newYear: FlagHistoryLimitSchema.optional(),
  period: PeriodFlagHistoryLimitSchema.optional(),
  season: SeasonFlagHistoryLimitSchema.optional()
}).default({});

const TimeConfigSchema = external_z_namespaceObject.z.object({
  epochISO: external_z_namespaceObject.z.string().datetime({
    message: "æ— æ•ˆçš„ ISO 8601 æ—¥æœŸæ—¶é—´æ ¼å¼"
  }),
  flagHistoryLimits: TimeFlagHistoryLimitsSchema
}).passthrough();

const DEFAULT_TIME_CONFIG = {
  epochISO: "2025-10-24T06:00:00+09:00",
  flagHistoryLimits: {}
};

const AffectionConfigSchema = external_z_namespaceObject.z.object({
  affectionStages: external_z_namespaceObject.z.array(PreprocessStringifiedObject(AffectionStageWithForgetSchema)),
  loveThreshold: external_z_namespaceObject.z.number().optional(),
  hateThreshold: external_z_namespaceObject.z.number().optional()
});

const ConfigSchema = external_z_namespaceObject.z.object({
  affection: AffectionConfigSchema,
  specials: EntryListPreprocessSchema.default([]),
  routine: EntryListPreprocessSchema.default([]),
  time: TimeConfigSchema.default(DEFAULT_TIME_CONFIG),
  incident: IncidentConfigSchema.optional(),
  ui: UiConfigSchema
}).passthrough();

const FestivalDefinitionSchema = external_z_namespaceObject.z.object({
  month: external_z_namespaceObject.z.number(),
  start_day: external_z_namespaceObject.z.number(),
  end_day: external_z_namespaceObject.z.number(),
  name: external_z_namespaceObject.z.string(),
  type: external_z_namespaceObject.z.string(),
  customs: external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()),
  importance: external_z_namespaceObject.z.number(),
  host: external_z_namespaceObject.z.string()
});

const festival_FestivalSchema = FestivalDefinitionSchema.extend({
  id: external_z_namespaceObject.z.string().optional()
});

const FestivalsListSchema = external_z_namespaceObject.z.union([ external_z_namespaceObject.z.array(PreprocessStringifiedObject(FestivalDefinitionSchema)), external_z_namespaceObject.z.record(external_z_namespaceObject.z.string(), PreprocessStringifiedObject(FestivalDefinitionSchema)) ]).transform(val => {
  if (Array.isArray(val)) {
    return val;
  }
  return Object.entries(val).map(([id, festivalData]) => ({
    ...festivalData,
    id
  }));
}).default([]);

const UserSchema = external_z_namespaceObject.z.object({
  å§“å: external_z_namespaceObject.z.string().nullable(),
  èº«ä»½: external_z_namespaceObject.z.string().nullable(),
  æ€§åˆ«: external_z_namespaceObject.z.string().nullable(),
  å¹´é¾„: external_z_namespaceObject.z.string().nullable(),
  ç‰¹æ®Šèƒ½åŠ›: external_z_namespaceObject.z.string().nullable(),
  æ‰€åœ¨åœ°åŒº: external_z_namespaceObject.z.string().nullable(),
  å±…ä½åœ°åŒº: external_z_namespaceObject.z.string().nullable(),
  é‡è¦ç»å†: external_z_namespaceObject.z.union([ external_z_namespaceObject.z.string(), external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()) ]).optional().nullable(),
  äººé™…å…³ç³»: external_z_namespaceObject.z.union([ external_z_namespaceObject.z.string(), external_z_namespaceObject.z.array(external_z_namespaceObject.z.string()) ]).optional().nullable()
});

const USER_FIELDS = {
  name: "å§“å",
  identity: "èº«ä»½",
  gender: "æ€§åˆ«",
  age: "å¹´é¾„",
  abilities: "ç‰¹æ®Šèƒ½åŠ›",
  currentLocation: "æ‰€åœ¨åœ°åŒº",
  home: "å±…ä½åœ°åŒº",
  events: "é‡è¦ç»å†",
  relationships: "äººé™…å…³ç³»"
};

const StatSchema = external_z_namespaceObject.z.object({
  config: ConfigSchema,
  chars: CharsSchema,
  user: UserSchema,
  world: WorldSchema.optional(),
  ä¸–ç•Œ: ä¸–ç•ŒSchema,
  cache: CacheSchema.optional(),
  incidents: IncidentsSchema.default({}),
  festivals_list: FestivalsListSchema,
  é™„åŠ æ­£æ–‡: external_z_namespaceObject.z.string().optional(),
  weather: external_z_namespaceObject.z.string().optional(),
  æ–‡æ–‡æ–°é—»: external_z_namespaceObject.z.string().optional()
});

const _hoisted_1 = {
  class: "map-component",
  id: "mapComponent"
};

const _hoisted_2 = {
  class: "map-wrapper"
};

const _hoisted_3 = {
  key: 0,
  class: "map-info",
  ref: "mapInfo"
};

const _hoisted_4 = {
  id: "coords"
};

const _hoisted_5 = {
  class: "map-container",
  id: "mapContainer"
};

const _hoisted_6 = [ "innerHTML", "onClick" ];

const _hoisted_7 = {
  class: "dialog"
};

const _hoisted_8 = {
  class: "location-name"
};

const _hoisted_9 = [ "innerHTML" ];

const _hoisted_10 = [ "innerHTML" ];

const Mapvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "Map",
  props: {
    context: null
  },
  setup(__props) {
    const props = __props;
    (0, external_Vue_namespaceObject.watch)(() => props.context, (newValue, oldValue) => {
      console.log(`message ä» "${oldValue}" å˜ä¸º "${newValue}"`);
    });
    const mapSize = (0, external_Vue_namespaceObject.computed)(() => {
      if (props.context?.runtime?.area?.mapSize) {
        return props.context.runtime.area.mapSize;
      }
      return {
        width: 800,
        height: 600
      };
    });
    const markers = (0, external_Vue_namespaceObject.computed)(() => {
      if (props.context?.runtime?.area?.legal_locations) {
        return props.context.runtime.area.legal_locations;
      }
      return [];
    });
    const locationMap = (0, external_Vue_namespaceObject.computed)(() => {
      const locationMap = new Map;
      if (props.context?.runtime?.area?.legal_locations) {
        props.context.runtime.area.legal_locations.forEach(item => {
          locationMap.set(item.name, item.pos);
        });
      }
      return locationMap;
    });
    const roads = (0, external_Vue_namespaceObject.computed)(() => {
      const connections = [];
      if (props.context?.runtime?.area?.graph) {
        for (const [startName, connectionsObj] of Object.entries(props.context.runtime.area.graph)) {
          const startLocation = locationMap.value.get(startName);
          if (!startLocation) continue;
          const startInfo = {
            name: startName,
            x: startLocation.x,
            y: startLocation.y
          };
          for (const [endName, isConnected] of Object.entries(connectionsObj)) {
            if (isConnected) {
              const endLocation = locationMap.value.get(endName);
              if (endLocation) {
                const endInfo = {
                  name: endName,
                  x: endLocation.x,
                  y: endLocation.y
                };
                connections.push({
                  start: startInfo,
                  end: endInfo
                });
              }
            }
          }
        }
      }
      return connections;
    });
    const playerMarker = (0, external_Vue_namespaceObject.computed)(() => {
      if (props.context?.runtime?.characterDistribution?.playerLocation) {
        const location = locationMap.value.get(props.context?.runtime?.characterDistribution.playerLocation);
        if (location) {
          return {
            name: "ç©å®¶",
            pos: {
              x: location.x,
              y: location.y
            },
            htmlEle: "<div>ğŸ“</div>"
          };
        }
      }
      return null;
    });
    let mapState = (0, external_Vue_namespaceObject.ref)({
      offsetX: 0,
      offsetY: 0,
      zoom: 1,
      isDragging: false,
      lastMouseX: 0,
      lastMouseY: 0,
      mapWidth: mapSize.value.width,
      mapHeight: mapSize.value.height
    });
    let selectedMarker = (0, external_Vue_namespaceObject.ref)(null);
    function selectLocation(markerData) {
      if (markerData.name === selectedMarker.value?.name) {
        selectedMarker.value = null;
        return;
      }
      const npcIdList = props.context?.runtime?.characterDistribution?.npcByLocation?.[markerData.name];
      let htmlEle = "";
      if (npcIdList) {
        const npcList = npcIdList.map(id => props.context.statWithoutMeta.chars[id]);
        npcList.map(npc => {
          htmlEle += `<div>${npc.name}ï¼š${npc["ç›®æ ‡"] || "æœªçŸ¥"}</div>`;
        });
      }
      selectedMarker.value = {
        ...markerData,
        htmlEle: htmlEle || `<div>ç©ºæ— ä¸€äºº</div>`
      };
    }
    (0, external_Vue_namespaceObject.onMounted)(() => {
      const mapComponent = document.getElementById("mapComponent");
      const mapContainer = document.getElementById("mapContainer");
      const canvas = document.getElementById("mapCanvas");
      const ctx = canvas.getContext("2d");
      mapComponent.style.width = `${mapState.value.mapWidth}px`;
      mapComponent.style.height = `${mapState.value.mapHeight}px`;
      function generateMap() {
        try {
          resetView();
          canvas.width = mapState.value.mapWidth;
          canvas.height = mapState.value.mapHeight;
          drawMap();
        } catch (error) {
          alert("æ•°æ®æ ¼å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥æ•°æ®ï¼š" + error.message);
        }
      }
      function drawMap() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.save();
        ctx.translate(mapState.value.offsetX, mapState.value.offsetY);
        ctx.scale(mapState.value.zoom, mapState.value.zoom);
        drawMapBackground();
        drawRoads();
        ctx.restore();
      }
      function drawMapBackground() {
        ctx.fillStyle = "#7f8c8d";
        ctx.fillRect(0, 0, mapState.value.mapWidth, mapState.value.mapHeight);
      }
      function drawRoads() {
        try {
          ctx.strokeStyle = "#333";
          ctx.lineWidth = 4;
          ctx.lineCap = "round";
          roads.value.forEach(road => {
            ctx.beginPath();
            ctx.moveTo(road.start.x, road.start.y);
            ctx.lineTo(road.end.x, road.end.y);
            ctx.stroke();
          });
        } catch (error) {
          console.error("é“è·¯æ•°æ®æ ¼å¼é”™è¯¯:", error);
        }
      }
      function resetView() {
        mapState.value = {
          ...mapState.value,
          zoom: 1,
          offsetX: (mapContainer.clientWidth - mapState.value.mapWidth) / 2,
          offsetY: (mapContainer.clientHeight - mapState.value.mapHeight) / 2
        };
        drawMap();
      }
      mapContainer.addEventListener("mousedown", e => {
        mapState.value = {
          ...mapState.value,
          isDragging: true,
          lastMouseX: e.clientX,
          lastMouseY: e.clientY
        };
        mapContainer.style.cursor = "grabbing";
      });
      mapContainer.addEventListener("mousemove", e => {
        if (mapState.value.isDragging) {
          const deltaX = e.clientX - mapState.value.lastMouseX;
          const deltaY = e.clientY - mapState.value.lastMouseY;
          mapState.value.offsetX += deltaX;
          mapState.value.offsetY += deltaY;
          mapState.value.lastMouseX = e.clientX;
          mapState.value.lastMouseY = e.clientY;
          drawMap();
        }
      });
      mapContainer.addEventListener("mouseup", () => {
        mapState.value.isDragging = false;
        mapContainer.style.cursor = "grab";
      });
      mapContainer.addEventListener("mouseleave", () => {
        mapState.value.isDragging = false;
        mapContainer.style.cursor = "grab";
      });
      mapContainer.addEventListener("wheel", e => {
        e.preventDefault();
        const zoomFactor = e.deltaY > 0 ? .9 : 1.1;
        const newZoom = mapState.value.zoom * zoomFactor;
        if (newZoom >= .2 && newZoom <= 5) {
          const rect = mapContainer.getBoundingClientRect();
          const mouseX = e.clientX - rect.left;
          const mouseY = e.clientY - rect.top;
          const worldX = (mouseX - mapState.value.offsetX) / mapState.value.zoom;
          const worldY = (mouseY - mapState.value.offsetY) / mapState.value.zoom;
          mapState.value = {
            ...mapState.value,
            zoom: newZoom,
            offsetX: mouseX - worldX * mapState.value.zoom,
            offsetY: mouseY - worldY * mapState.value.zoom
          };
          drawMap();
        }
      });
      generateMap();
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", _hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", _hoisted_2, [ false ? 0 : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true), (0, external_Vue_namespaceObject.createElementVNode)("div", _hoisted_5, [ _cache[2] || (_cache[2] = (0, 
    external_Vue_namespaceObject.createElementVNode)("canvas", {
      id: "mapCanvas"
    }, null, -1)), (0, external_Vue_namespaceObject.createCommentVNode)(" åŠ¨æ€ç”Ÿæˆmarker "), ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)((0, external_Vue_namespaceObject.unref)(markers), (marker, index) => ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      key: index,
      class: "marker",
      innerHTML: marker.htmlEle,
      style: (0, external_Vue_namespaceObject.normalizeStyle)({
        left: marker.pos.x * (0, external_Vue_namespaceObject.unref)(mapState).zoom + (0, 
        external_Vue_namespaceObject.unref)(mapState).offsetX + "px",
        top: marker.pos.y * (0, external_Vue_namespaceObject.unref)(mapState).zoom + (0, 
        external_Vue_namespaceObject.unref)(mapState).offsetY + "px",
        transform: `translate(-50%, -50%) scale(${(0, external_Vue_namespaceObject.unref)(mapState).zoom})`
      }),
      onClick: $event => selectLocation(marker)
    }, null, 12, _hoisted_6))), 128)), (0, external_Vue_namespaceObject.createCommentVNode)(" ç‚¹å‡»markerçš„tipå¼¹å‡º "), (0, 
    external_Vue_namespaceObject.unref)(selectedMarker) ? ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createElementBlock)("div", {
      key: 0,
      class: "tip-container",
      style: (0, external_Vue_namespaceObject.normalizeStyle)({
        left: (0, external_Vue_namespaceObject.unref)(selectedMarker).pos.x * (0, external_Vue_namespaceObject.unref)(mapState).zoom + (0, 
        external_Vue_namespaceObject.unref)(mapState).offsetX + "px",
        top: (0, external_Vue_namespaceObject.unref)(selectedMarker).pos.y * (0, external_Vue_namespaceObject.unref)(mapState).zoom + (0, 
        external_Vue_namespaceObject.unref)(mapState).offsetY - 20 + "px",
        transform: `translate(-50%, -100%) scale(${(0, external_Vue_namespaceObject.unref)(mapState).zoom})`
      })
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", _hoisted_7, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("h2", _hoisted_8, (0, external_Vue_namespaceObject.toDisplayString)((0, 
    external_Vue_namespaceObject.unref)(selectedMarker).name), 1), (0, external_Vue_namespaceObject.createElementVNode)("div", {
      innerHTML: (0, external_Vue_namespaceObject.unref)(selectedMarker).htmlEle
    }, null, 8, _hoisted_9) ]) ], 4)) : (0, external_Vue_namespaceObject.createCommentVNode)("v-if", true), (0, 
    external_Vue_namespaceObject.createCommentVNode)(" ç©å®¶ "), (0, external_Vue_namespaceObject.unref)(playerMarker) ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      key: 1,
      class: "marker player-marker pulsate",
      innerHTML: (0, external_Vue_namespaceObject.unref)(playerMarker).htmlEle,
      style: (0, external_Vue_namespaceObject.normalizeStyle)({
        left: (0, external_Vue_namespaceObject.unref)(playerMarker).pos.x * (0, external_Vue_namespaceObject.unref)(mapState).zoom + (0, 
        external_Vue_namespaceObject.unref)(mapState).offsetX + "px",
        top: (0, external_Vue_namespaceObject.unref)(playerMarker).pos.y * (0, external_Vue_namespaceObject.unref)(mapState).zoom + (0, 
        external_Vue_namespaceObject.unref)(mapState).offsetY + "px",
        transform: `translate(-50%, -100%) scale(${1 / (0, external_Vue_namespaceObject.unref)(mapState).zoom})`
      })
    }, null, 12, _hoisted_10)) : (0, external_Vue_namespaceObject.createCommentVNode)("v-if", true) ]) ]) ]));
  }
});

const __exports__ = Mapvue_type_script_setup_true_lang_ts;

const Map_Map = __exports__;

const PROJECT_NAME = "GSKO-FACE";

const DEBUG_CONFIG_LS_KEY = "gsko_era_debug_config";

let enabledPatterns = [];

let disabledPatterns = [];

function loadDebugConfig() {
  try {
    const configStr = globalThis.localStorage?.getItem(DEBUG_CONFIG_LS_KEY) || '{"enabled":[],"disabled":[]}';
    const config = JSON.parse(configStr);
    const toRegex = p => new RegExp(`^${p.replace(/\*/g, ".*?")}$`);
    enabledPatterns = (config.enabled || []).map(toRegex);
    disabledPatterns = (config.disabled || []).map(toRegex);
  } catch (e) {
    console.error(`ã€Š${PROJECT_NAME}-Logã€‹: åŠ è½½è°ƒè¯•é…ç½®å¤±è´¥ã€‚`, e);
    enabledPatterns = [];
    disabledPatterns = [];
  }
}

function isDebugEnabled(moduleName) {
  if (!moduleName) return false;
  if (disabledPatterns.some(re => re.test(moduleName))) {
    return false;
  }
  if (enabledPatterns.length === 0) {
    return false;
  }
  if (enabledPatterns.some(re => re.test(moduleName))) {
    return true;
  }
  return false;
}

function updateConfig(newConfig) {
  const uniqueConfig = {
    enabled: [ ...new Set(newConfig.enabled) ],
    disabled: [ ...new Set(newConfig.disabled) ]
  };
  globalThis.localStorage?.setItem(DEBUG_CONFIG_LS_KEY, JSON.stringify(uniqueConfig));
  loadDebugConfig();
  console.log(`%cã€Š${PROJECT_NAME}-Logã€‹è°ƒè¯•æ¨¡å¼å·²æ›´æ–°ã€‚`, "color: #3498db; font-weight: bold;", {
    "å¯ç”¨ (Enabled)": uniqueConfig.enabled,
    "ç¦ç”¨ (Disabled)": uniqueConfig.disabled
  });
}

loadDebugConfig();

if (typeof globalThis !== "undefined") {
  const eraDebug = {
    add(pattern) {
      const configStr = globalThis.localStorage?.getItem(DEBUG_CONFIG_LS_KEY) || '{"enabled":[],"disabled":[]}';
      const config = JSON.parse(configStr);
      const enabled = new Set(config.enabled || []);
      const disabled = new Set(config.disabled || []);
      enabled.add(pattern);
      disabled.delete(pattern);
      updateConfig({
        enabled: Array.from(enabled),
        disabled: Array.from(disabled)
      });
    },
    remove(pattern) {
      const configStr = globalThis.localStorage?.getItem(DEBUG_CONFIG_LS_KEY) || '{"enabled":[],"disabled":[]}';
      const config = JSON.parse(configStr);
      const enabled = new Set(config.enabled || []);
      const disabled = new Set(config.disabled || []);
      disabled.add(pattern);
      enabled.delete(pattern);
      updateConfig({
        enabled: Array.from(enabled),
        disabled: Array.from(disabled)
      });
    },
    status() {
      const configStr = globalThis.localStorage?.getItem(DEBUG_CONFIG_LS_KEY) || '{"enabled":[],"disabled":[]}';
      const config = JSON.parse(configStr);
      console.log(`%cã€Š${PROJECT_NAME}-Logã€‹å½“å‰è°ƒè¯•é…ç½®:`, "color: #3498db; font-weight: bold;", config);
    },
    clear() {
      updateConfig({
        enabled: [],
        disabled: []
      });
    }
  };
  globalThis.eraDebug = eraDebug;
}

const logContext = {
  mk: ""
};

class Logger {
  moduleName;
  constructor(moduleName) {
    this.moduleName = moduleName || this._getModuleNameFromStack() || "unknown";
  }
  _getModuleNameFromStack() {
    try {
      const stack = (new Error).stack || "";
      const callerLine = stack.split("\n").find(line => (line.includes(`/src/${PROJECT_NAME}/`) || line.includes(`/dist/${PROJECT_NAME}/`) || line.includes(`\\src\\${PROJECT_NAME}\\`) || line.includes(`\\dist\\${PROJECT_NAME}\\`)) && !line.includes("/utils/log.ts"));
      if (!callerLine) {
        return null;
      }
      const match = callerLine.match(new RegExp(`(src|dist)[\\\\/]${PROJECT_NAME}[\\\\/]([^?:]+)`));
      if (!match || !match[2]) {
        return null;
      }
      const path = match[2];
      return path.replace(/\\/g, "/").replace(/\.(vue|ts|js)$/, "").replace(/\/index$/, "");
    } catch (e) {
      console.error(`ã€Š${PROJECT_NAME}-Log-Debugã€‹: è§£ææ¨¡å—åæ—¶å‘ç”Ÿæ„å¤–é”™è¯¯ã€‚`, e);
      return null;
    }
  }
  formatMessage(funcName, message) {
    const mkString = logContext.mk ? `ï¼ˆ${logContext.mk}ï¼‰` : "";
    return `ã€Š${PROJECT_NAME}ã€‹${mkString}ã€Œ${this.moduleName}ã€ã€${funcName}ã€‘${String(message)}`;
  }
  debug(funcName, message, obj) {
    if (!isDebugEnabled(this.moduleName)) {
      return;
    }
    const formattedMessage = this.formatMessage(funcName, message);
    if (obj !== undefined) {
      console.debug(formattedMessage, obj);
    } else {
      console.debug(formattedMessage);
    }
  }
  log(funcName, message, obj) {
    const formattedMessage = this.formatMessage(funcName, message);
    if (obj !== undefined) {
      console.log(`%c${formattedMessage}`, "color: #3498db;", obj);
    } else {
      console.log(`%c${formattedMessage}`, "color: #3498db;");
    }
  }
  warn(funcName, message, obj) {
    const formattedMessage = this.formatMessage(funcName, message);
    if (obj !== undefined) {
      console.warn(`%c${formattedMessage}`, "color: #f39c12;", obj);
    } else {
      console.warn(`%c${formattedMessage}`, "color: #f39c12;");
    }
  }
  error(funcName, message, errorObj) {
    const formattedMessage = this.formatMessage(funcName, message);
    if (errorObj !== undefined) {
      console.error(`%c${formattedMessage}`, "color: #e74c3c; font-weight: bold;", errorObj);
    } else {
      console.error(`%c${formattedMessage}`, "color: #e74c3c; font-weight: bold;");
    }
  }
}

const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/utils/format");

function firstVal(x) {
  return Array.isArray(x) ? x.length ? x[0] : "" : x;
}

function get(obj, path, fallback = "") {
  try {
    const ks = Array.isArray(path) ? path : String(path).split(".");
    let cur = obj;
    for (const k of ks) {
      if (!cur || typeof cur !== "object" || !(k in cur)) {
        logger.debug("get", "æœªæ‰¾åˆ°é”®ï¼Œä½¿ç”¨é»˜è®¤å€¼ã€‚", {
          è·¯å¾„: String(path),
          ç¼ºå¤±é”®: String(k),
          é»˜è®¤å€¼: fallback
        });
        return fallback;
      }
      cur = cur[k];
    }
    const v = firstVal(cur);
    if (v == null) {
      logger.debug("get", "è·¯å¾„å­˜åœ¨ä½†å€¼ä¸ºç©º(null/undefined)ï¼Œä½¿ç”¨é»˜è®¤å€¼ã€‚", {
        è·¯å¾„: String(path),
        é»˜è®¤å€¼: fallback
      });
      return fallback;
    }
    return v;
  } catch (e) {
    logger.error("get", "å¼‚å¸¸ï¼Œä½¿ç”¨é»˜è®¤å€¼ã€‚", {
      è·¯å¾„: String(path),
      å¼‚å¸¸: String(e),
      é»˜è®¤å€¼: fallback
    });
    return fallback;
  }
}

function format_text(id, raw) {
  const el = document.getElementById(id);
  if (!el) {
    logger.warn("text", "ç›®æ ‡å…ƒç´ ä¸å­˜åœ¨ï¼Œè·³è¿‡å†™å…¥ã€‚", {
      å…ƒç´ ID: id
    });
    return;
  }
  el.textContent = toText(raw);
}

function getRaw(obj, path, fallback = null) {
  try {
    const ks = Array.isArray(path) ? path : String(path).split(".");
    let cur = obj;
    for (const k of ks) {
      if (!cur || typeof cur !== "object" || !(k in cur)) {
        return fallback;
      }
      cur = cur[k];
    }
    return cur == null ? fallback : cur;
  } catch (e) {
    logger.error("getRaw", "å¼‚å¸¸ï¼Œä½¿ç”¨é»˜è®¤å€¼ã€‚", {
      è·¯å¾„: String(path),
      å¼‚å¸¸: String(e),
      é»˜è®¤å€¼: fallback
    });
    return fallback;
  }
}

function toText(v) {
  if (v == null || v === "") return "â€”";
  if (Array.isArray(v)) return v.length ? v.join("ï¼›") : "â€”";
  if (typeof v === "object") return JSON.stringify(v);
  return String(v);
}

function getStr(obj, path, fallback = "") {
  const rawValue = getRaw(obj, path, null);
  if (rawValue === null) {
    return toText(fallback);
  }
  return toText(rawValue);
}

const ContentBiovue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "ContentBio",
  setup(__props, {expose: __expose}) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/StatusTab/tabs/ContentBio");
    const userEvents = (0, external_Vue_namespaceObject.ref)(null);
    const userRelationships = (0, external_Vue_namespaceObject.ref)(null);
    function update({statWithoutMeta: stat}) {
      const funcName = "update";
      logger.log(funcName, "æ¥æ”¶åˆ°æ›´æ–°æŒ‡ä»¤ï¼Œå¼€å§‹æ›´æ–°å±¥å†ä¸å…³ç³»", {
        stat
      });
      const userData = stat.user;
      logger.debug(funcName, "æå–çš„ç”¨æˆ·æ•°æ®", {
        userData
      });
      const eventsText = toText(userData.é‡è¦ç»å†);
      const relationshipsText = toText(userData.äººé™…å…³ç³»);
      logger.debug(funcName, "å¤„ç†åçš„å¾…æ˜¾ç¤ºæ–‡æœ¬", {
        eventsText,
        relationshipsText
      });
      if (userEvents.value) {
        userEvents.value.textContent = eventsText;
        logger.log(funcName, "æˆåŠŸæ›´æ–°â€œé‡è¦ç»å†â€å†…å®¹ã€‚");
      } else {
        logger.warn(funcName, "æ— æ³•æ‰¾åˆ°â€œé‡è¦ç»å†â€çš„ DOM å…ƒç´  (userEvents ref)ï¼Œè¯·æ£€æŸ¥æ¨¡æ¿ã€‚");
      }
      if (userRelationships.value) {
        userRelationships.value.textContent = relationshipsText;
        logger.log(funcName, "æˆåŠŸæ›´æ–°â€œäººé™…å…³ç³»â€å†…å®¹ã€‚");
      } else {
        logger.warn(funcName, "æ— æ³•æ‰¾åˆ°â€œäººé™…å…³ç³»â€çš„ DOM å…ƒç´  (userRelationships ref)ï¼Œè¯·æ£€æŸ¥æ¨¡æ¿ã€‚");
      }
    }
    __expose({
      update
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", null, [ _cache[0] || (_cache[0] = (0, 
    external_Vue_namespaceObject.createElementVNode)("h4", null, [ (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "ğŸ§­"), (0, external_Vue_namespaceObject.createTextVNode)("é‡è¦ç»å†") ], -1)), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      ref_key: "userEvents",
      ref: userEvents,
      class: "preserve-format"
    }, "â€”", 512), _cache[1] || (_cache[1] = (0, external_Vue_namespaceObject.createElementVNode)("hr", {
      class: "dashed"
    }, null, -1)), _cache[2] || (_cache[2] = (0, external_Vue_namespaceObject.createElementVNode)("h4", null, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "ğŸ¤"), (0, external_Vue_namespaceObject.createTextVNode)("äººé™…å…³ç³»") ], -1)), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      ref_key: "userRelationships",
      ref: userRelationships,
      class: "preserve-format"
    }, "â€”", 512) ]));
  }
});

var exportHelper = __webpack_require__(800);

const ContentBio_exports_ = (0, exportHelper.A)(ContentBiovue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-3e602d5b" ] ]);

const ContentBio = ContentBio_exports_;

const external_namespaceObject = _;

var external_default = __webpack_require__.n(external_namespaceObject);

const eraWriter_logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/utils/eraWriter");

function updateEraVariable(path, value) {
  const funcName = "updateEraVariable";
  if (!path || typeof path !== "string") {
    eraWriter_logger.warn(funcName, "è°ƒç”¨å¤±è´¥ï¼špath æ— æ•ˆã€‚", {
      path
    });
    return;
  }
  const eventData = {
    path,
    value
  };
  try {
    eraWriter_logger.log(funcName, `å‡†å¤‡å‘é€ era:updateByPath äº‹ä»¶`, eventData);
    eventEmit("era:updateByPath", eventData);
  } catch (e) {
    eraWriter_logger.error(funcName, "å‘é€ era:updateByPath äº‹ä»¶æ—¶å‡ºç°å¼‚å¸¸", e);
  }
}

function updateEraVariableByObject(obj) {
  const funcName = "updateEraVariableByObject";
  if (!obj || typeof obj !== "object") {
    eraWriter_logger.warn(funcName, "è°ƒç”¨å¤±è´¥ï¼šä¼ å…¥çš„ obj æ— æ•ˆã€‚", {
      obj
    });
    return;
  }
  try {
    eraWriter_logger.log(funcName, `å‡†å¤‡å‘é€ era:updateByObject äº‹ä»¶`, obj);
    eventEmit("era:updateByObject", obj);
  } catch (e) {
    eraWriter_logger.error(funcName, "å‘é€ era:updateByObject äº‹ä»¶æ—¶å‡ºç°å¼‚å¸¸", e);
  }
}

const ContentSettingsvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "row",
  style: {
    display: "flex",
    gap: "8px",
    "align-items": "center",
    margin: "8px 0 12px"
  }
};

const ContentSettingsvue_type_script_setup_true_lang_ts_hoisted_2 = {
  id: "cfg_status",
  class: "tag"
};

const ContentSettingsvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "ContentSettings",
  props: {
    config: {}
  },
  emits: [ "saved" ],
  setup(__props, {emit: __emit}) {
    const props = __props;
    const emit = __emit;
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/StatusTab/tabs/ContentSettings");
    const loadStatus = (0, external_Vue_namespaceObject.ref)("æœªè½½å…¥");
    const configRoot = (0, external_Vue_namespaceObject.ref)(null);
    let initialConfig = null;
    let editedConfig = null;
    let leafCount = 0;
    let groupCount = 0;
    let pendingConfig;
    const isObj = o => o && typeof o === "object" && !Array.isArray(o);
    const handleConfigUpdate = config => {
      if (!configRoot.value) {
        pendingConfig = config;
        return;
      }
      if (!config) {
        configRoot.value.innerHTML = "";
        loadStatus.value = "æœªè½½å…¥";
        initialConfig = null;
        editedConfig = null;
        return;
      }
      if (typeof config !== "object") {
        logger.warn("handleConfigUpdate", "é…ç½®å¯¹è±¡æ— æ•ˆï¼ŒæœŸæœ›ä¸º objectã€‚");
        configRoot.value.innerHTML = "";
        loadStatus.value = "é…ç½®æ— æ•ˆ";
        initialConfig = null;
        editedConfig = null;
        return;
      }
      render(config);
    };
    (0, external_Vue_namespaceObject.watch)(() => props.config, config => {
      handleConfigUpdate(config);
    }, {
      immediate: true
    });
    (0, external_Vue_namespaceObject.onMounted)(() => {
      if (pendingConfig !== undefined) {
        const config = pendingConfig;
        pendingConfig = undefined;
        handleConfigUpdate(config);
      }
    });
    const pathLabel = segments => segments.length ? segments.join(".") : "config";
    const getValueAtPath = (root, segments) => segments.reduce((acc, key) => acc != null ? acc[key] : undefined, root);
    const setValueAtPath = (root, segments, value) => {
      if (!segments.length) {
        return;
      }
      let current = root;
      for (let i = 0; i < segments.length - 1; i++) {
        const key = segments[i];
        if (!isObj(current[key])) {
          current[key] = {};
        }
        current = current[key];
      }
      current[segments[segments.length - 1]] = value;
    };
    function createControl(segments, parent, key, value, docText) {
      const wrap = document.createElement("div");
      const keyEl = document.createElement("div");
      const box = document.createElement("div");
      wrap.style.margin = "10px 0";
      keyEl.style.fontWeight = "600";
      keyEl.style.color = "#5e5042";
      keyEl.textContent = pathLabel(segments);
      wrap.appendChild(keyEl);
      if (docText) {
        const docEl = document.createElement("div");
        docEl.style.color = "#857664";
        docEl.style.fontSize = ".9em";
        docEl.style.margin = "6px 0 10px";
        docEl.textContent = docText;
        wrap.appendChild(docEl);
      }
      wrap.appendChild(box);
      let getDomValue;
      if (typeof value === "boolean") {
        const el = document.createElement("input");
        el.type = "checkbox";
        el.checked = !!value;
        box.appendChild(el);
        getDomValue = () => !!el.checked;
      } else if (typeof value === "number") {
        const el = document.createElement("input");
        el.type = "number";
        el.value = String(value);
        el.style.width = "100%";
        box.appendChild(el);
        getDomValue = () => Number(el.value);
      } else if (Array.isArray(value)) {
        const isPrimitiveArray = value.every(v => v === null || [ "string", "number", "boolean" ].includes(typeof v));
        const el = document.createElement("textarea");
        el.style.width = "100%";
        el.style.minHeight = "100px";
        box.appendChild(el);
        if (isPrimitiveArray) {
          el.value = value.map(v => String(v)).join("\n");
          getDomValue = () => {
            const lines = (el.value || "").split("\n").map(s => s.trim()).filter(Boolean);
            const allNumbers = lines.every(s => /^-?\d+(?:\.\d+)?$/.test(s));
            return allNumbers ? lines.map(Number) : lines;
          };
        } else {
          el.value = JSON.stringify(value, null, 2);
          getDomValue = () => {
            try {
              const text = el.value.trim();
              return text ? JSON.parse(text) : [];
            } catch (e) {
              logger.error("createControl", `è§£æ JSON å¤±è´¥ï¼Œè·¯å¾„: ${pathLabel(segments)}`, e);
              return value;
            }
          };
        }
      } else {
        const el = document.createElement("input");
        el.type = "text";
        el.value = value == null ? "" : String(value);
        el.style.width = "100%";
        box.appendChild(el);
        getDomValue = () => el.value;
      }
      leafCount++;
      const initialValue = (0, external_namespaceObject.cloneDeep)(getValueAtPath(initialConfig, segments));
      wrap.__getDomValue = getDomValue;
      wrap.__applyValue = next => {
        parent[key] = next;
      };
      wrap.__initialValue = initialValue;
      wrap.__pathSegments = segments.slice();
      wrap.__pathLabel = pathLabel(segments);
      wrap.dataset.path = pathLabel(segments);
      return wrap;
    }
    function createGroup(obj, segments, docText, summaryLabel) {
      const box = document.createElement("details");
      box.open = false;
      const sum = document.createElement("summary");
      sum.textContent = summaryLabel ?? (segments.length ? segments[segments.length - 1] : "(root)");
      box.appendChild(sum);
      if (docText) {
        const d = document.createElement("div");
        d.style.color = "#857664";
        d.style.fontSize = ".9em";
        d.style.margin = "6px 0 10px";
        d.textContent = docText;
        box.appendChild(d);
      }
      groupCount++;
      Object.keys(obj).forEach(k => {
        if (k === "__doc" || k === "_doc" || k.endsWith("__doc") || k.startsWith("_")) return;
        const v = obj[k];
        const nextSegments = [ ...segments, k ];
        if (isObj(v)) {
          const child = createGroup(v, nextSegments, v?._doc || obj[`${k}__doc`], k);
          box.appendChild(child);
        } else {
          const leafDoc = obj[`${k}__doc`];
          const controlElement = createControl(nextSegments, obj, k, v, leafDoc);
          box.appendChild(controlElement);
        }
      });
      return box;
    }
    function render(config) {
      if (!configRoot.value) {
        logger.warn("render", "#cfg_root å®¹å™¨å°šæœªå°±ç»ªï¼Œæ¨è¿Ÿæ¸²æŸ“ã€‚");
        pendingConfig = config;
        return;
      }
      const t0 = performance.now();
      initialConfig = (0, external_namespaceObject.cloneDeep)(config);
      editedConfig = (0, external_namespaceObject.cloneDeep)(config);
      leafCount = 0;
      groupCount = 0;
      configRoot.value.innerHTML = "";
      const view = createGroup(editedConfig, [], editedConfig?._doc, "config");
      view.open = false;
      configRoot.value.appendChild(view);
      loadStatus.value = "å·²è½½å…¥";
      const ms = (performance.now() - t0).toFixed(1);
      logger.log("render", `é…ç½®æ¸²æŸ“å®Œæˆ`, {
        groups: groupCount,
        leaves: leafCount,
        ms
      });
    }
    function collectChanges() {
      const t0 = performance.now();
      const items = configRoot.value?.querySelectorAll("[data-path]") || [];
      const changes = [];
      let scanned = 0;
      items.forEach(el => {
        scanned++;
        const getDomValue = el.__getDomValue;
        const applyValue = el.__applyValue;
        const initialValue = el.__initialValue;
        const pathSegments = el.__pathSegments;
        const label = el.__pathLabel;
        if (!getDomValue || !applyValue || !pathSegments || !label) return;
        const currentValue = getDomValue();
        applyValue((0, external_namespaceObject.cloneDeep)(currentValue));
        if (!(0, external_namespaceObject.isEqual)(currentValue, initialValue)) {
          changes.push({
            path: pathSegments,
            pathLabel: label,
            from: initialValue,
            to: (0, external_namespaceObject.cloneDeep)(currentValue)
          });
        }
      });
      logger.log("collectChanges", `å·®å¼‚æ”¶é›†å®Œæˆ`, {
        scanned,
        changed: changes.length,
        ms: (performance.now() - t0).toFixed(1),
        sample: changes.slice(0, 5).map(item => ({
          path: item.pathLabel,
          to: item.to
        }))
      });
      return changes;
    }
    const buildPatchObject = changes => {
      const patch = {};
      changes.forEach(change => {
        setValueAtPath(patch, change.path, (0, external_namespaceObject.cloneDeep)(change.to));
      });
      return patch;
    };
    async function save() {
      const funcName = "save";
      try {
        const changes = collectChanges();
        if (!changes.length) {
          logger.log(funcName, "æ— å˜åŒ–ï¼Œæ— éœ€ä¿å­˜ã€‚");
          toastr.info("æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•æ›´æ”¹ã€‚");
          return;
        }
        logger.log(funcName, `å‡†å¤‡å†™å…¥ ${changes.length} é¡¹æ›´æ”¹...`);
        toastr.info(`æ­£åœ¨ä¿å­˜ ${changes.length} é¡¹æ›´æ”¹...`);
        const patch = buildPatchObject(changes);
        let ok = 0;
        let fail = 0;
        try {
          updateEraVariableByObject({
            config: patch
          });
          ok = changes.length;
          logger.log(funcName, `å·²å‘é€ era:updateByObject`, {
            patch
          });
          toastr.success(`ä¿å­˜æˆåŠŸ ${ok} é¡¹ã€‚`);
          emit("saved", {
            ok,
            fail,
            patch
          });
          if (editedConfig && typeof editedConfig === "object") {
            render(editedConfig);
            loadStatus.value = "å·²ä¿å­˜";
          } else {
            loadStatus.value = "å·²ä¿å­˜";
          }
        } catch (error) {
          fail = changes.length;
          logger.error(funcName, `å†™å…¥å¤±è´¥`, error);
          toastr.error("ä¿å­˜è¿‡ç¨‹ä¸­å‘ç”ŸæœªçŸ¥é”™è¯¯ã€‚");
          emit("saved", {
            ok,
            fail,
            patch
          });
        }
      } catch (e) {
        logger.error(funcName, `ä¿å­˜è¿‡ç¨‹å‡ºç°å¼‚å¸¸`, e);
        toastr.error("ä¿å­˜è¿‡ç¨‹ä¸­å‘ç”ŸæœªçŸ¥é”™è¯¯ã€‚");
      }
    }
    function expandAll() {
      const list = configRoot.value?.querySelectorAll("details");
      list?.forEach(d => d.open = true);
      logger.log("expandAll", `å±•å¼€äº† ${list?.length || 0} ä¸ªåˆ†ç»„ã€‚`);
    }
    function collapseAll() {
      const list = configRoot.value?.querySelectorAll("details");
      list?.forEach(d => d.open = false);
      logger.log("collapseAll", `æŠ˜å äº† ${list?.length || 0} ä¸ªåˆ†ç»„ã€‚`);
    }
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", null, [ _cache[0] || (_cache[0] = (0, 
    external_Vue_namespaceObject.createElementVNode)("h4", null, [ (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "âš™ï¸"), (0, external_Vue_namespaceObject.createTextVNode)("è®¾ç½®") ], -1)), (0, external_Vue_namespaceObject.createElementVNode)("div", ContentSettingsvue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("span", ContentSettingsvue_type_script_setup_true_lang_ts_hoisted_2, (0, 
    external_Vue_namespaceObject.toDisplayString)(loadStatus.value), 1), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "btn_expand_all",
      onClick: expandAll
    }, "å±•å¼€å…¨éƒ¨"), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "btn_collapse_all",
      onClick: collapseAll
    }, "æŠ˜å å…¨éƒ¨"), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "btn_save_cfg",
      onClick: save
    }, "ä¿å­˜æ›´æ”¹") ]), _cache[1] || (_cache[1] = (0, external_Vue_namespaceObject.createElementVNode)("div", {
      class: "hint"
    }, "å¸ƒå°”=å‹¾é€‰ï¼Œæ•°å­—=æ•°å­—æ¡†ï¼Œå­—ç¬¦ä¸²=æ–‡æœ¬æ¡†ï¼Œæ•°ç»„=æ¯è¡Œä¸€é¡¹ã€‚å¯¹è±¡ä¼šæŠ˜å ä¸ºåˆ†ç»„ã€‚", -1)), (0, external_Vue_namespaceObject.createElementVNode)("div", {
      id: "cfg_root",
      ref_key: "configRoot",
      ref: configRoot
    }, null, 512) ]));
  }
});

const ContentSettings_exports_ = (0, exportHelper.A)(ContentSettingsvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-5c4294ac" ] ]);

const ContentSettings = ContentSettings_exports_;

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_1 = {
  id: "incident-toolbar",
  class: "debug-select",
  style: {
    display: "flex",
    "align-items": "center",
    gap: "12px",
    "flex-wrap": "wrap"
  }
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_2 = {
  id: "incident-countdown"
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "debug-switch",
  title: "æ¥è‡ª config.incident.forceTriggerï¼›ä¿®æ”¹å³å†™å›åˆ°é…ç½®"
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_4 = {
  class: "debug-switch",
  title: "æ¥è‡ª config.incident.isRandomPoolï¼›ä¿®æ”¹å³å†™å›åˆ°é…ç½®"
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_5 = {
  id: "incident-list",
  class: "incident-list"
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_6 = {
  class: "role-card-header"
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_7 = {
  class: "role-name"
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_8 = {
  class: "role-meta"
};

const Incidentsvue_type_script_setup_true_lang_ts_hoisted_9 = {
  key: 1,
  class: "role-card"
};

const Incidentsvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "Incidents",
  props: {
    stat: {},
    runtime: {}
  },
  setup(__props) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/StatusTab/tabs/Incidents");
    const props = __props;
    const incidentCards = (0, external_Vue_namespaceObject.computed)(() => {
      const stat = props.stat;
      if (!stat || !stat.incidents) return [];
      const entries = Object.entries(stat.incidents).filter(([key, value]) => !key.startsWith("$") && !!value);
      return entries.map(([name, detail]) => {
        const incident = detail;
        const solver = incident.å¼‚å˜é€€æ²»è€…;
        const solverText = Array.isArray(solver) ? solver.join("ã€") : solver ?? "";
        const mainLoc = incident.ä¸»è¦åœ°åŒº?.join("ã€") ?? "";
        const fields = [];
        if (incident.å¼‚å˜ç»†èŠ‚) {
          fields.push({
            label: "å¼‚å˜ç»†èŠ‚",
            value: incident.å¼‚å˜ç»†èŠ‚
          });
        }
        if (mainLoc) {
          fields.push({
            label: "ä¸»è¦åœ°åŒº",
            value: mainLoc
          });
        }
        if (solverText) {
          fields.push({
            label: "å¼‚å˜é€€æ²»è€…",
            value: solverText
          });
        }
        return {
          key: name,
          name,
          statusText: incident.å¼‚å˜å·²ç»“æŸ ? "å·²ç»“æŸ" : "è¿›è¡Œä¸­",
          fields
        };
      });
    });
    const countdownMinutes = (0, external_Vue_namespaceObject.computed)(() => {
      const runtimeCountdown = props.runtime?.incident?.remainingCooldown;
      if (typeof runtimeCountdown === "number" && Number.isFinite(runtimeCountdown)) {
        return Math.max(0, Math.floor(runtimeCountdown));
      }
      const config = props.stat?.config?.incident;
      const timeProgress = props.stat?.ä¸–ç•Œ?.timeProgress;
      if (!config || typeof config.cooldownMinutes !== "number" || typeof timeProgress !== "number") {
        return null;
      }
      const anchor = props.stat?.cache?.incident?.incidentCooldownAnchor;
      if (anchor == null) {
        return Math.max(0, Math.floor(config.cooldownMinutes));
      }
      const remaining = config.cooldownMinutes - (timeProgress - anchor);
      return Math.max(0, Math.floor(remaining));
    });
    const countdownText = (0, external_Vue_namespaceObject.computed)(() => {
      const value = countdownMinutes.value;
      return value == null ? "â€”" : String(value);
    });
    const immediateTrigger = (0, external_Vue_namespaceObject.ref)(false);
    const randomPool = (0, external_Vue_namespaceObject.ref)(false);
    let skipImmediatePropagation = false;
    let skipRandomPropagation = false;
    (0, external_Vue_namespaceObject.watch)(() => props.stat?.config?.incident?.forceTrigger ?? false, value => {
      if (immediateTrigger.value === value) {
        return;
      }
      skipImmediatePropagation = true;
      immediateTrigger.value = value;
      logger.log("syncImmediateTrigger", `å·²åŒæ­¥â€œç«‹å³å¼•å‘å¼‚å˜â€çŠ¶æ€: ${value}`);
    }, {
      immediate: true
    });
    (0, external_Vue_namespaceObject.watch)(() => props.stat?.config?.incident?.isRandomPool ?? false, value => {
      if (randomPool.value === value) {
        return;
      }
      skipRandomPropagation = true;
      randomPool.value = value;
      logger.log("syncRandomPool", `å·²åŒæ­¥â€œä¹±åºå¼‚å˜â€çŠ¶æ€: ${value}`);
    }, {
      immediate: true
    });
    (0, external_Vue_namespaceObject.watch)(immediateTrigger, value => {
      if (skipImmediatePropagation) {
        skipImmediatePropagation = false;
        return;
      }
      logger.log("onImmediateTriggerChange", `ç”¨æˆ·åˆ‡æ¢â€œç«‹å³å¼•å‘å¼‚å˜â€ä¸º: ${value}`);
      updateEraVariableByObject({
        config: {
          incident: {
            forceTrigger: value
          }
        }
      });
    }, {
      flush: "post"
    });
    (0, external_Vue_namespaceObject.watch)(randomPool, value => {
      if (skipRandomPropagation) {
        skipRandomPropagation = false;
        return;
      }
      logger.log("onRandomPoolChange", `ç”¨æˆ·åˆ‡æ¢â€œä¹±åºå¼‚å˜â€ä¸º: ${value}`);
      updateEraVariableByObject({
        config: {
          incident: {
            isRandomPool: value
          }
        }
      });
    }, {
      flush: "post"
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", null, [ _cache[7] || (_cache[7] = (0, 
    external_Vue_namespaceObject.createElementVNode)("h4", null, [ (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "âš ï¸"), (0, external_Vue_namespaceObject.createTextVNode)("å¼‚å˜å•Šå¼‚å˜ï¼") ], -1)), (0, 
    external_Vue_namespaceObject.createCommentVNode)(" ===== å¼‚å˜å·¥å…·æ ï¼ˆå€’è®¡æ—¶ + ç«‹å³å¼•å‘ï¼‰ ===== "), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", Incidentsvue_type_script_setup_true_lang_ts_hoisted_1, [ _cache[4] || (_cache[4] = (0, 
    external_Vue_namespaceObject.createElementVNode)("span", {
      class: "label",
      style: {
        "min-width": "auto",
        margin: "0"
      }
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "â³"), (0, external_Vue_namespaceObject.createTextVNode)("å¼‚å˜å€’è®¡æ—¶ï¼ˆåˆ†é’Ÿï¼‰: ") ], -1)), (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", Incidentsvue_type_script_setup_true_lang_ts_hoisted_2, (0, 
    external_Vue_namespaceObject.toDisplayString)(countdownText.value), 1), (0, external_Vue_namespaceObject.createElementVNode)("span", Incidentsvue_type_script_setup_true_lang_ts_hoisted_3, [ (0, 
    external_Vue_namespaceObject.withDirectives)((0, external_Vue_namespaceObject.createElementVNode)("input", {
      id: "incident-trigger-now",
      "onUpdate:modelValue": _cache[0] || (_cache[0] = $event => immediateTrigger.value = $event),
      type: "checkbox"
    }, null, 512), [ [ external_Vue_namespaceObject.vModelCheckbox, immediateTrigger.value ] ]), _cache[2] || (_cache[2] = (0, 
    external_Vue_namespaceObject.createTextVNode)(" ç«‹å³å¼•å‘å¼‚å˜ ", -1)) ]), (0, external_Vue_namespaceObject.createElementVNode)("span", Incidentsvue_type_script_setup_true_lang_ts_hoisted_4, [ (0, 
    external_Vue_namespaceObject.withDirectives)((0, external_Vue_namespaceObject.createElementVNode)("input", {
      id: "incident-pool-random",
      "onUpdate:modelValue": _cache[1] || (_cache[1] = $event => randomPool.value = $event),
      type: "checkbox"
    }, null, 512), [ [ external_Vue_namespaceObject.vModelCheckbox, randomPool.value ] ]), _cache[3] || (_cache[3] = (0, 
    external_Vue_namespaceObject.createTextVNode)(" ä¹±åºå¼‚å˜ ", -1)) ]) ]), (0, external_Vue_namespaceObject.createElementVNode)("div", Incidentsvue_type_script_setup_true_lang_ts_hoisted_5, [ incidentCards.value.length ? ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, {
      key: 0
    }, (0, external_Vue_namespaceObject.renderList)(incidentCards.value, incident => ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      key: incident.key,
      class: "role-card"
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", Incidentsvue_type_script_setup_true_lang_ts_hoisted_6, [ _cache[5] || (_cache[5] = (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      class: "role-avatar"
    }, "å¼‚", -1)), (0, external_Vue_namespaceObject.createElementVNode)("div", null, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", Incidentsvue_type_script_setup_true_lang_ts_hoisted_7, (0, 
    external_Vue_namespaceObject.toDisplayString)(incident.name), 1), (0, external_Vue_namespaceObject.createElementVNode)("div", Incidentsvue_type_script_setup_true_lang_ts_hoisted_8, "è¿›ç¨‹ï¼š" + (0, 
    external_Vue_namespaceObject.toDisplayString)(incident.statusText), 1) ]) ]), ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(incident.fields, field => ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createElementBlock)("div", {
      key: field.label,
      class: "role-line"
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("strong", null, (0, external_Vue_namespaceObject.toDisplayString)(field.label) + "ï¼š", 1), (0, 
    external_Vue_namespaceObject.createTextVNode)((0, external_Vue_namespaceObject.toDisplayString)(field.value), 1) ]))), 128)) ]))), 128)) : ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", Incidentsvue_type_script_setup_true_lang_ts_hoisted_9, [ ..._cache[6] || (_cache[6] = [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      class: "role-card-header"
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", {
      class: "role-avatar"
    }, "âœ”"), (0, external_Vue_namespaceObject.createElementVNode)("div", null, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      class: "role-name"
    }, "æš‚æ— è®°å½•"), (0, external_Vue_namespaceObject.createElementVNode)("div", {
      class: "role-meta"
    }, "æœ€è¿‘æ²¡æœ‰å¯å±•ç¤ºçš„å¼‚å˜") ]) ], -1) ]) ])) ]) ]));
  }
});

const Incidents_exports_ = (0, exportHelper.A)(Incidentsvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-6bff0ba1" ] ]);

const Incidents = Incidents_exports_;

const FontSizeControlsvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "font-size-controls"
};

const FontSizeControlsvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "FontSizeControls",
  props: {
    uiConfig: {}
  },
  setup(__props) {
    const props = __props;
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/StatusTab/tabs/FontSizeControls");
    const currentPercent = (0, external_Vue_namespaceObject.ref)(100);
    const stepPct = (0, external_Vue_namespaceObject.ref)(10);
    const applyToDOM = pct => {
      const content = document.getElementById("content_main");
      if (content) {
        content.style.fontSize = `${pct}%`;
        logger.log("applyToDOM", `å·²åº”ç”¨å­—å·: ${pct}%`);
      } else {
        logger.warn("applyToDOM", "æœªæ‰¾åˆ° #content_main å…ƒç´ ã€‚");
      }
    };
    const clamp = n => Math.max(60, Math.min(200, Math.floor(Number(n) || 100)));
    const sanitizeStep = value => {
      const numeric = Number(value);
      if (!Number.isFinite(numeric) || numeric <= 0) {
        return 10;
      }
      return Math.floor(numeric);
    };
    const syncFromConfig = (percent, step) => {
      const clampedPercent = clamp(percent);
      const sanitizedStep = sanitizeStep(step);
      stepPct.value = sanitizedStep;
      currentPercent.value = clampedPercent;
      applyToDOM(clampedPercent);
      logger.log("syncFromConfig", `åˆå§‹åŒ–å­—å·: ${clampedPercent}%ï¼ˆæ­¥è¿›: ${sanitizedStep}%ï¼‰`);
    };
    const hasSyncedInitial = (0, external_Vue_namespaceObject.ref)(false);
    (0, external_Vue_namespaceObject.watch)(() => props.uiConfig, uiConfig => {
      if (!uiConfig) {
        hasSyncedInitial.value = false;
        return;
      }
      if (hasSyncedInitial.value) {
        return;
      }
      syncFromConfig(uiConfig.mainFontPercent, uiConfig.fontScaleStepPct);
      hasSyncedInitial.value = true;
    }, {
      immediate: true
    });
    const persistFontSize = pct => {
      currentPercent.value = pct;
      applyToDOM(pct);
      updateEraVariableByObject({
        config: {
          ui: {
            mainFontPercent: pct
          }
        }
      });
    };
    const increaseFont = () => {
      const newValue = clamp(currentPercent.value + stepPct.value);
      persistFontSize(newValue);
    };
    const decreaseFont = () => {
      const newValue = clamp(currentPercent.value - stepPct.value);
      persistFontSize(newValue);
    };
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", FontSizeControlsvue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("button", {
      id: "decrease-font",
      class: "font-size-btn",
      onClick: decreaseFont
    }, "âˆ’"), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "increase-font",
      class: "font-size-btn",
      onClick: increaseFont
    }, "+") ]));
  }
});

const FontSizeControls_exports_ = (0, exportHelper.A)(FontSizeControlsvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-b1dba0d6" ] ]);

const FontSizeControls = FontSizeControls_exports_;

const MainContentvue_type_script_setup_true_lang_ts_hoisted_1 = [ "innerHTML" ];

const MAX_RETRY = 5;

const RETRY_DELAY_MS = 200;

const MainContentvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "MainContent",
  props: {
    messageId: {
      default: null
    },
    refreshKey: {
      default: 0
    }
  },
  setup(__props) {
    const props = __props;
    const logger = new Logger("StatusTab/MainContent");
    const displayHtml = (0, external_Vue_namespaceObject.ref)("");
    const lastResolvedMessageId = (0, external_Vue_namespaceObject.ref)(null);
    const pendingTimer = (0, external_Vue_namespaceObject.ref)(null);
    const CONTENT_REGEX = /<content>\s*(?=[\s\S]*?\S[\s\S]*?<\/content>)((?:(?!<content>)[\s\S])*?)\s*<\/content>/gi;
    const clearPendingTimer = () => {
      if (pendingTimer.value !== null) {
        window.clearTimeout(pendingTimer.value);
        pendingTimer.value = null;
      }
    };
    const extractContentChunks = source => {
      if (!source || typeof source !== "string") {
        return [];
      }
      const regex = new RegExp(CONTENT_REGEX);
      const matches = [];
      let match;
      while ((match = regex.exec(source)) !== null) {
        matches.push(match[1]?.trim() ?? "");
        if (regex.lastIndex === match.index) {
          regex.lastIndex += match[0].length;
        }
      }
      return matches.filter(chunk => chunk.length > 0);
    };
    const getGlobalWithSt = () => window;
    const getRawMessageText = messageId => {
      try {
        const globalWithSt = getGlobalWithSt();
        const chatArray = globalWithSt.SillyTavern?.chat;
        const target = Array.isArray(chatArray) ? chatArray[messageId] : null;
        if (target && typeof target.mes === "string") {
          return target.mes;
        }
      } catch (error) {
        logger.warn("getRawMessageText", `è¯»å– SillyTavern.chat[${messageId}] å¤±è´¥ã€‚`, error);
      }
      return null;
    };
    const getRenderedMessageHtml = messageId => {
      try {
        const globalWithSt = getGlobalWithSt();
        const retrieveDisplayedMessage = globalWithSt.retrieveDisplayedMessage;
        if (typeof retrieveDisplayedMessage === "function") {
          const result = retrieveDisplayedMessage(messageId);
          if (result) {
            if (typeof result.html === "function") {
              return result.html();
            }
            if ("innerHTML" in result && typeof result.innerHTML === "string") {
              return result.innerHTML;
            }
          }
        }
      } catch (error) {
        logger.warn("getRenderedMessageHtml", "retrieveDisplayedMessage è°ƒç”¨å¤±è´¥ã€‚", error);
      }
      try {
        const selector = `[data-mid="${messageId}"] .mes_text`;
        const element = document.querySelector(selector);
        if (element instanceof HTMLElement) {
          return element.innerHTML;
        }
      } catch (error) {
        logger.warn("getRenderedMessageHtml", "ç›´æ¥æŸ¥è¯¢ DOM å¤±è´¥ã€‚", error);
      }
      return null;
    };
    const resolveTargetMessageId = () => {
      if (typeof props.messageId === "number" && props.messageId >= 0) {
        return props.messageId;
      }
      try {
        const globalWithSt = getGlobalWithSt();
        const chatArray = globalWithSt.SillyTavern?.chat;
        if (Array.isArray(chatArray) && chatArray.length > 0) {
          return chatArray.length - 1;
        }
      } catch (error) {
        logger.warn("resolveTargetMessageId", "æ¨æ–­æœ€æ–°æ¶ˆæ¯ ID å¤±è´¥ã€‚", error);
      }
      return null;
    };
    const mergeChunks = chunks => {
      if (chunks.length === 0) {
        return "";
      }
      return chunks.join("\n\n");
    };
    const applyContent = (messageId, chunks) => {
      displayHtml.value = mergeChunks(chunks);
      lastResolvedMessageId.value = messageId;
      logger.debug("applyContent", `å·²åˆ·æ–°æ­£æ–‡ï¼Œæ¥æºæ¶ˆæ¯ ID: ${messageId}`);
    };
    const attemptUpdate = (attempt = 1) => {
      clearPendingTimer();
      const targetId = resolveTargetMessageId();
      if (targetId === null) {
        if (attempt < MAX_RETRY) {
          pendingTimer.value = window.setTimeout(() => attemptUpdate(attempt + 1), RETRY_DELAY_MS);
        } else {
          logger.warn("attemptUpdate", "æ— æ³•ç¡®å®šå½“å‰æ¶ˆæ¯ IDï¼Œæ­£æ–‡å†…å®¹å·²æ¸…ç©ºã€‚");
          displayHtml.value = "";
          lastResolvedMessageId.value = null;
        }
        return;
      }
      const rawMessage = getRawMessageText(targetId);
      const rawChunks = extractContentChunks(rawMessage);
      if (rawChunks.length > 0) {
        applyContent(targetId, rawChunks);
        return;
      }
      const renderedHtml = getRenderedMessageHtml(targetId);
      const renderedChunks = extractContentChunks(renderedHtml);
      if (renderedChunks.length > 0) {
        applyContent(targetId, renderedChunks);
        return;
      }
      if (attempt < MAX_RETRY) {
        pendingTimer.value = window.setTimeout(() => attemptUpdate(attempt + 1), RETRY_DELAY_MS);
        return;
      }
      logger.warn("attemptUpdate", `æ¶ˆæ¯ ${targetId} ä¸­æœªæ‰¾åˆ° <content> åŒºå—ï¼Œæ¸…ç©ºæ­£æ–‡ã€‚`);
      displayHtml.value = "";
      lastResolvedMessageId.value = targetId;
    };
    const restartUpdateCycle = () => {
      attemptUpdate(1);
    };
    (0, external_Vue_namespaceObject.watch)(() => [ props.messageId, props.refreshKey ], () => {
      restartUpdateCycle();
    }, {
      immediate: true
    });
    (0, external_Vue_namespaceObject.onBeforeUnmount)(() => {
      clearPendingTimer();
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      id: "main-content",
      class: "preserve-format",
      innerHTML: displayHtml.value
    }, null, 8, MainContentvue_type_script_setup_true_lang_ts_hoisted_1));
  }
});

const MainContent_exports_ = MainContentvue_type_script_setup_true_lang_ts;

const MainContent = MainContent_exports_;

const StatusTabContentvue_type_script_setup_true_lang_ts_hoisted_1 = {
  id: "status-tabs",
  class: "status-tabs"
};

const StatusTabContentvue_type_script_setup_true_lang_ts_hoisted_2 = [ "data-tab", "onClick" ];

const StatusTabContentvue_type_script_setup_true_lang_ts_hoisted_3 = {
  id: "status-tab-content-area",
  class: "status-tab-content-area"
};

const StatusTabContentvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "StatusTabContent",
  setup(__props, {expose: __expose}) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/StatusTab/StatusTabContent");
    const worldMap = (0, external_Vue_namespaceObject.ref)(null);
    const contentBio = (0, external_Vue_namespaceObject.ref)(null);
    const contentSettingsConfig = (0, external_Vue_namespaceObject.ref)(null);
    const fontSizeUiConfig = (0, external_Vue_namespaceObject.ref)(null);
    const tabs = [ {
      id: "main",
      name: "æ­£æ–‡"
    }, {
      id: "status",
      name: "ä¸–ç•Œ"
    }, {
      id: "incidents",
      name: "å¼‚å˜å•Šå¼‚å˜ï¼"
    }, {
      id: "bio",
      name: "å±¥å†ä¸å…³ç³»"
    }, {
      id: "settings",
      name: "è®¾ç½®"
    } ];
    const activeTab = (0, external_Vue_namespaceObject.ref)("main");
    const currentMessageId = (0, external_Vue_namespaceObject.ref)(null);
    const mainContentRefreshKey = (0, external_Vue_namespaceObject.ref)(0);
    const contextRef = (0, external_Vue_namespaceObject.ref)(null);
    const statForTabs = (0, external_Vue_namespaceObject.computed)(() => contextRef.value?.statWithoutMeta ?? null);
    const runtimeForTabs = (0, external_Vue_namespaceObject.computed)(() => contextRef.value?.runtime ?? null);
    const switchTab = tabId => {
      logger.log("switchTab", `åˆ‡æ¢é€‰é¡¹å¡åˆ°: ${tabId}`);
      activeTab.value = tabId;
    };
    const update = context => {
      contextRef.value = context;
      const funcName = "update";
      const {statWithoutMeta, messageId} = context || {};
      logger.log(funcName, `æ¥æ”¶åˆ°æ›´æ–°è¯·æ±‚ï¼Œå¼€å§‹æ›´æ–°æ‰€æœ‰å­ç»„ä»¶...`, {
        context
      });
      if (!statWithoutMeta) {
        logger.warn(funcName, "ä¼ å…¥çš„ context æˆ– statWithoutMeta ä¸ºç©ºï¼Œæ— æ³•æ›´æ–° UIã€‚");
        return;
      }
      fontSizeUiConfig.value = statWithoutMeta?.config?.ui ?? null;
      logger.debug(funcName, "å·²åŒæ­¥ FontSizeControls é…ç½®", {
        hasUiConfig: !!fontSizeUiConfig.value
      });
      currentMessageId.value = typeof messageId === "number" ? messageId : null;
      mainContentRefreshKey.value += 1;
      if (worldMap.value && typeof worldMap.value.update === "function") {
        worldMap.value.update(statWithoutMeta);
        logger.debug(funcName, "å·²è°ƒç”¨ WorldMap.update");
      }
      if (contentBio.value && typeof contentBio.value.update === "function") {
        contentBio.value.update(context);
        logger.debug(funcName, "å·²è°ƒç”¨ ContentBio.update");
      }
      contentSettingsConfig.value = statWithoutMeta?.config ?? null;
      logger.debug(funcName, "å·²åŒæ­¥ ContentSettings é…ç½®", {
        hasConfig: !!contentSettingsConfig.value
      });
      const mainExtraEl = document.getElementById("main-extra");
      if (mainExtraEl) {
        const contentString = typeof statWithoutMeta.é™„åŠ æ­£æ–‡ === "string" ? statWithoutMeta.é™„åŠ æ­£æ–‡ : "";
        mainExtraEl.textContent = contentString;
        logger.debug(funcName, "å·²æ›´æ–°é™„åŠ æ­£æ–‡", {
          content: contentString.slice(0, 50) + "..."
        });
      }
      logger.log(funcName, "æ‰€æœ‰å­ç»„ä»¶æ›´æ–°å®Œæˆã€‚");
    };
    const handleContentSettingsSaved = payload => {
      logger.log("handleContentSettingsSaved", "è®¾ç½®é¡µä¿å­˜å®Œæˆ", payload);
    };
    __expose({
      update,
      worldMap,
      contentBio
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", null, [ (0, 
    external_Vue_namespaceObject.createCommentVNode)(" â–¼ [ç§»æ¤] è¿™éƒ¨åˆ† HTML ç»“æ„ä¸¥æ ¼å¤åˆ¶è‡ª app.vue "), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", StatusTabContentvue_type_script_setup_true_lang_ts_hoisted_1, [ ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(tabs, tab => (0, external_Vue_namespaceObject.createElementVNode)("button", {
      key: tab.id,
      "data-tab": tab.id,
      class: (0, external_Vue_namespaceObject.normalizeClass)({
        active: activeTab.value === tab.id
      }),
      onClick: $event => switchTab(tab.id)
    }, (0, external_Vue_namespaceObject.toDisplayString)(tab.name), 11, StatusTabContentvue_type_script_setup_true_lang_ts_hoisted_2)), 64)) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", StatusTabContentvue_type_script_setup_true_lang_ts_hoisted_3, [ (0, 
    external_Vue_namespaceObject.createCommentVNode)(" æ­£æ–‡ Tab "), (0, external_Vue_namespaceObject.createElementVNode)("div", {
      id: "content_main",
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "status-tab-content", {
        active: activeTab.value === "main"
      } ])
    }, [ (0, external_Vue_namespaceObject.createVNode)(FontSizeControls, {
      "ui-config": fontSizeUiConfig.value
    }, null, 8, [ "ui-config" ]), (0, external_Vue_namespaceObject.createVNode)(MainContent, {
      "message-id": currentMessageId.value,
      "refresh-key": mainContentRefreshKey.value
    }, null, 8, [ "message-id", "refresh-key" ]), _cache[0] || (_cache[0] = (0, external_Vue_namespaceObject.createElementVNode)("div", {
      id: "main-extra",
      class: "preserve-format"
    }, null, -1)) ], 2), (0, external_Vue_namespaceObject.createCommentVNode)(" ä¸–ç•Œ Tab (WorldMap) "), activeTab.value === "status" ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      key: 0,
      id: "content_status",
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "status-tab-content", {
        active: activeTab.value === "status"
      } ])
    }, [ (0, external_Vue_namespaceObject.createVNode)(Map_Map, {
      context: contextRef.value
    }, null, 8, [ "context" ]) ], 2)) : (0, external_Vue_namespaceObject.createCommentVNode)("v-if", true), (0, 
    external_Vue_namespaceObject.createCommentVNode)(" å¼‚å˜ Tab "), (0, external_Vue_namespaceObject.createElementVNode)("div", {
      id: "content_incidents",
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "status-tab-content", {
        active: activeTab.value === "incidents"
      } ])
    }, [ (0, external_Vue_namespaceObject.createVNode)(Incidents, {
      stat: statForTabs.value,
      runtime: runtimeForTabs.value
    }, null, 8, [ "stat", "runtime" ]) ], 2), (0, external_Vue_namespaceObject.createCommentVNode)(" å±¥å†ä¸å…³ç³» Tab "), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      id: "content_bio",
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "status-tab-content", {
        active: activeTab.value === "bio"
      } ])
    }, [ (0, external_Vue_namespaceObject.createVNode)(ContentBio, {
      ref_key: "contentBio",
      ref: contentBio
    }, null, 512) ], 2), (0, external_Vue_namespaceObject.createCommentVNode)(" è®¾ç½® Tab "), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      id: "content_settings",
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "status-tab-content", {
        active: activeTab.value === "settings"
      } ])
    }, [ (0, external_Vue_namespaceObject.createVNode)(ContentSettings, {
      config: contentSettingsConfig.value,
      onSaved: handleContentSettingsSaved
    }, null, 8, [ "config" ]) ], 2) ]), (0, external_Vue_namespaceObject.createCommentVNode)(" â–² [ç§»æ¤] ç»“æ„ç»“æŸ ") ]));
  }
});

const StatusTabContent_exports_ = (0, exportHelper.A)(StatusTabContentvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-153af6e4" ] ]);

const StatusTabContent = StatusTabContent_exports_;

const AyaNewsButtonClosedvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "AyaNewsButtonClosed",
  emits: [ "open-news" ],
  setup(__props, {emit: __emit}) {
    const emit = __emit;
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      class: "aya-news-button-closed",
      onClick: _cache[0] || (_cache[0] = $event => emit("open-news"))
    }, "æ–‡æ–‡æ–°é—»"));
  }
});

const AyaNewsButtonClosed_exports_ = (0, exportHelper.A)(AyaNewsButtonClosedvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-b15bd7b0" ] ]);

const AyaNewsButtonClosed = AyaNewsButtonClosed_exports_;

const AyaNewsButtonOpenvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "AyaNewsButtonOpen",
  emits: [ "close-news" ],
  setup(__props, {emit: __emit}) {
    const emit = __emit;
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      class: "aya-news-button-open",
      onClick: _cache[0] || (_cache[0] = $event => emit("close-news"))
    }, "æ–‡æ–‡æ–°é—»"));
  }
});

const AyaNewsButtonOpen_exports_ = (0, exportHelper.A)(AyaNewsButtonOpenvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-4b56fc8f" ] ]);

const AyaNewsButtonOpen = AyaNewsButtonOpen_exports_;

const AyaNewsPopupvue_type_script_setup_true_lang_ts_hoisted_1 = {
  id: "aya-news-popup",
  class: "aya-news-popup",
  role: "dialog"
};

const AyaNewsPopupvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "AyaNewsPopup",
  emits: [ "close" ],
  setup(__props, {expose: __expose}) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/AyaNews/AyaNewsPopup");
    const updateNews = stat => {
      const funcName = "updateNews";
      if (!stat || typeof stat !== "object") {
        logger.warn(funcName, "è°ƒç”¨å¤±è´¥ï¼šä¼ å…¥çš„ stat æ— æ•ˆã€‚", stat);
        return;
      }
      try {
        const newsContent = stat.æ–‡æ–‡æ–°é—» ?? "";
        logger.log(funcName, "å°†æ›´æ–°æ–°é—»æ–‡æœ¬", {
          preview: String(newsContent).slice(0, 50)
        });
        format_text("aya-news-content-popup", newsContent);
        logger.debug(funcName, "æ–°é—»æ–‡æœ¬å·²å†™å…¥ DOM å®Œæˆ");
      } catch (e) {
        logger.error(funcName, "æ›´æ–°æ–°é—»å†…å®¹æ—¶å‘ç”Ÿå¼‚å¸¸", e);
      }
    };
    __expose({
      updateNews
    });
    (0, external_Vue_namespaceObject.onMounted)(() => {});
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", AyaNewsPopupvue_type_script_setup_true_lang_ts_hoisted_1, [ ..._cache[0] || (_cache[0] = [ (0, 
    external_Vue_namespaceObject.createElementVNode)("h4", null, [ (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "ğŸ“°"), (0, external_Vue_namespaceObject.createTextVNode)("æ–‡æ–‡æ–°é—»") ], -1), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      id: "aya-news-content-popup",
      class: "news-body preserve-format"
    }, "â€”", -1) ]) ]));
  }
});

const AyaNewsPopup_exports_ = (0, exportHelper.A)(AyaNewsPopupvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-08972433" ] ]);

const AyaNewsPopup = AyaNewsPopup_exports_;

const AyaNewsContainervue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "aya-news-container"
};

const AyaNewsContainervue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "AyaNewsContainer",
  setup(__props, {expose: __expose}) {
    const newsVisible = (0, external_Vue_namespaceObject.ref)(false);
    const ayaNewsPopup = (0, external_Vue_namespaceObject.ref)(null);
    __expose({
      updateNews: stat => {
        ayaNewsPopup.value?.updateNews(stat);
      }
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", AyaNewsContainervue_type_script_setup_true_lang_ts_hoisted_1, [ !newsVisible.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(AyaNewsButtonClosed, {
      key: 0,
      onOpenNews: _cache[0] || (_cache[0] = $event => newsVisible.value = true)
    })) : ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(AyaNewsButtonOpen, {
      key: 1,
      onCloseNews: _cache[1] || (_cache[1] = $event => newsVisible.value = false)
    })), (0, external_Vue_namespaceObject.withDirectives)((0, external_Vue_namespaceObject.createVNode)(AyaNewsPopup, {
      ref_key: "ayaNewsPopup",
      ref: ayaNewsPopup
    }, null, 512), [ [ external_Vue_namespaceObject.vShow, newsVisible.value ] ]) ]));
  }
});

const AyaNewsContainer_exports_ = (0, exportHelper.A)(AyaNewsContainervue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-dfff4c24" ] ]);

const AyaNewsContainer = AyaNewsContainer_exports_;

const Particlevue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "Particle",
  props: {
    particleType: {},
    dx: {},
    dy: {},
    rot: {},
    delay: {},
    initialX: {},
    initialY: {}
  },
  emits: [ "destroy" ],
  setup(__props, {emit: __emit}) {
    const props = __props;
    const emit = __emit;
    const particleContent = (0, external_Vue_namespaceObject.computed)(() => props.particleType === "skull" ? "â˜ " : "â¤");
    const particleStyle = (0, external_Vue_namespaceObject.computed)(() => ({
      left: `${props.initialX}%`,
      top: `${props.initialY}%`,
      "--dx": `${props.dx}px`,
      "--dy": `${props.dy}px`,
      "--rot": `${props.rot}deg`,
      animationDelay: `${props.delay}s`
    }));
    (0, external_Vue_namespaceObject.onMounted)(() => {
      setTimeout(() => {
        emit("destroy");
      }, 1500);
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("span", {
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "GensokyoOrigin-Particle", `GensokyoOrigin-Particle--${__props.particleType}` ]),
      style: (0, external_Vue_namespaceObject.normalizeStyle)(particleStyle.value)
    }, (0, external_Vue_namespaceObject.toDisplayString)(particleContent.value), 7));
  }
});

const Particle_exports_ = Particlevue_type_script_setup_true_lang_ts;

const Particle = Particle_exports_;

const ParticleEmittervue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "particle-emitter-root"
};

const ParticleEmittervue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "ParticleEmitter",
  props: {
    active: {
      type: Boolean
    },
    particleType: {},
    emissionRate: {}
  },
  setup(__props, {expose: __expose}) {
    const props = __props;
    const particles = (0, external_Vue_namespaceObject.ref)([]);
    let particleIdCounter = 0;
    const ticker = (0, external_Vue_namespaceObject.ref)(null);
    const createParticle = (type, delay = 0) => {
      particleIdCounter++;
      particles.value.push({
        id: particleIdCounter,
        type,
        initialX: 5 + Math.random() * 90,
        initialY: 10 + Math.random() * 80,
        dx: (Math.random() - .5) * 60,
        dy: -40 - Math.random() * 40,
        rot: (Math.random() - .5) * 40,
        delay
      });
    };
    const removeParticle = id => {
      particles.value = particles.value.filter(p => p.id !== id);
    };
    const startTicker = () => {
      if (ticker.value) return;
      const rate = props.emissionRate || 2;
      ticker.value = setInterval(() => {
        createParticle(props.particleType);
      }, 1e3 / rate);
    };
    const stopTicker = () => {
      if (ticker.value) {
        clearInterval(ticker.value);
        ticker.value = null;
      }
    };
    (0, external_Vue_namespaceObject.watch)(() => props.active, isActive => {
      if (isActive) {
        startTicker();
      } else {
        stopTicker();
      }
    }, {
      immediate: true
    });
    const burst = (type, count) => {
      for (let i = 0; i < count; i++) {
        createParticle(type, i * .05);
      }
    };
    (0, external_Vue_namespaceObject.onUnmounted)(() => {
      stopTicker();
    });
    __expose({
      burst
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", ParticleEmittervue_type_script_setup_true_lang_ts_hoisted_1, [ ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(particles.value, p => ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createBlock)(Particle, {
      key: p.id,
      "particle-type": p.type,
      "initial-x": p.initialX,
      "initial-y": p.initialY,
      dx: p.dx,
      dy: p.dy,
      rot: p.rot,
      delay: p.delay,
      onDestroy: $event => removeParticle(p.id)
    }, null, 8, [ "particle-type", "initial-x", "initial-y", "dx", "dy", "rot", "delay", "onDestroy" ]))), 128)) ]));
  }
});

const ParticleEmitter_exports_ = ParticleEmittervue_type_script_setup_true_lang_ts;

const ParticleEmitter = ParticleEmitter_exports_;

const StyledProgressBarvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "StyledProgressBar",
  props: {
    value: {},
    max: {},
    loveThreshold: {},
    hateThreshold: {},
    size: {}
  },
  setup(__props) {
    const props = __props;
    const barWidth = (0, external_Vue_namespaceObject.computed)(() => {
      const max = props.max || 100;
      return `${Math.min(Math.abs(props.value) / max * 100, 100)}%`;
    });
    const barClasses = (0, external_Vue_namespaceObject.computed)(() => {
      const classes = {
        "size-small": props.size === "small",
        "size-large": props.size !== "small",
        rtl: props.value < 0
      };
      if (props.hateThreshold !== undefined && props.value <= props.hateThreshold) {
        classes["very-hate"] = true;
      } else if (props.value < 0) {
        classes["negative"] = true;
      } else if (props.loveThreshold !== undefined && props.value >= props.loveThreshold) {
        classes["very-love"] = true;
      }
      return classes;
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "styled-progress-bar", barClasses.value ])
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", {
      class: "val",
      style: (0, external_Vue_namespaceObject.normalizeStyle)({
        width: barWidth.value
      })
    }, null, 4) ], 2));
  }
});

const StyledProgressBar_exports_ = (0, exportHelper.A)(StyledProgressBarvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-0390f826" ] ]);

const StyledProgressBar = StyledProgressBar_exports_;

const AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "affection-display"
};

const AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_2 = {
  class: "info-line"
};

const AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "aff-num"
};

const AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_4 = {
  class: "aff-stage"
};

const AffectionDisplayvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "AffectionDisplay",
  props: {
    character: {
      type: Object,
      required: true
    },
    statWithoutMeta: {
      type: Object,
      required: true
    },
    runtime: {
      type: Object,
      required: true
    },
    size: {
      type: String,
      required: true
    }
  },
  setup(__props) {
    const props = __props;
    const affectionValue = (0, external_Vue_namespaceObject.computed)(() => props.character?.å¥½æ„Ÿåº¦ || 0);
    const loveThreshold = (0, external_Vue_namespaceObject.computed)(() => Number(props.statWithoutMeta?.config?.affection?.loveThreshold) || 100);
    const hateThreshold = (0, external_Vue_namespaceObject.computed)(() => Number(props.statWithoutMeta?.config?.affection?.hateThreshold) || -100);
    const affectionStage = (0, external_Vue_namespaceObject.computed)(() => {
      if (!props.runtime || !props.character?.id) return "â€”";
      return props.runtime.character?.chars[props.character.id]?.affectionStage?.name || "â€”";
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_2, [ _cache[0] || (_cache[0] = (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, "å¥½æ„Ÿåº¦ï¼š", -1)), (0, 
    external_Vue_namespaceObject.createElementVNode)("span", AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_3, (0, 
    external_Vue_namespaceObject.toDisplayString)(affectionValue.value), 1), (0, external_Vue_namespaceObject.createElementVNode)("span", AffectionDisplayvue_type_script_setup_true_lang_ts_hoisted_4, (0, 
    external_Vue_namespaceObject.toDisplayString)(affectionStage.value), 1) ]), (0, 
    external_Vue_namespaceObject.createVNode)(StyledProgressBar, {
      value: affectionValue.value,
      "love-threshold": loveThreshold.value,
      "hate-threshold": hateThreshold.value,
      size: __props.size
    }, null, 8, [ "value", "love-threshold", "hate-threshold", "size" ]) ]));
  }
});

const AffectionDisplay_exports_ = (0, exportHelper.A)(AffectionDisplayvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-d6059de4" ] ]);

const AffectionDisplay = AffectionDisplay_exports_;

const RoleCardvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "GensokyoOrigin-RoleCard-header"
};

const RoleCardvue_type_script_setup_true_lang_ts_hoisted_2 = {
  class: "GensokyoOrigin-RoleCard-avatar"
};

const RoleCardvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "GensokyoOrigin-RoleCard-name"
};

const RoleCardvue_type_script_setup_true_lang_ts_hoisted_4 = {
  class: "GensokyoOrigin-RoleCard-meta"
};

const RoleCardvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "RoleCard",
  props: {
    character: {
      type: Object,
      required: true
    },
    statWithoutMeta: {
      type: Object,
      required: true
    },
    runtime: {
      type: Object,
      required: true
    }
  },
  emits: [ "show-details" ],
  setup(__props) {
    const props = __props;
    const particleEmitter = (0, external_Vue_namespaceObject.ref)(null);
    const affectionValue = (0, external_Vue_namespaceObject.computed)(() => props.character?.å¥½æ„Ÿåº¦ || 0);
    const loveThreshold = (0, external_Vue_namespaceObject.computed)(() => Number(props.statWithoutMeta?.config?.affection?.loveThreshold) || 100);
    const hateThreshold = (0, external_Vue_namespaceObject.computed)(() => Number(props.statWithoutMeta?.config?.affection?.hateThreshold) || -100);
    const affectionState = (0, external_Vue_namespaceObject.computed)(() => {
      if (affectionValue.value >= loveThreshold.value) return "love";
      if (affectionValue.value <= hateThreshold.value) return "hate";
      return "neutral";
    });
    (0, external_Vue_namespaceObject.watch)(affectionState, (newState, oldState) => {
      if (newState !== oldState && particleEmitter.value) {
        if (newState === "love") {
          particleEmitter.value.burst("heart", 10);
        } else if (newState === "hate") {
          particleEmitter.value.burst("skull", 8);
        }
      }
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      class: "GensokyoOrigin-RoleCard-wrapper",
      onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit("show-details", __props.character))
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", RoleCardvue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", RoleCardvue_type_script_setup_true_lang_ts_hoisted_2, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.character.name.slice(0, 1)), 1), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", null, [ (0, external_Vue_namespaceObject.createElementVNode)("div", RoleCardvue_type_script_setup_true_lang_ts_hoisted_3, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.character.name), 1), (0, external_Vue_namespaceObject.createElementVNode)("div", RoleCardvue_type_script_setup_true_lang_ts_hoisted_4, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.character["æ‰€åœ¨åœ°åŒº"] || "æœªçŸ¥"), 1) ]) ]), (0, 
    external_Vue_namespaceObject.createVNode)(AffectionDisplay, {
      character: __props.character,
      "stat-without-meta": __props.statWithoutMeta,
      runtime: __props.runtime,
      size: "small"
    }, null, 8, [ "character", "stat-without-meta", "runtime" ]), (0, external_Vue_namespaceObject.createVNode)(ParticleEmitter, {
      ref_key: "particleEmitter",
      ref: particleEmitter,
      active: affectionState.value === "love" || affectionState.value === "hate",
      "particle-type": affectionState.value === "hate" ? "skull" : "heart",
      "emission-rate": 2
    }, null, 8, [ "active", "particle-type" ]) ]));
  }
});

const RoleCard_exports_ = RoleCardvue_type_script_setup_true_lang_ts;

const RoleCard = RoleCard_exports_;

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "GensokyoOrigin-RoleDetailPopup-popup"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_2 = {
  class: "GensokyoOrigin-RoleDetailPopup-header"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "GensokyoOrigin-RoleDetailPopup-avatar"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_4 = {
  class: "GensokyoOrigin-RoleDetailPopup-name"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_5 = {
  class: "GensokyoOrigin-RoleDetailPopup-meta"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_6 = {
  class: "GensokyoOrigin-RoleDetailPopup-details-grid"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_7 = {
  class: "GensokyoOrigin-RoleDetailPopup-detail-item"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_8 = {
  class: "GensokyoOrigin-RoleDetailPopup-detail-item full-width"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_9 = {
  key: 0,
  class: "GensokyoOrigin-RoleDetailPopup-section"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_10 = {
  class: "GensokyoOrigin-RoleDetailPopup-section-title"
};

const _hoisted_11 = {
  class: "GensokyoOrigin-RoleDetailPopup-section-desc"
};

const _hoisted_12 = {
  class: "GensokyoOrigin-RoleDetailPopup-details-grid"
};

const _hoisted_13 = {
  class: "GensokyoOrigin-RoleDetailPopup-detail-item"
};

const _hoisted_14 = {
  key: 0,
  class: "GensokyoOrigin-RoleDetailPopup-detail-item"
};

const _hoisted_15 = {
  key: 1,
  class: "GensokyoOrigin-RoleDetailPopup-detail-item full-width"
};

const _hoisted_16 = {
  key: 2,
  class: "GensokyoOrigin-RoleDetailPopup-detail-item full-width"
};

const RoleDetailPopupvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "RoleDetailPopup",
  props: {
    character: {
      type: Object,
      required: true
    },
    statWithoutMeta: {
      type: Object,
      required: true
    },
    runtime: {
      type: Object,
      required: true
    }
  },
  emits: [ "close" ],
  setup(__props) {
    const props = __props;
    const particleEmitter = (0, external_Vue_namespaceObject.ref)(null);
    const charRuntimeData = (0, external_Vue_namespaceObject.computed)(() => {
      if (!props.runtime?.character?.chars || !props.character.id) return null;
      return props.runtime.character.chars[props.character.id];
    });
    const affectionStageInfo = (0, external_Vue_namespaceObject.computed)(() => charRuntimeData.value?.affectionStage);
    const decisionText = (0, external_Vue_namespaceObject.computed)(() => {
      const decision = charRuntimeData.value?.decision;
      const companionDecision = charRuntimeData.value?.companionDecision;
      if (decision) {
        let text = `æ­£åœ¨ ${toText(decision.do)}`;
        if (decision.to) text += ` å‰å¾€ ${toText(decision.to)}`;
        if (decision.from) text += ` (ä» ${toText(decision.from)} å‡ºå‘)`;
        return text;
      }
      if (companionDecision) {
        return `åŸæœ¬è®¡åˆ’ ${toText(companionDecision.do)}, ä½†å› ä¸ä½ åŒè¡Œè€Œæš‚ç¼“ã€‚`;
      }
      return "â€”";
    });
    const toText = v => {
      if (Array.isArray(v)) return v.length ? v.join("ï¼›") : "â€”";
      if (v == null || v === "") return "â€”";
      return String(v);
    };
    const affectionValue = (0, external_Vue_namespaceObject.computed)(() => props.character?.å¥½æ„Ÿåº¦ || 0);
    const loveThreshold = (0, external_Vue_namespaceObject.computed)(() => Number(props.statWithoutMeta?.config?.affection?.loveThreshold) || 100);
    const hateThreshold = (0, external_Vue_namespaceObject.computed)(() => Number(props.statWithoutMeta?.config?.affection?.hateThreshold) || -100);
    const affectionState = (0, external_Vue_namespaceObject.computed)(() => {
      if (affectionValue.value >= loveThreshold.value) return "love";
      if (affectionValue.value <= hateThreshold.value) return "hate";
      return "neutral";
    });
    (0, external_Vue_namespaceObject.watch)(affectionState, (newState, oldState) => {
      if (newState !== oldState && particleEmitter.value) {
        if (newState === "love") {
          particleEmitter.value.burst("heart", 15);
        } else if (newState === "hate") {
          particleEmitter.value.burst("skull", 12);
        }
      }
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", {
      class: "GensokyoOrigin-RoleDetailPopup-overlay",
      onClick: _cache[1] || (_cache[1] = (0, external_Vue_namespaceObject.withModifiers)($event => _ctx.$emit("close"), [ "self" ]))
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("button", {
      class: "GensokyoOrigin-RoleDetailPopup-close-btn",
      onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit("close"))
    }, "Ã—"), (0, external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_2, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_3, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.character.name.slice(0, 1)), 1), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", null, [ (0, external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_4, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.character.name), 1), (0, external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_5, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.character["æ‰€åœ¨åœ°åŒº"] || "æœªçŸ¥"), 1) ]) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_6, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_7, [ _cache[2] || (_cache[2] = (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, "å±…ä½åœ°:", -1)), (0, 
    external_Vue_namespaceObject.createTextVNode)(" " + (0, external_Vue_namespaceObject.toDisplayString)(toText(__props.character.å±…ä½åœ°åŒº)), 1) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_8, [ _cache[3] || (_cache[3] = (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, "å½“å‰å†³ç­–:", -1)), (0, 
    external_Vue_namespaceObject.createTextVNode)(" " + (0, external_Vue_namespaceObject.toDisplayString)(decisionText.value), 1) ]) ]), (0, 
    external_Vue_namespaceObject.createCommentVNode)(" Affection Details "), affectionStageInfo.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_9, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("h3", RoleDetailPopupvue_type_script_setup_true_lang_ts_hoisted_10, "å¥½æ„Ÿåº¦é˜¶æ®µ: " + (0, 
    external_Vue_namespaceObject.toDisplayString)(affectionStageInfo.value.name), 1), (0, 
    external_Vue_namespaceObject.createElementVNode)("p", _hoisted_11, (0, external_Vue_namespaceObject.toDisplayString)(affectionStageInfo.value.describe), 1), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", _hoisted_12, [ (0, external_Vue_namespaceObject.createElementVNode)("div", _hoisted_13, [ _cache[4] || (_cache[4] = (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, "è€å¿ƒå€¼:", -1)), (0, 
    external_Vue_namespaceObject.createTextVNode)(" " + (0, external_Vue_namespaceObject.toDisplayString)(toText(affectionStageInfo.value.patienceUnit)), 1) ]), affectionStageInfo.value.affectionGrowthLimit ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", _hoisted_14, [ _cache[5] || (_cache[5] = (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, "å¥½æ„Ÿå¢é•¿ä¸Šé™:", -1)), (0, 
    external_Vue_namespaceObject.createTextVNode)(" è½¯ä¸Šé™ " + (0, external_Vue_namespaceObject.toDisplayString)(affectionStageInfo.value.affectionGrowthLimit.max) + ", è¶…å‡ºåé™¤ä»¥ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(affectionStageInfo.value.affectionGrowthLimit.divisor), 1) ])) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true), affectionStageInfo.value.visit ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", _hoisted_15, [ _cache[6] || (_cache[6] = (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, "æ‹œè®¿è§„åˆ™:", -1)), (0, 
    external_Vue_namespaceObject.createTextVNode)(" " + (0, external_Vue_namespaceObject.toDisplayString)(affectionStageInfo.value.visit.enabled ? "ä¼š" : "ä¸ä¼š") + "æ‹œè®¿ã€‚åŸºç¡€æ¦‚ç‡ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(((affectionStageInfo.value.visit.probBase ?? 0) * 100).toFixed(0)) + "%, å¥½æ„Ÿå½±å“ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(((affectionStageInfo.value.visit.probK ?? 0) * 100).toFixed(0)) + "%ã€‚å†·å´åˆ·æ–°äº " + (0, 
    external_Vue_namespaceObject.toDisplayString)(affectionStageInfo.value.visit.coolUnit), 1) ])) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true), affectionStageInfo.value.forgettingSpeed?.length ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", _hoisted_16, [ _cache[7] || (_cache[7] = (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, "é—å¿˜è§„åˆ™:", -1)), ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(affectionStageInfo.value.forgettingSpeed, (rule, index) => ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("span", {
      key: index
    }, " äº " + (0, external_Vue_namespaceObject.toDisplayString)(rule.triggerFlag) + " è§¦å‘, é™ä½ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(rule.decrease) + " ç‚¹å¥½æ„Ÿã€‚ ", 1))), 128)) ])) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true) ]) ])) : (0, external_Vue_namespaceObject.createCommentVNode)("v-if", true), (0, 
    external_Vue_namespaceObject.createVNode)(AffectionDisplay, {
      character: __props.character,
      "stat-without-meta": __props.statWithoutMeta,
      runtime: __props.runtime,
      size: "large"
    }, null, 8, [ "character", "stat-without-meta", "runtime" ]), (0, external_Vue_namespaceObject.createVNode)(ParticleEmitter, {
      ref_key: "particleEmitter",
      ref: particleEmitter,
      active: affectionState.value === "love" || affectionState.value === "hate",
      "particle-type": affectionState.value === "hate" ? "skull" : "heart",
      "emission-rate": 3
    }, null, 8, [ "active", "particle-type" ]) ]) ]));
  }
});

const RoleDetailPopup_exports_ = RoleDetailPopupvue_type_script_setup_true_lang_ts;

const RoleDetailPopup = RoleDetailPopup_exports_;

const RoleRibbonContainervue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "role-ribbon-container"
};

const RoleRibbonContainervue_type_script_setup_true_lang_ts_hoisted_2 = {
  key: 0,
  class: "role-card-placeholder"
};

const ribbonScrollStep = 320;

const RoleRibbonContainervue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "RoleRibbonContainer",
  setup(__props, {expose: __expose}) {
    const logger = new Logger("RoleRibbon");
    const state = (0, external_Vue_namespaceObject.reactive)({
      stat: null,
      runtime: null
    });
    const ribbon = (0, external_Vue_namespaceObject.ref)(null);
    const selectedCharacter = (0, external_Vue_namespaceObject.ref)(null);
    const nearbyCharacters = (0, external_Vue_namespaceObject.computed)(() => {
      const funcName = "nearbyCharacters";
      const coLocatedIds = state.runtime?.character?.partitions?.coLocated;
      logger.debug(funcName, "coLocatedIds:", external_default().cloneDeep(coLocatedIds));
      if (!coLocatedIds || !state.stat?.chars || !state.runtime?.character?.chars) {
        logger.debug(funcName, "ä¾èµ–æ•°æ®ä¸å®Œæ•´ï¼Œè¿”å›ç©ºæ•°ç»„ã€‚");
        return [];
      }
      return coLocatedIds.map(charId => {
        const charStat = state.stat?.chars?.[charId];
        const charRuntime = state.runtime?.character?.chars?.[charId];
        logger.debug(funcName, `[${charId}] charStat:`, external_default().cloneDeep(charStat));
        logger.debug(funcName, `[${charId}] charRuntime:`, external_default().cloneDeep(charRuntime));
        if (!charStat) {
          logger.warn(funcName, `åœ¨ stat.chars ä¸­æœªæ‰¾åˆ°è§’è‰² ${charId} çš„æ•°æ®ï¼Œå·²è·³è¿‡ã€‚`);
          return null;
        }
        const displayName = charRuntime?.name || charId;
        logger.debug(funcName, `[${charId}] æœ€ç»ˆæ˜¾ç¤ºåç§°: ${displayName}`);
        return {
          id: charId,
          ...charStat,
          ...charRuntime,
          name: displayName
        };
      }).filter(Boolean);
    });
    const scroll = direction => {
      ribbon.value?.scrollBy({
        left: direction * ribbonScrollStep,
        behavior: "smooth"
      });
    };
    const updateRibbon = context => {
      const funcName = "updateRibbon";
      logger.debug(funcName, "æ¥æ”¶åˆ°æ–°çš„ä¸Šä¸‹æ–‡æ•°æ®", {
        stat: external_default().cloneDeep(context.statWithoutMeta),
        runtime: external_default().cloneDeep(context.runtime)
      });
      state.stat = context.statWithoutMeta;
      state.runtime = context.runtime;
    };
    __expose({
      updateRibbon
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", RoleRibbonContainervue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("button", {
      id: "ribbon-left",
      class: "ribbon-arrow left",
      onClick: _cache[0] || (_cache[0] = $event => scroll(-1))
    }, "â€¹"), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "ribbon-right",
      class: "ribbon-arrow right",
      onClick: _cache[1] || (_cache[1] = $event => scroll(1))
    }, "â€º"), (0, external_Vue_namespaceObject.createElementVNode)("div", {
      id: "role-ribbon",
      ref_key: "ribbon",
      ref: ribbon,
      class: "role-ribbon"
    }, [ ((0, external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(nearbyCharacters.value, char => ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createBlock)(RoleCard, {
      key: char.id,
      character: char,
      "stat-without-meta": state.stat,
      runtime: state.runtime,
      onShowDetails: _cache[2] || (_cache[2] = $event => selectedCharacter.value = $event)
    }, null, 8, [ "character", "stat-without-meta", "runtime" ]))), 128)), !nearbyCharacters.value.length ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", RoleRibbonContainervue_type_script_setup_true_lang_ts_hoisted_2, "é™„è¿‘æš‚æ— è§’è‰²")) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true) ], 512), selectedCharacter.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(RoleDetailPopup, {
      key: 0,
      character: selectedCharacter.value,
      "stat-without-meta": state.stat,
      runtime: state.runtime,
      onClose: _cache[3] || (_cache[3] = $event => selectedCharacter.value = null)
    }, null, 8, [ "character", "stat-without-meta", "runtime" ])) : (0, external_Vue_namespaceObject.createCommentVNode)("v-if", true) ]));
  }
});

const RoleRibbonContainer_exports_ = (0, exportHelper.A)(RoleRibbonContainervue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-57aa0965" ] ]);

const RoleRibbonContainer = RoleRibbonContainer_exports_;

const TimeButtonClosedvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "TimeButtonClosed",
  props: {
    clockInfo: {}
  },
  emits: [ "open-calendar" ],
  setup(__props) {
    const props = __props;
    const timeText = (0, external_Vue_namespaceObject.computed)(() => {
      if (!props.clockInfo) return "â€”:â€”";
      return props.clockInfo.hm ? `${props.clockInfo.hm} Â· ${props.clockInfo.periodName || ""}` : props.clockInfo.iso || "â€”";
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      id: "banner-time-closed",
      class: "banner-chip",
      onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit("open-calendar"))
    }, [ _cache[1] || (_cache[1] = (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "â°", -1)), (0, external_Vue_namespaceObject.createElementVNode)("span", null, (0, 
    external_Vue_namespaceObject.toDisplayString)(timeText.value), 1) ]));
  }
});

const TimeButtonClosed_exports_ = (0, exportHelper.A)(TimeButtonClosedvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-37a35e60" ] ]);

const TimeButtonClosed = TimeButtonClosed_exports_;

const TimeButtonOpenvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "TimeButtonOpen",
  emits: [ "close-calendar" ],
  setup(__props) {
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      id: "banner-time-open",
      class: "banner-chip-open",
      onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit("close-calendar"))
    }, [ ..._cache[1] || (_cache[1] = [ (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "ğŸ“…", -1), (0, external_Vue_namespaceObject.createElementVNode)("span", null, "æ—¥å†", -1), (0, 
    external_Vue_namespaceObject.createElementVNode)("span", {
      class: "close-icon"
    }, "æ”¶èµ·", -1) ]) ]));
  }
});

const TimeButtonOpen_exports_ = (0, exportHelper.A)(TimeButtonOpenvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-a8d897e6" ] ]);

const TimeButtonOpen = TimeButtonOpen_exports_;

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "cal-day-container"
};

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_2 = [ "data-importance" ];

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "dnum"
};

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_4 = {
  key: 1,
  class: "cal-day-placeholder"
};

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_5 = {
  key: 2,
  class: "fest-popover"
};

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_6 = {
  class: "fest-header"
};

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_7 = {
  key: 0,
  class: "fest-host"
};

const CalendarDayvue_type_script_setup_true_lang_ts_hoisted_8 = {
  key: 0,
  class: "fest-customs"
};

const CalendarDayvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "CalendarDay",
  props: {
    day: {}
  },
  setup(__props) {
    const props = __props;
    const hasFestivals = (0, external_Vue_namespaceObject.computed)(() => !!(props.day.festivals && props.day.festivals.length > 0));
    const showPopover = (0, external_Vue_namespaceObject.ref)(false);
    const highestImportance = (0, external_Vue_namespaceObject.computed)(() => {
      if (!hasFestivals.value || !props.day.festivals) return 0;
      return Math.max(...props.day.festivals.map(f => f.importance ?? 0));
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", CalendarDayvue_type_script_setup_true_lang_ts_hoisted_1, [ !__props.day.isPlaceholder ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      key: 0,
      type: "button",
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "cal-day-btn", {
        today: __props.day.isToday,
        "has-fest": hasFestivals.value
      } ]),
      "data-importance": highestImportance.value,
      onMouseenter: _cache[0] || (_cache[0] = $event => showPopover.value = hasFestivals.value),
      onMouseleave: _cache[1] || (_cache[1] = $event => showPopover.value = false)
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("span", CalendarDayvue_type_script_setup_true_lang_ts_hoisted_3, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.day.date), 1) ], 42, CalendarDayvue_type_script_setup_true_lang_ts_hoisted_2)) : ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", CalendarDayvue_type_script_setup_true_lang_ts_hoisted_4)), showPopover.value && hasFestivals.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", CalendarDayvue_type_script_setup_true_lang_ts_hoisted_5, [ ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(__props.day.festivals, fest => ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createElementBlock)("div", {
      key: fest.name,
      class: "fest-item"
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", CalendarDayvue_type_script_setup_true_lang_ts_hoisted_6, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, (0, external_Vue_namespaceObject.toDisplayString)(fest.name), 1), fest.host ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("span", CalendarDayvue_type_script_setup_true_lang_ts_hoisted_7, "@ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(fest.host), 1)) : (0, external_Vue_namespaceObject.createCommentVNode)("v-if", true) ]), fest.customs?.length ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("ul", CalendarDayvue_type_script_setup_true_lang_ts_hoisted_8, [ ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(fest.customs, (custom, index) => ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createElementBlock)("li", {
      key: index
    }, (0, external_Vue_namespaceObject.toDisplayString)(custom), 1))), 128)) ])) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true) ]))), 128)) ])) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true) ]));
  }
});

const CalendarDay_exports_ = (0, exportHelper.A)(CalendarDayvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-465be192" ] ]);

const CalendarDay = CalendarDay_exports_;

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_1 = {
  id: "cal-content",
  class: "cal-content",
  role: "region"
};

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_2 = {
  class: "cal-head"
};

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "cal-title"
};

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_4 = {
  id: "cal-month",
  class: "month"
};

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_5 = {
  id: "cal-year",
  class: "year"
};

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_6 = {
  class: "cal-nav"
};

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_7 = {
  class: "cal-body"
};

const CalendarContentvue_type_script_setup_true_lang_ts_hoisted_8 = {
  id: "cal-grid",
  class: "cal-grid"
};

const CalendarContentvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "CalendarContent",
  props: {
    clockInfo: {}
  },
  setup(__props) {
    const props = __props;
    const displayMonth = (0, external_Vue_namespaceObject.ref)(new Date);
    const monthLabel = (0, external_Vue_namespaceObject.computed)(() => `${displayMonth.value.getMonth() + 1}æœˆ`);
    const yearLabel = (0, external_Vue_namespaceObject.computed)(() => `${displayMonth.value.getFullYear()}å¹´`);
    const festivals = (0, external_Vue_namespaceObject.computed)(() => props.clockInfo?.festivals || []);
    const updateMonth = direction => {
      const newMonth = new Date(displayMonth.value);
      newMonth.setMonth(newMonth.getMonth() + (direction === "prev" ? -1 : 1));
      displayMonth.value = newMonth;
    };
    const resetMonth = () => {
      displayMonth.value = props.clockInfo?.iso ? new Date(props.clockInfo.iso) : new Date;
    };
    const calendarDays = (0, external_Vue_namespaceObject.computed)(() => {
      if (!props.clockInfo) return [];
      const year = displayMonth.value.getFullYear();
      const month = displayMonth.value.getMonth();
      const today = props.clockInfo.iso ? new Date(props.clockInfo.iso) : new Date;
      const firstDayOfMonth = new Date(year, month, 1);
      const lastDayOfMonth = new Date(year, month + 1, 0);
      const daysInMonth = lastDayOfMonth.getDate();
      const startDayOfWeek = (firstDayOfMonth.getDay() + 6) % 7;
      const days = [];
      for (let i = 0; i < startDayOfWeek; i++) {
        days.push({
          isPlaceholder: true
        });
      }
      for (let i = 1; i <= daysInMonth; i++) {
        const dayFestivals = festivals.value.filter(f => f.month === month + 1 && i >= f.start_day && i <= f.end_day);
        const isToday = year === today.getFullYear() && month === today.getMonth() && i === today.getDate();
        days.push({
          date: i,
          isToday,
          isPlaceholder: false,
          festivals: dayFestivals
        });
      }
      return days;
    });
    (0, external_Vue_namespaceObject.watch)(() => props.clockInfo, newClockInfo => {
      if (newClockInfo?.iso) {
        displayMonth.value = new Date(newClockInfo.iso);
      }
    }, {
      immediate: true
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_2, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_3, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("span", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_4, (0, 
    external_Vue_namespaceObject.toDisplayString)(monthLabel.value), 1), (0, external_Vue_namespaceObject.createElementVNode)("span", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_5, (0, 
    external_Vue_namespaceObject.toDisplayString)(yearLabel.value), 1) ]), (0, external_Vue_namespaceObject.createElementVNode)("div", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_6, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("button", {
      id: "cal-prev",
      class: "cal-btn",
      title: "ä¸Šä¸€æœˆ",
      onClick: _cache[0] || (_cache[0] = $event => updateMonth("prev"))
    }, "â—€"), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "cal-today",
      class: "cal-btn",
      title: "å›åˆ°ä»Šå¤©",
      onClick: resetMonth
    }, "â—"), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "cal-next",
      class: "cal-btn",
      title: "ä¸‹ä¸€æœˆ",
      onClick: _cache[1] || (_cache[1] = $event => updateMonth("next"))
    }, "â–¶") ]) ]), (0, external_Vue_namespaceObject.createElementVNode)("div", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_7, [ _cache[2] || (_cache[2] = (0, 
    external_Vue_namespaceObject.createStaticVNode)('<div class="cal-week" data-v-40fd130e><div class="w" data-v-40fd130e>ä¸€</div><div class="w" data-v-40fd130e>äºŒ</div><div class="w" data-v-40fd130e>ä¸‰</div><div class="w" data-v-40fd130e>å››</div><div class="w" data-v-40fd130e>äº”</div><div class="w" data-v-40fd130e>å…­</div><div class="w" data-v-40fd130e>æ—¥</div></div>', 1)), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", CalendarContentvue_type_script_setup_true_lang_ts_hoisted_8, [ ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(calendarDays.value, (day, index) => ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(CalendarDay, {
      key: index,
      day
    }, null, 8, [ "day" ]))), 128)) ]) ]) ]));
  }
});

const CalendarContent_exports_ = (0, exportHelper.A)(CalendarContentvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-40fd130e" ] ]);

const CalendarContent = CalendarContent_exports_;

const TimeContainervue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "time-container"
};

const TimeContainervue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "TimeContainer",
  props: {
    stat: {},
    runtime: {}
  },
  setup(__props) {
    const props = __props;
    const calendarVisible = (0, external_Vue_namespaceObject.ref)(false);
    const clockInfo = (0, external_Vue_namespaceObject.computed)(() => {
      const clockNow = props.runtime?.clock?.now;
      const festivals = props.stat?.festivals_list;
      if (clockNow && festivals) {
        return {
          ...clockNow,
          festivals
        };
      }
      return null;
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", TimeContainervue_type_script_setup_true_lang_ts_hoisted_1, [ !calendarVisible.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(TimeButtonClosed, {
      key: 0,
      onOpenCalendar: _cache[0] || (_cache[0] = $event => calendarVisible.value = true),
      "clock-info": clockInfo.value
    }, null, 8, [ "clock-info" ])) : ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createBlock)(TimeButtonOpen, {
      key: 1,
      onCloseCalendar: _cache[1] || (_cache[1] = $event => calendarVisible.value = false)
    })), (0, external_Vue_namespaceObject.withDirectives)((0, external_Vue_namespaceObject.createVNode)(CalendarContent, {
      "clock-info": clockInfo.value
    }, null, 8, [ "clock-info" ]), [ [ external_Vue_namespaceObject.vShow, calendarVisible.value ] ]) ]));
  }
});

const TimeContainer_exports_ = (0, exportHelper.A)(TimeContainervue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-517ae222" ] ]);

const TimeContainer = TimeContainer_exports_;

const WeatherButtonClosedvue_type_script_setup_true_lang_ts_hoisted_1 = [ "disabled" ];

const WeatherButtonClosedvue_type_script_setup_true_lang_ts_hoisted_2 = {
  class: "summary"
};

const WeatherButtonClosedvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "WeatherButtonClosed",
  props: {
    summary: {},
    disabled: {
      type: Boolean
    }
  },
  emits: [ "open-weather" ],
  setup(__props) {
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      id: "banner-weather-closed",
      class: (0, external_Vue_namespaceObject.normalizeClass)([ "banner-chip", {
        "banner-chip--disabled": __props.disabled
      } ]),
      disabled: __props.disabled,
      onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit("open-weather"))
    }, [ _cache[1] || (_cache[1] = (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "ğŸŒ¤ï¸", -1)), (0, external_Vue_namespaceObject.createElementVNode)("span", WeatherButtonClosedvue_type_script_setup_true_lang_ts_hoisted_2, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.summary), 1) ], 10, WeatherButtonClosedvue_type_script_setup_true_lang_ts_hoisted_1));
  }
});

const WeatherButtonClosed_exports_ = (0, exportHelper.A)(WeatherButtonClosedvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-1ca16986" ] ]);

const WeatherButtonClosed = WeatherButtonClosed_exports_;

const WeatherButtonOpenvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "open-left"
};

const WeatherButtonOpenvue_type_script_setup_true_lang_ts_hoisted_2 = {
  class: "open-text"
};

const WeatherButtonOpenvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "summary"
};

const WeatherButtonOpenvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "WeatherButtonOpen",
  props: {
    summary: {}
  },
  emits: [ "close-weather" ],
  setup(__props) {
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      id: "banner-weather-open",
      class: "banner-chip-open",
      onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit("close-weather"))
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", WeatherButtonOpenvue_type_script_setup_true_lang_ts_hoisted_1, [ _cache[2] || (_cache[2] = (0, 
    external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "â˜€ï¸", -1)), (0, external_Vue_namespaceObject.createElementVNode)("div", WeatherButtonOpenvue_type_script_setup_true_lang_ts_hoisted_2, [ _cache[1] || (_cache[1] = (0, 
    external_Vue_namespaceObject.createElementVNode)("span", {
      class: "title"
    }, "å¤©æ°”è¯¦æƒ…", -1)), (0, external_Vue_namespaceObject.createElementVNode)("small", WeatherButtonOpenvue_type_script_setup_true_lang_ts_hoisted_3, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.summary), 1) ]) ]), _cache[3] || (_cache[3] = (0, 
    external_Vue_namespaceObject.createElementVNode)("span", {
      class: "close-icon"
    }, "æ”¶èµ·", -1)) ]));
  }
});

const WeatherButtonOpen_exports_ = (0, exportHelper.A)(WeatherButtonOpenvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-08143b0d" ] ]);

const WeatherButtonOpen = WeatherButtonOpen_exports_;

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "weather-content"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_2 = {
  key: 0,
  class: "current-weather"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "current-header"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_4 = {
  class: "header-left"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_5 = {
  class: "label"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_6 = {
  class: "date"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_7 = {
  class: "temperature"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_8 = {
  class: "current-body"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_9 = {
  class: "condition"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_10 = {
  class: "narrative"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_11 = {
  class: "current-stats"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_12 = {
  key: 1,
  class: "forecast-list"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_13 = {
  class: "item-header"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_14 = {
  class: "label"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_15 = {
  class: "date"
};

const WeatherContentvue_type_script_setup_true_lang_ts_hoisted_16 = {
  class: "condition"
};

const _hoisted_17 = {
  class: "temp"
};

const _hoisted_18 = {
  class: "meta"
};

const _hoisted_19 = {
  key: 2,
  class: "generated-at"
};

const WeatherContentvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "WeatherContent",
  props: {
    current: {},
    forecast: {},
    generatedAt: {}
  },
  setup(__props) {
    const props = __props;
    const generatedLabel = (0, external_Vue_namespaceObject.computed)(() => {
      if (!props.generatedAt) {
        return null;
      }
      const date = new Date(props.generatedAt);
      if (Number.isNaN(date.getTime())) {
        return null;
      }
      return date.toLocaleString("zh-CN", {
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        hour12: false
      });
    });
    function formatPercent(value) {
      if (typeof value !== "number" || Number.isNaN(value)) {
        return "â€”";
      }
      return `${Math.round(value * 100)}%`;
    }
    function formatTemperature(day) {
      const {maxC, minC} = day.temperature;
      return `${maxC}Â° / ${minC}Â°`;
    }
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_1, [ __props.current ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("section", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_2, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("header", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_3, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("div", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_4, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("span", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_5, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.current.label), 1), (0, external_Vue_namespaceObject.createElementVNode)("span", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_6, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.current.dateText), 1) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_7, (0, 
    external_Vue_namespaceObject.toDisplayString)(formatTemperature(__props.current)), 1) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_8, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("p", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_9, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.current.condition.label), 1), (0, 
    external_Vue_namespaceObject.createElementVNode)("p", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_10, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.current.narrative), 1) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("ul", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_11, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("li", null, [ _cache[0] || (_cache[0] = (0, 
    external_Vue_namespaceObject.createElementVNode)("span", null, "é™æ°´æ¦‚ç‡", -1)), (0, 
    external_Vue_namespaceObject.createElementVNode)("strong", null, (0, external_Vue_namespaceObject.toDisplayString)(formatPercent(__props.current.precipitationChance)), 1) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("li", null, [ _cache[1] || (_cache[1] = (0, 
    external_Vue_namespaceObject.createElementVNode)("span", null, "æ¹¿åº¦", -1)), (0, external_Vue_namespaceObject.createElementVNode)("strong", null, (0, 
    external_Vue_namespaceObject.toDisplayString)(formatPercent(__props.current.humidity)), 1) ]), (0, 
    external_Vue_namespaceObject.createElementVNode)("li", null, [ _cache[2] || (_cache[2] = (0, 
    external_Vue_namespaceObject.createElementVNode)("span", null, "é£åŠ›", -1)), (0, external_Vue_namespaceObject.createElementVNode)("strong", null, (0, 
    external_Vue_namespaceObject.toDisplayString)(__props.current.windLevel) + "çº§", 1) ]) ]) ])) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true), __props.forecast.length ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("section", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_12, [ ((0, 
    external_Vue_namespaceObject.openBlock)(true), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, (0, 
    external_Vue_namespaceObject.renderList)(__props.forecast, item => ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createElementBlock)("article", {
      key: item.label + item.dateText,
      class: "forecast-item"
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("div", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_13, [ (0, 
    external_Vue_namespaceObject.createElementVNode)("span", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_14, (0, 
    external_Vue_namespaceObject.toDisplayString)(item.label), 1), (0, external_Vue_namespaceObject.createElementVNode)("span", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_15, (0, 
    external_Vue_namespaceObject.toDisplayString)(item.dateText), 1) ]), (0, external_Vue_namespaceObject.createElementVNode)("p", WeatherContentvue_type_script_setup_true_lang_ts_hoisted_16, (0, 
    external_Vue_namespaceObject.toDisplayString)(item.condition.label), 1), (0, external_Vue_namespaceObject.createElementVNode)("p", _hoisted_17, (0, 
    external_Vue_namespaceObject.toDisplayString)(formatTemperature(item)), 1), (0, 
    external_Vue_namespaceObject.createElementVNode)("p", _hoisted_18, " é™æ°´ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(formatPercent(item.precipitationChance)) + " Â· æ¹¿åº¦ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(formatPercent(item.humidity)) + " Â· é£ " + (0, 
    external_Vue_namespaceObject.toDisplayString)(item.windLevel) + "çº§ ", 1) ]))), 128)) ])) : (0, 
    external_Vue_namespaceObject.createCommentVNode)("v-if", true), generatedLabel.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("p", _hoisted_19, "æ›´æ–°äº " + (0, 
    external_Vue_namespaceObject.toDisplayString)(generatedLabel.value), 1)) : (0, external_Vue_namespaceObject.createCommentVNode)("v-if", true) ]));
  }
});

const WeatherContent_exports_ = (0, exportHelper.A)(WeatherContentvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-790cabf0" ] ]);

const WeatherContent = WeatherContent_exports_;

const WeatherContainervue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "weather-container"
};

const WeatherContainervue_type_script_setup_true_lang_ts_hoisted_2 = {
  key: 3,
  class: "weather-empty"
};

const WeatherContainervue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "WeatherContainer",
  props: {
    runtime: {
      type: Object,
      required: true
    }
  },
  setup(__props) {
    const props = __props;
    const weatherVisible = (0, external_Vue_namespaceObject.ref)(false);
    const weatherRuntime = (0, external_Vue_namespaceObject.computed)(() => props.runtime?.weather ?? null);
    const generatedAtISO = (0, external_Vue_namespaceObject.computed)(() => weatherRuntime.value?.generatedAtISO ?? null);
    const anchorDate = (0, external_Vue_namespaceObject.computed)(() => parseAnchorDate(weatherRuntime.value?.anchorDayISO));
    const forecastWithLabels = (0, external_Vue_namespaceObject.computed)(() => decorateForecast(weatherRuntime.value, anchorDate.value));
    const currentWeather = (0, external_Vue_namespaceObject.computed)(() => forecastWithLabels.value[0] ?? null);
    const upcomingForecast = (0, external_Vue_namespaceObject.computed)(() => forecastWithLabels.value.length > 1 ? forecastWithLabels.value.slice(1, 6) : []);
    const hasWeather = (0, external_Vue_namespaceObject.computed)(() => Boolean(currentWeather.value));
    const currentSummary = (0, external_Vue_namespaceObject.computed)(() => currentWeather.value?.condition.label ?? "å¤©æ°”æœªåˆ·æ–°");
    const handleOpen = () => {
      if (!hasWeather.value) {
        return;
      }
      weatherVisible.value = true;
    };
    const handleClose = () => {
      weatherVisible.value = false;
    };
    (0, external_Vue_namespaceObject.watch)(hasWeather, ready => {
      if (!ready) {
        weatherVisible.value = false;
      }
    });
    function parseAnchorDate(anchorISO) {
      if (!anchorISO) {
        return null;
      }
      const date = new Date(`${anchorISO}T00:00:00Z`);
      return Number.isNaN(date.getTime()) ? null : date;
    }
    function decorateForecast(runtime, baseDate) {
      const days = runtime?.days ?? [];
      return days.map((day, index) => {
        const date = baseDate ? new Date(baseDate.getTime() + index * 864e5) : null;
        return {
          ...day,
          label: labelForIndex(index, date),
          dateText: formatDateLabel(date, index)
        };
      });
    }
    function labelForIndex(index, date) {
      if (index === 0) return "ä»Šå¤©";
      if (index === 1) return "æ˜å¤©";
      if (index === 2) return "åå¤©";
      return date ? date.toLocaleDateString("zh-CN", {
        weekday: "short"
      }) : `+${index}å¤©`;
    }
    function formatDateLabel(date, index) {
      if (!date) {
        return `+${index}å¤©`;
      }
      return `${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥`;
    }
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", WeatherContainervue_type_script_setup_true_lang_ts_hoisted_1, [ !weatherVisible.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(WeatherButtonClosed, {
      key: 0,
      summary: currentSummary.value,
      disabled: !hasWeather.value,
      onOpenWeather: handleOpen
    }, null, 8, [ "summary", "disabled" ])) : ((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createBlock)(WeatherButtonOpen, {
      key: 1,
      summary: currentSummary.value,
      onCloseWeather: handleClose
    }, null, 8, [ "summary" ])), hasWeather.value ? (0, external_Vue_namespaceObject.withDirectives)(((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(WeatherContent, {
      key: 2,
      current: currentWeather.value,
      forecast: upcomingForecast.value,
      "generated-at": generatedAtISO.value
    }, null, 8, [ "current", "forecast", "generated-at" ])), [ [ external_Vue_namespaceObject.vShow, weatherVisible.value ] ]) : (0, 
    external_Vue_namespaceObject.withDirectives)(((0, external_Vue_namespaceObject.openBlock)(), 
    (0, external_Vue_namespaceObject.createElementBlock)("div", WeatherContainervue_type_script_setup_true_lang_ts_hoisted_2, "æš‚æœªç”Ÿæˆå¤©æ°”æ•°æ®ï¼Œè¯·ç­‰å¾…ä¸‹ä¸€æ¬¡æ—¶é—´æ¨è¿›ã€‚", 512)), [ [ external_Vue_namespaceObject.vShow, weatherVisible.value ] ]) ]));
  }
});

const WeatherContainer_exports_ = (0, exportHelper.A)(WeatherContainervue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-28493e2c" ] ]);

const WeatherContainer = WeatherContainer_exports_;

const StatusBannerContentvue_type_script_setup_true_lang_ts_hoisted_1 = {
  id: "status-banner",
  class: "status-banner"
};

const StatusBannerContentvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "StatusBannerContent",
  setup(__props, {expose: __expose}) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/StatusBanner/StatusBannerContent");
    const statData = (0, external_Vue_namespaceObject.ref)(null);
    const runtimeData = (0, external_Vue_namespaceObject.ref)(null);
    const update = ({statWithoutMeta, runtime}) => {
      const funcName = "update";
      logger.log(funcName, "çŠ¶æ€æ¨ªå¹…å†…å®¹åŒºå¼€å§‹æ›´æ–°ï¼Œæ¥æ”¶åˆ°çš„æ•°æ®ï¼š", {
        statWithoutMeta,
        runtime
      });
      if (!statWithoutMeta || typeof statWithoutMeta !== "object") {
        logger.warn(funcName, "è°ƒç”¨å¤±è´¥ï¼šä¼ å…¥çš„ statWithoutMeta æ— æ•ˆã€‚", {
          statWithoutMeta,
          runtime
        });
        return;
      }
      statData.value = statWithoutMeta;
      runtimeData.value = runtime;
    };
    __expose({
      update
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, [ (0, 
    external_Vue_namespaceObject.createCommentVNode)(" ===== çŠ¶æ€æ¨ªå¹…ï¼šæ—¶é—´ï¼ˆå¯ç‚¹å¼¹æ—¥å†ï¼‰ | å¤©æ°”ï¼ˆé¢„ç•™ç‚¹å‡»ï¼‰ ===== "), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", StatusBannerContentvue_type_script_setup_true_lang_ts_hoisted_1, [ _cache[0] || (_cache[0] = (0, 
    external_Vue_namespaceObject.createElementVNode)("div", {
      class: "banner-title"
    }, [ (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "emoji"
    }, "ğŸ“¡"), (0, external_Vue_namespaceObject.createElementVNode)("span", null, "ä¸–ç•ŒçŠ¶æ€") ], -1)), (0, 
    external_Vue_namespaceObject.createCommentVNode)(" æ—¥æœŸå’Œæ—¥å†ç»„ä»¶ "), (0, external_Vue_namespaceObject.createVNode)(TimeContainer, {
      ref: "timeContainer",
      stat: statData.value,
      runtime: runtimeData.value
    }, null, 8, [ "stat", "runtime" ]), _cache[1] || (_cache[1] = (0, external_Vue_namespaceObject.createElementVNode)("span", {
      class: "banner-sep",
      "aria-hidden": "true"
    }, null, -1)), (0, external_Vue_namespaceObject.createCommentVNode)(" å¤©æ°”ç»„ä»¶ "), (0, 
    external_Vue_namespaceObject.createVNode)(WeatherContainer, {
      runtime: runtimeData.value
    }, null, 8, [ "runtime" ]) ]) ], 2112));
  }
});

const StatusBannerContent_exports_ = (0, exportHelper.A)(StatusBannerContentvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-6184098d" ] ]);

const StatusBannerContent = StatusBannerContent_exports_;

const ThemeTogglevue_type_script_setup_true_lang_ts_hoisted_1 = [ "aria-label", "title", "aria-pressed" ];

const LIGHT = "light";

const DARK = "dark";

const ThemeTogglevue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "ThemeToggle",
  setup(__props, {expose: __expose}) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/ThemeToggle");
    const currentTheme = (0, external_Vue_namespaceObject.ref)(LIGHT);
    const icon = (0, external_Vue_namespaceObject.computed)(() => currentTheme.value === LIGHT ? "ğŸŒ™" : "ğŸŒ");
    const ariaLabel = (0, external_Vue_namespaceObject.computed)(() => currentTheme.value === LIGHT ? "åˆ‡æ¢ä¸ºé»‘å¤œæ¨¡å¼" : "åˆ‡æ¢ä¸ºç™½æ—¥æ¨¡å¼");
    const title = (0, external_Vue_namespaceObject.computed)(() => currentTheme.value === LIGHT ? "åˆ‡æ¢ä¸ºé»‘å¤œæ¨¡å¼" : "åˆ‡æ¢ä¸ºç™½æ—¥æ¨¡å¼");
    const isDark = (0, external_Vue_namespaceObject.computed)(() => currentTheme.value === DARK);
    const applyThemeToDOM = theme => {
      const root = document.documentElement;
      if (root) {
        root.setAttribute("data-theme", theme);
        logger.log("applyThemeToDOM", `å·²å°†ä¸»é¢˜åº”ç”¨åˆ° DOM: ${theme}`);
      } else {
        logger.warn("applyThemeToDOM", "æœªæ‰¾åˆ° document.documentElement å…ƒç´ ã€‚");
      }
    };
    const updateTheme = context => {
      const funcName = "updateTheme";
      const {statWithoutMeta} = context || {};
      if (!statWithoutMeta || typeof statWithoutMeta !== "object") {
        logger.warn(funcName, "è°ƒç”¨å¤±è´¥ï¼šä¼ å…¥çš„ context æˆ– statWithoutMeta æ— æ•ˆã€‚", context);
        return;
      }
      const newTheme = statWithoutMeta.config?.ui?.theme;
      const validatedTheme = newTheme === DARK ? DARK : LIGHT;
      currentTheme.value = validatedTheme;
      applyThemeToDOM(validatedTheme);
      logger.log(funcName, `ä» statWithoutMeta æ›´æ–°ä¸»é¢˜ä¸º: ${validatedTheme}`);
    };
    (0, external_Vue_namespaceObject.onMounted)(() => {
      const funcName = "onMounted";
      const btn = document.getElementById("theme-toggle");
      if (btn) {
        btn.onclick = () => {
          const nextTheme = currentTheme.value === DARK ? LIGHT : DARK;
          logger.log(`${funcName}:onclick`, `æŒ‰é’®è¢«ç‚¹å‡»ï¼Œå‡†å¤‡åˆ‡æ¢åˆ°ä¸»é¢˜: ${nextTheme}`);
          currentTheme.value = nextTheme;
          applyThemeToDOM(nextTheme);
          const updateObject = {
            config: {
              ui: {
                theme: nextTheme
              }
            }
          };
          updateEraVariableByObject(updateObject);
          logger.log(`${funcName}:onclick`, `å·²é€šè¿‡ eraWriter è¯·æ±‚æ›´æ–°ä¸»é¢˜å˜é‡ä¸º:`, updateObject);
        };
        logger.log(funcName, "ä¸»é¢˜åˆ‡æ¢æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å·²æˆåŠŸç»‘å®šã€‚");
      } else {
        logger.warn(funcName, "æœªæ‰¾åˆ° #theme-toggle æŒ‰é’®å…ƒç´ ï¼Œäº‹ä»¶ç»‘å®šå¤±è´¥ã€‚");
      }
    });
    __expose({
      updateTheme
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)(external_Vue_namespaceObject.Fragment, null, [ (0, 
    external_Vue_namespaceObject.createCommentVNode)(" ä¸»é¢˜åˆ‡æ¢æŒ‰é’® "), (0, external_Vue_namespaceObject.createElementVNode)("button", {
      id: "theme-toggle",
      class: "theme-toggle",
      "aria-label": ariaLabel.value,
      title: title.value,
      "aria-pressed": isDark.value
    }, (0, external_Vue_namespaceObject.toDisplayString)(icon.value), 9, ThemeTogglevue_type_script_setup_true_lang_ts_hoisted_1) ], 2112));
  }
});

const ThemeToggle_exports_ = (0, exportHelper.A)(ThemeTogglevue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-676236f6" ] ]);

const ThemeToggle = ThemeToggle_exports_;

const UserStateButtonClosedvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "UserStateButtonClosed",
  emits: [ "open-sidebar" ],
  setup(__props, {emit: __emit}) {
    const emit = __emit;
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      class: "user-state-button-closed",
      onClick: _cache[0] || (_cache[0] = $event => emit("open-sidebar"))
    }, "ç”¨æˆ·ä¿¡æ¯"));
  }
});

const UserStateButtonClosed_exports_ = (0, exportHelper.A)(UserStateButtonClosedvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-89abe3c0" ] ]);

const UserStateButtonClosed = UserStateButtonClosed_exports_;

const UserStateButtonOpenvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "UserStateButtonOpen",
  emits: [ "close-sidebar" ],
  setup(__props, {emit: __emit}) {
    const emit = __emit;
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("button", {
      class: "user-state-button-open",
      onClick: _cache[0] || (_cache[0] = $event => emit("close-sidebar"))
    }, "ç”¨æˆ·ä¿¡æ¯"));
  }
});

const UserStateButtonOpen_exports_ = (0, exportHelper.A)(UserStateButtonOpenvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-682280a6" ] ]);

const UserStateButtonOpen = UserStateButtonOpen_exports_;

const UserStatePopupvue_type_script_setup_true_lang_ts_hoisted_1 = {
  id: "user-state-popup",
  class: "user-state-popup",
  role: "region",
  "aria-label": "ç”¨æˆ·çŠ¶æ€"
};

const UserStatePopupvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "UserStatePopup",
  emits: [ "close" ],
  setup(__props, {expose: __expose}) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/UserState/UserStatePopup");
    const style = (0, external_Vue_namespaceObject.ref)({});
    const positionPopup = _anchorEl => {
      style.value = {};
    };
    const updateUserStatus = (stat, anchorEl) => {
      if (anchorEl) {
        positionPopup(anchorEl);
      }
      const funcName = "updateUserStatus";
      logger.debug(funcName, "å‡½æ•°å…¥å£ï¼Œæ¥æ”¶åˆ°çš„ stat:", stat);
      if (!stat || typeof stat !== "object" || !stat.user) {
        logger.warn(funcName, "è°ƒç”¨å¤±è´¥ï¼šä¼ å…¥çš„ stat æ— æ•ˆæˆ–ç¼ºå°‘ user å±æ€§ã€‚", stat);
        return;
      }
      const {user} = stat;
      const map = [ [ "user-name-popup", user.å§“å ], [ "user-identity-popup", user.èº«ä»½ ], [ "user-gender-popup", user.æ€§åˆ« ], [ "user-age-popup", user.å¹´é¾„ ], [ "user-abilities-popup", user.ç‰¹æ®Šèƒ½åŠ› ], [ "user-location-popup", user.æ‰€åœ¨åœ°åŒº ], [ "user-home-popup", user.å±…ä½åœ°åŒº ] ];
      map.forEach(([id, value]) => {
        const displayValue = value ?? "â€”";
        logger.debug(funcName, `[å†™å…¥DOM] å‡†å¤‡å‘ #${id} å†™å…¥å†…å®¹:`, displayValue);
        format_text(id, displayValue);
      });
      logger.debug(funcName, "æ‰€æœ‰å­—æ®µæ›´æ–°å®Œæˆã€‚");
    };
    __expose({
      updateUserStatus,
      positionPopup
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", UserStatePopupvue_type_script_setup_true_lang_ts_hoisted_1, [ ..._cache[0] || (_cache[0] = [ (0, 
    external_Vue_namespaceObject.createStaticVNode)('<h4 data-v-9ec113e0><span class="emoji" data-v-9ec113e0>ğŸ‘¤</span>ç”¨æˆ·çŠ¶æ€</h4><div class="sidebar-content" data-v-9ec113e0><p data-v-9ec113e0><span class="label" data-v-9ec113e0><span class="emoji" data-v-9ec113e0>ğŸ“</span>å§“å:</span> <span id="user-name-popup" data-v-9ec113e0>â€”</span></p><p data-v-9ec113e0><span class="label" data-v-9ec113e0><span class="emoji" data-v-9ec113e0>ğŸªª</span>èº«ä»½:</span> <span id="user-identity-popup" data-v-9ec113e0>â€”</span></p><p data-v-9ec113e0><span class="label" data-v-9ec113e0><span class="emoji" data-v-9ec113e0>âš§ï¸</span>æ€§åˆ«:</span> <span id="user-gender-popup" data-v-9ec113e0>â€”</span></p><p data-v-9ec113e0><span class="label" data-v-9ec113e0><span class="emoji" data-v-9ec113e0>ğŸ‚</span>å¹´é¾„:</span> <span id="user-age-popup" data-v-9ec113e0>â€”</span></p><p data-v-9ec113e0><span class="label" data-v-9ec113e0><span class="emoji" data-v-9ec113e0>âœ¨</span>ç‰¹æ®Šèƒ½åŠ›:</span> <span id="user-abilities-popup" data-v-9ec113e0>â€”</span></p><p data-v-9ec113e0><span class="label" data-v-9ec113e0><span class="emoji" data-v-9ec113e0>ğŸ“</span>æ‰€åœ¨åœ°åŒº:</span> <span id="user-location-popup" data-v-9ec113e0>â€”</span></p><p data-v-9ec113e0><span class="label" data-v-9ec113e0><span class="emoji" data-v-9ec113e0>ğŸ </span>å±…ä½åœ°åŒº:</span> <span id="user-home-popup" data-v-9ec113e0>â€”</span></p></div>', 2) ]) ]));
  }
});

const UserStatePopup_exports_ = (0, exportHelper.A)(UserStatePopupvue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-9ec113e0" ] ]);

const UserStatePopup = UserStatePopup_exports_;

const UserStateContainervue_type_script_setup_true_lang_ts_hoisted_1 = {
  class: "user-state-container"
};

const UserStateContainervue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  __name: "UserStateContainer",
  setup(__props, {expose: __expose}) {
    const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢/components/UserState/UserStateContainer");
    const sidebarVisible = (0, external_Vue_namespaceObject.ref)(false);
    const userStatePopup = (0, external_Vue_namespaceObject.ref)(null);
    __expose({
      updateUserStatus: stat => {
        logger.debug("updateUserStatus", "æ›´æ–°ç”¨æˆ·çŠ¶æ€æ•°æ®", stat);
        userStatePopup.value?.updateUserStatus(stat);
      }
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", UserStateContainervue_type_script_setup_true_lang_ts_hoisted_1, [ !sidebarVisible.value ? ((0, 
    external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(UserStateButtonClosed, {
      key: 0,
      onOpenSidebar: _cache[0] || (_cache[0] = $event => sidebarVisible.value = true)
    })) : ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createBlock)(UserStateButtonOpen, {
      key: 1,
      onCloseSidebar: _cache[1] || (_cache[1] = $event => sidebarVisible.value = false)
    })), (0, external_Vue_namespaceObject.withDirectives)((0, external_Vue_namespaceObject.createVNode)(UserStatePopup, {
      ref_key: "userStatePopup",
      ref: userStatePopup
    }, null, 512), [ [ external_Vue_namespaceObject.vShow, sidebarVisible.value ] ]) ]));
  }
});

const UserStateContainer_exports_ = (0, exportHelper.A)(UserStateContainervue_type_script_setup_true_lang_ts, [ [ "__scopeId", "data-v-0a721dc0" ] ]);

const UserStateContainer = UserStateContainer_exports_;

const appvue_type_script_setup_true_lang_ts_hoisted_1 = {
  id: "status-container",
  class: "status-ui-container"
};

const appvue_type_script_setup_true_lang_ts_hoisted_2 = {
  id: "status-duo",
  class: "status-duo"
};

const appvue_type_script_setup_true_lang_ts_hoisted_3 = {
  class: "status-main-content"
};

const __default__ = (0, external_Vue_namespaceObject.defineComponent)({
  name: "App"
});

const appvue_type_script_setup_true_lang_ts = (0, external_Vue_namespaceObject.defineComponent)({
  ...__default__,
  setup(__props, {expose: __expose}) {
    const themeToggle = (0, external_Vue_namespaceObject.ref)(null);
    const userState = (0, external_Vue_namespaceObject.ref)(null);
    const ayaNews = (0, external_Vue_namespaceObject.ref)(null);
    const statusBanner = (0, external_Vue_namespaceObject.ref)(null);
    const statusTabContent = (0, external_Vue_namespaceObject.ref)(null);
    const roleRibbon = (0, external_Vue_namespaceObject.ref)(null);
    __expose({
      themeToggle,
      userState,
      ayaNews,
      statusBanner,
      statusTabContent,
      roleRibbon
    });
    return (_ctx, _cache) => ((0, external_Vue_namespaceObject.openBlock)(), (0, external_Vue_namespaceObject.createElementBlock)("div", appvue_type_script_setup_true_lang_ts_hoisted_1, [ (0, 
    external_Vue_namespaceObject.createCommentVNode)(" â–¼ æ–°å¢ï¼šå³ä¸Šè§’ä¸»é¢˜åˆ‡æ¢æŒ‰é’® "), (0, external_Vue_namespaceObject.createVNode)(ThemeToggle, {
      ref_key: "themeToggle",
      ref: themeToggle
    }, null, 512), (0, external_Vue_namespaceObject.createCommentVNode)(" â–² æ–°å¢ "), (0, 
    external_Vue_namespaceObject.createElementVNode)("div", appvue_type_script_setup_true_lang_ts_hoisted_2, [ (0, 
    external_Vue_namespaceObject.createVNode)(UserStateContainer, {
      ref_key: "userState",
      ref: userState
    }, null, 512), (0, external_Vue_namespaceObject.createVNode)(AyaNewsContainer, {
      ref_key: "ayaNews",
      ref: ayaNews
    }, null, 512) ]), (0, external_Vue_namespaceObject.createElementVNode)("div", appvue_type_script_setup_true_lang_ts_hoisted_3, [ (0, 
    external_Vue_namespaceObject.createVNode)(RoleRibbonContainer, {
      ref_key: "roleRibbon",
      ref: roleRibbon
    }, null, 512), (0, external_Vue_namespaceObject.createVNode)(StatusBannerContent, {
      ref_key: "statusBanner",
      ref: statusBanner
    }, null, 512), (0, external_Vue_namespaceObject.createCommentVNode)(" â–¼ [é‡æ„] é€‰é¡¹å¡åŒºåŸŸå·²è¢«å°è£…åˆ° StatusTabContent ç»„ä»¶ä¸­ "), (0, 
    external_Vue_namespaceObject.createVNode)(StatusTabContent, {
      ref_key: "statusTabContent",
      ref: statusTabContent
    }, null, 512), (0, external_Vue_namespaceObject.createCommentVNode)(" â–² [é‡æ„] ") ]) ]));
  }
});

const app_exports_ = appvue_type_script_setup_true_lang_ts;

const _app = app_exports_;

$(() => {
  const app = (0, external_Vue_namespaceObject.createApp)(_app);
  const appInstance = app.mount("#app");
  window.vueApp = appInstance;
  const logger = new Logger("å¹»æƒ³ä¹¡ç¼˜èµ·-ä¸»é¡µé¢");
  eventOn("GSKO:showUI", detail => {
    const funcName = "onShowUI";
    try {
      logContext.mk = String(detail?.mk || "");
    } catch {
      logContext.mk = "";
    }
    logger.log(funcName, "æ”¶åˆ° GSKO:showUI äº‹ä»¶", detail);
    if (detail?.actions?.apiWrite === true) {
      logger.log(funcName, "æ£€æµ‹åˆ° apiWrite æ ‡è®°äº‹ä»¶ï¼Œè·³è¿‡åˆ·æ–°é€»è¾‘");
      return;
    }
    logger.debug(funcName, "GSKO:showUI äº‹ä»¶è¯¦ç»†å†…å®¹", detail);
    try {
      const {statWithoutMeta, runtime} = detail || {};
      if (!statWithoutMeta) {
        logger.warn(funcName, "äº‹ä»¶ä¸­æœªæ‰¾åˆ° statWithoutMetaï¼Œæ— æ³•åˆ·æ–° UIã€‚");
        return;
      }
      if (!runtime) {
        logger.warn(funcName, "äº‹ä»¶ä¸­æœªæ‰¾åˆ° runtime æ•°æ®ï¼Œç•Œé¢æ¸²æŸ“å¯èƒ½ä¸å®Œæ•´ã€‚");
      }
      const parsedStat = StatSchema.parse(statWithoutMeta);
      const parsedRuntime = RuntimeSchema.parse(runtime);
      const messageId = typeof detail?.message_id === "number" ? detail.message_id : null;
      const context = {
        statWithoutMeta: parsedStat,
        runtime: parsedRuntime,
        messageId
      };
      logger.debug(funcName, "ä¼ ç»™å„å­æ¨¡å—çš„ä¸Šä¸‹æ–‡å¯¹è±¡:", context);
      const {themeToggle, userState, statusBanner, ayaNews, statusTabContent, roleRibbon} = appInstance;
      try {
        if (themeToggle && typeof themeToggle.updateTheme === "function") {
          logger.debug(funcName, "è°ƒç”¨ ThemeToggle.updateTheme");
          themeToggle.updateTheme(context);
          logger.debug(funcName, "ThemeToggle.updateTheme æ‰§è¡Œå®Œæ¯•");
        } else {
          logger.warn(funcName, "ThemeToggle ç»„ä»¶ç¼ºå°‘ updateTheme æ–¹æ³•ã€‚");
        }
      } catch (e) {
        logger.warn(funcName, "ThemeToggle.updateTheme æ‰§è¡Œå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹", e);
      }
      try {
        if (userState && typeof userState.updateUserStatus === "function") {
          logger.debug(funcName, "è°ƒç”¨ UserState.updateUserStatus");
          userState.updateUserStatus(parsedStat);
          logger.debug(funcName, "UserState.updateUserStatus æ‰§è¡Œå®Œæ¯•");
        } else {
          logger.warn(funcName, "UserState ç»„ä»¶ç¼ºå°‘ updateUserStatus æ–¹æ³•ã€‚");
        }
      } catch (e) {
        logger.warn(funcName, "UserState.updateUserStatus æ‰§è¡Œå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹", e);
      }
      try {
        if (statusBanner && typeof statusBanner.update === "function") {
          logger.debug(funcName, "è°ƒç”¨ StatusBanner.update");
          statusBanner.update(context);
          logger.debug(funcName, "StatusBanner.update æ‰§è¡Œå®Œæ¯•");
        } else {
          logger.warn(funcName, "StatusBanner ç»„ä»¶ç¼ºå°‘ update æ–¹æ³•ã€‚");
        }
      } catch (e) {
        logger.warn(funcName, "StatusBanner.update æ‰§è¡Œå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹", e);
      }
      try {
        if (ayaNews && typeof ayaNews.updateNews === "function") {
          logger.debug(funcName, "è°ƒç”¨ AyaNews.updateNews");
          ayaNews.updateNews(parsedStat);
          logger.debug(funcName, "AyaNews.updateNews æ‰§è¡Œå®Œæ¯•");
        } else {
          logger.warn(funcName, "AyaNews ç»„ä»¶ç¼ºå°‘ updateNews æ–¹æ³•ã€‚");
        }
      } catch (e) {
        logger.warn(funcName, "AyaNews.updateNews æ‰§è¡Œå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹", e);
      }
      try {
        if (statusTabContent && typeof statusTabContent.update === "function") {
          logger.log(funcName, "è°ƒç”¨ StatusTabContent.update...");
          statusTabContent.update(context);
          logger.debug(funcName, "StatusTabContent.update æ‰§è¡Œå®Œæ¯•");
        } else {
          logger.warn(funcName, "StatusTabContent ç»„ä»¶ç¼ºå°‘ update æ–¹æ³•ã€‚");
        }
      } catch (e) {
        logger.warn(funcName, "StatusTabContent.update æ‰§è¡Œå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹", e);
      }
      try {
        if (roleRibbon && typeof roleRibbon.updateRibbon === "function") {
          logger.log(funcName, "è°ƒç”¨ RoleRibbon.updateRibbon...");
          roleRibbon.updateRibbon(context);
          logger.debug(funcName, "RoleRibbon.updateRibbon æ‰§è¡Œå®Œæ¯•");
        } else {
          logger.warn(funcName, "RoleRibbon ç»„ä»¶ç¼ºå°‘ updateRibbon æ–¹æ³•ã€‚");
        }
      } catch (e) {
        logger.warn(funcName, "RoleRibbon.updateRibbon æ‰§è¡Œå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹", e);
      }
    } catch (e) {
      logger.error(funcName, "GSKO:showUI å¤„ç†æµç¨‹å‡ºç°æœªæ•è·å¼‚å¸¸", e);
    } finally {
      logContext.mk = "";
    }
  });
  if (typeof eventEmit === "function") {
    Promise.resolve(eventEmit("GSKO:requireData")).then(() => {
      logger.log("requestDataOnInit", "å·²åœ¨åˆå§‹åŒ–æ—¶è¯·æ±‚æœ€æ–°æ•°æ®ã€‚");
    }).catch(error => {
      logger.error("requestDataOnInit", "åˆå§‹åŒ–è¯·æ±‚æ•°æ®æ—¶å‘ç”Ÿå¼‚å¸¸ã€‚", error);
    });
  } else {
    logger.warn("requestDataOnInit", "eventEmit æœªå®šä¹‰ï¼Œæ— æ³•åœ¨åˆå§‹åŒ–æ—¶è¯·æ±‚æ•°æ®ã€‚");
  }
});</script><style>@import url(https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap);
.map-component{background:hsla(0,0%,100%,.9);box-shadow:0 10px 30px rgba(0,0,0,.3);overflow:hidden;margin-bottom:20px}.map-component .map-wrapper{position:relative;width:100%;height:100%;background:#f0f0f0}.map-component .map-container{white-space:nowrap;position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;cursor:grab}.map-component #mapCanvas{display:block;background:#7f8c8d}.map-component .marker{position:absolute;transform:translate(-50%,-50%);cursor:pointer;font-size:12px;background-color:var(--bg);border-radius:4px;padding:4px}.map-component .container{position:absolute;transform:translate(-50%,-100%)}.map-component .map-info{position:absolute;top:20px;left:20px;background:hsla(0,0%,100%,.8);padding:8px 12px;border-radius:6px;font-size:.9rem;z-index:40}@keyframes bounce{0%,20%,50%,80%,100%{transform:translate(-50%,-100%)}40%{transform:translate(-50%,calc(-100% - 30px))}60%{transform:translate(-50%,calc(-100% - 15px))}}.map-component .pulsate{animation:bounce 2s infinite}.map-component .tip-container{position:absolute;transform-origin:bottom center;z-index:20}.map-component .dialog{border-radius:8px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.15);color:var(--ink);background-color:var(--bg);position:relative;border:1px solid var(--bg)}.map-component .dialog .location-name{font-size:16px;font-weight:bold;border-bottom:1px solid var(--ink);padding-bottom:6px;margin-bottom:6px}.map-component .dialog::after{content:"";position:absolute;top:100%;left:50%;transform:translateX(-50%);border:12px solid rgba(0,0,0,0);border-top-color:var(--bg);filter:drop-shadow(0 2px 2px rgba(0,0,0,0.1))}.map-component .player-marker{background-color:rgba(0,0,0,0);transform-origin:bottom center;font-size:24px;z-index:10}
h4[data-v-3e602d5b]{display:flex;align-items:center;font-size:1.1em;color:var(--muted);margin:0 0 10px}h4 .emoji[data-v-3e602d5b]{margin-right:8px;font-size:1.1em}.preserve-format[data-v-3e602d5b]{white-space:pre-wrap;overflow-wrap:anywhere;word-break:break-word;line-height:1.6;font-size:.95em}hr.dashed[data-v-3e602d5b]{border:none;border-top:1px dashed var(--line);margin:20px 0}
[data-v-5c4294ac] [data-path]{background:rgba(255,247,232,.06);border:1px dashed var(--line);border-radius:8px;padding:10px 12px;margin:10px 0}[data-v-5c4294ac] input[type="text"],[data-v-5c4294ac] input[type="number"],[data-v-5c4294ac] textarea,[data-v-5c4294ac] select{width:100%;background:var(--control-bg);border:1px solid var(--control-border);border-radius:6px;padding:9px 11px;font-size:14px;color:var(--ink);box-shadow:0 1px 0 rgba(0,0,0,.03) inset}[data-v-5c4294ac] input:focus,[data-v-5c4294ac] textarea:focus,[data-v-5c4294ac] select:focus{outline:none;border-color:var(--control-focus);box-shadow:0 0 0 3px color-mix(in srgb,var(--control-focus) 28%,transparent)}[data-v-5c4294ac] input[type="checkbox"]{accent-color:var(--control-focus)}[data-v-5c4294ac] button{cursor:pointer;border:1px solid rgba(0,0,0,0);border-radius:6px;padding:10px 14px;font-weight:700;background:var(--btn-accent);color:#fff;transition:background .2s,box-shadow .2s,border-color .2s,transform .02s}[data-v-5c4294ac] button:hover{background:var(--btn-accent-hover)}[data-v-5c4294ac] button:active{transform:translateY(1px)}[data-v-5c4294ac] .muted-btn{background:var(--btn-muted);color:var(--muted);border-color:var(--btn-muted-border)}[data-v-5c4294ac] .muted-btn:hover{filter:brightness(0.97)}[data-v-5c4294ac] details{border:1px solid var(--line);border-radius:8px;background:var(--paper);margin:10px 0;padding:8px 10px 10px}[data-v-5c4294ac] summary{font-weight:700;color:var(--muted);background:color-mix(in srgb,var(--paper) 88%,black 0%);border-radius:6px;padding:6px 8px;cursor:pointer;-webkit-user-select:none;user-select:none}[data-v-5c4294ac] details[open]>summary{background:color-mix(in srgb,var(--paper) 78%,black 0%)}[data-v-5c4294ac] #cfg_status{display:inline-flex;align-items:center;gap:6px;padding:2px 10px;border:1px solid color-mix(in srgb,var(--control-focus) 35%,white 65%);background:color-mix(in srgb,var(--control-focus) 10%,white 90%);color:color-mix(in srgb,var(--control-focus) 70%,black 30%);border-radius:999px;font-weight:700;line-height:1.8}
#content_incidents h4[data-v-6bff0ba1]{display:flex;align-items:center;margin:0 0 15px;padding-bottom:10px;line-height:1;font-size:1.1em;color:var(--muted);border-bottom:1px solid var(--line)}#content_incidents .emoji[data-v-6bff0ba1]{font-size:1em;line-height:1;margin-right:8px}#incident-toolbar[data-v-6bff0ba1]{margin-bottom:15px}.debug-select[data-v-6bff0ba1],.debug-switch[data-v-6bff0ba1]{display:flex;align-items:center;gap:6px;font-size:.9em;padding:4px 8px;border:1px dashed var(--line);border-radius:6px;background:color-mix(in srgb,var(--paper) 50%,var(--bg) 50%)}:root[data-theme="dark"],:root[data-theme="dark"]{background:hsla(0,0%,100%,.05)}.incident-list[data-v-6bff0ba1]{display:flex;flex-direction:column;gap:12px}.incident-list[data-v-6bff0ba1] .role-card{background:var(--bg);border:1px solid var(--line);border-radius:6px;padding:var(--pad);overflow:hidden}.incident-list[data-v-6bff0ba1] .role-card .role-card-header{display:flex;align-items:center;gap:10px;margin-bottom:8px;padding-bottom:8px;border-bottom:1px dashed var(--line)}.incident-list[data-v-6bff0ba1] .role-card .role-avatar{width:40px;height:40px;border-radius:50%;border:1px solid var(--line);background:var(--avatar-bg);display:grid;place-items:center;font-weight:700;color:var(--muted)}.incident-list[data-v-6bff0ba1] .role-card .role-name{font-weight:700}.incident-list[data-v-6bff0ba1] .role-card .role-meta{font-size:.85em;color:var(--muted)}.incident-list[data-v-6bff0ba1] .role-card .role-line{margin:6px 0;font-size:.9em}
.font-size-controls[data-v-b1dba0d6]{display:flex;justify-content:flex-end;gap:6px;margin-bottom:10px}.font-size-btn[data-v-b1dba0d6]{width:28px;height:28px;border:1px solid var(--line);background:var(--paper);border-radius:4px;cursor:pointer;font-weight:700}
.status-tabs[data-v-153af6e4]{display:flex;gap:8px;border-bottom:1px solid var(--line);background:var(--paper);padding:0 15px;overflow:auto hidden;-webkit-overflow-scrolling:touch;scroll-snap-type:x proximity}.status-tabs button[data-v-153af6e4]{padding:12px 16px;cursor:pointer;font-size:.95em;color:var(--muted);border:none;background:none;border-bottom:3px solid rgba(0,0,0,0);margin-bottom:-1px;flex:0 0 auto;scroll-snap-align:start}.status-tabs button.active[data-v-153af6e4]{color:var(--ink);border-bottom-color:var(--tab-active);font-weight:700}.status-tab-content-area[data-v-153af6e4]{flex:1;overflow:auto;padding:20px}.status-tab-content[data-v-153af6e4]{display:none;line-height:1.6;font-size:.95em}.status-tab-content.active[data-v-153af6e4]{display:block}:root[data-theme="dark"]{color:var(--muted)}:root[data-theme="dark"]{color:var(--ink)}@media (max-width:768px){.status-tab-content-area[data-v-153af6e4]{padding:15px}}[data-v-153af6e4] .font-size-controls{display:flex;justify-content:flex-end;gap:6px;margin-bottom:10px}[data-v-153af6e4] .font-size-btn{width:28px;height:28px;border:1px solid var(--line);background:var(--paper);border-radius:4px;cursor:pointer;font-weight:700}[data-v-153af6e4] .incident-list{display:flex;flex-direction:column;gap:12px}
.aya-news-button-closed[data-v-b15bd7b0]{padding:8px 12px;border:1px solid var(--line);border-radius:4px;background-color:var(--bg);color:var(--ink);cursor:pointer;width:100%}.aya-news-button-closed[data-v-b15bd7b0]:hover{background-color:var(--paper)}
.aya-news-button-open[data-v-4b56fc8f]{padding:12px 14px;border:1px solid var(--line);border-bottom-left-radius:0;border-bottom-right-radius:0;background-color:var(--bg);color:var(--ink);cursor:pointer;width:100%;box-shadow:0 2px 0 var(--line) inset;transition:padding .15s ease}.aya-news-button-open[data-v-4b56fc8f]:hover{background-color:var(--paper)}
.aya-news-popup[data-v-08972433]{width:100%;max-height:60vh;overflow:auto;padding:16px 20px;background:var(--paper);border:1px solid var(--line);border-top:none;border-bottom-left-radius:10px;border-bottom-right-radius:10px;box-shadow:0 8px 16px rgba(0,0,0,.05);display:flex;flex-direction:column;gap:10px}#aya-news-popup h4[data-v-08972433]{display:flex;align-items:center;height:var(--duo-head-h);margin:0 0 10px;padding:0;line-height:1;font-size:1.1em;color:var(--muted);border-bottom:1px solid var(--line)}#aya-news-popup h4 .emoji[data-v-08972433]{font-size:1em;line-height:1;display:inline-grid;place-items:center;width:1.25em;height:1.25em;margin-right:8px}.news-body[data-v-08972433]{flex:1 1 auto;min-height:0;background:var(--bg);border:1px solid var(--line);border-radius:6px;padding:10px;overflow:auto;white-space:normal;overflow-wrap:anywhere;word-break:break-word}
.aya-news-container[data-v-dfff4c24]{position:relative}

.GensokyoOrigin-Particle{position:absolute;line-height:1;-webkit-user-select:none;user-select:none;opacity:0;filter:drop-shadow(0 0 6px rgba(0,0,0,0.25));animation:GensokyoOrigin-Particle-pop 1.2s ease-out forwards;font-size:16px}@keyframes GensokyoOrigin-Particle-pop{0%{transform:translate(0,0) scale(0.8) rotate(0deg);opacity:0}20%{opacity:1}100%{transform:translate(var(--dx,0),var(--dy,-40px)) scale(1.1) rotate(var(--rot,0deg));opacity:0}}.GensokyoOrigin-Particle--heart{color:#b65ff7;text-shadow:0 0 8px rgba(182,95,247,.7),0 0 4px hsla(0,0%,100%,.8)}.GensokyoOrigin-Particle--skull{color:#222;text-shadow:0 0 6px rgba(0,0,0,.5),0 0 3px #fff}:root[data-theme=dark] .GensokyoOrigin-Particle--skull{color:#714f4f;text-shadow:0 0 7px rgba(185,88,88,.7),0 0 3px rgba(255,210,210,.8)}
.particle-emitter-root{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden}
.styled-progress-bar[data-v-0390f826]{background:var(--bar-bg);border:1px solid var(--line);border-radius:5px;overflow:hidden;position:relative;flex-grow:1}.styled-progress-bar.size-large[data-v-0390f826]{height:10px}.styled-progress-bar.size-small[data-v-0390f826]{height:8px;max-width:80px}.styled-progress-bar .val[data-v-0390f826]{position:absolute;top:0;bottom:0;height:100%;width:0%;background:linear-gradient(90deg,#c0a58a,#8c7b6a);transition:width .3s ease}.styled-progress-bar.rtl .val[data-v-0390f826]{left:auto;right:0}.styled-progress-bar.negative .val[data-v-0390f826]{background:#b00020}.styled-progress-bar.very-hate .val[data-v-0390f826]{background:#000}.styled-progress-bar.very-love .val[data-v-0390f826]{background:linear-gradient(90deg,#7e3ff2,#c084fc)}
.affection-display[data-v-d6059de4]{width:100%}.info-line[data-v-d6059de4]{display:flex;align-items:center;gap:8px;font-size:.9em;margin-bottom:4px}.aff-stage[data-v-d6059de4]{font-size:.9em;color:var(--muted);margin-left:auto}
.GensokyoOrigin-RoleCard-wrapper{position:relative;flex:0 0 220px;min-width:0;background:var(--bg);border:1px solid var(--line);border-radius:6px;padding:10px;scroll-snap-align:start;cursor:pointer;transition:background .2s ease}.GensokyoOrigin-RoleCard-wrapper:hover{background:color-mix(in srgb,var(--bg) 90%,var(--ink) 10%)}.GensokyoOrigin-RoleCard-header{display:flex;align-items:center;gap:10px;margin-bottom:8px;padding-bottom:8px;border-bottom:1px dashed var(--line)}.GensokyoOrigin-RoleCard-avatar{width:36px;height:36px;border-radius:50%;border:1px solid var(--line);background:var(--avatar-bg);display:grid;place-items:center;font-weight:700;color:var(--muted);flex-shrink:0}.GensokyoOrigin-RoleCard-name{font-weight:700;font-size:.95em}.GensokyoOrigin-RoleCard-meta{font-size:.8em;color:var(--muted)}
.GensokyoOrigin-RoleDetailPopup-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.GensokyoOrigin-RoleDetailPopup-popup{position:relative;width:90vw;max-width:600px;max-height:80vh;overflow-y:auto;background:var(--paper);border:1px solid var(--line);border-radius:12px;padding:24px;box-shadow:0 8px 24px rgba(0,0,0,.2)}.GensokyoOrigin-RoleDetailPopup-close-btn{position:absolute;top:12px;right:12px;width:30px;height:30px;border:none;background:rgba(0,0,0,0);font-size:24px;cursor:pointer;color:var(--muted)}.GensokyoOrigin-RoleDetailPopup-header{display:flex;align-items:center;gap:16px;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid var(--line)}.GensokyoOrigin-RoleDetailPopup-avatar{width:60px;height:60px;border-radius:50%;border:1px solid var(--line);background:var(--avatar-bg);display:grid;place-items:center;font-size:24px;font-weight:700;color:var(--muted);flex-shrink:0}.GensokyoOrigin-RoleDetailPopup-name{font-size:1.5em;font-weight:700}.GensokyoOrigin-RoleDetailPopup-meta{font-size:1em;color:var(--muted)}.GensokyoOrigin-RoleDetailPopup-details-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:16px}.GensokyoOrigin-RoleDetailPopup-section{margin-top:20px;padding-top:16px;border-top:1px dashed var(--line)}.GensokyoOrigin-RoleDetailPopup-section-title{font-size:1.1em;font-weight:700;margin-bottom:8px}.GensokyoOrigin-RoleDetailPopup-section-desc{font-size:.9em;color:var(--muted);margin-bottom:12px}.GensokyoOrigin-RoleDetailPopup-detail-item{background:var(--bg);padding:8px;border-radius:4px;font-size:.95em}.GensokyoOrigin-RoleDetailPopup-detail-item strong{color:var(--muted);margin-right:8px}.GensokyoOrigin-RoleDetailPopup-detail-item.full-width{grid-column:1/-1}
.role-ribbon-container[data-v-57aa0965]{position:relative;background:var(--paper);border-bottom:1px solid var(--line);padding:10px 40px;max-width:100%;overflow-x:hidden}.role-ribbon[data-v-57aa0965]{display:flex;gap:12px;overflow:auto hidden;scroll-snap-type:x proximity;padding-bottom:6px}.ribbon-arrow[data-v-57aa0965]{position:absolute;top:50%;transform:translateY(-50%);width:26px;height:26px;display:grid;place-items:center;border:1px solid var(--line);background:var(--bg);border-radius:4px;cursor:pointer;z-index:10}.ribbon-arrow.left[data-v-57aa0965]{left:8px}.ribbon-arrow.right[data-v-57aa0965]{right:8px}.role-card-placeholder[data-v-57aa0965]{flex:0 0 260px;padding:16px;background:var(--bg);border:1px dashed var(--line);border-radius:6px;color:var(--muted);display:grid;place-items:center}
.emoji[data-v-37a35e60]{margin-right:0;font-size:1.1em}.banner-chip[data-v-37a35e60]{display:inline-flex;align-items:center;gap:.5em;padding:6px 10px;background:color-mix(in srgb,var(--paper) 90%,var(--tab-active) 10%);border:1px solid var(--line);border-radius:999px;font-weight:700;color:var(--ink);cursor:pointer;-webkit-user-select:none;user-select:none;transition:transform .08s ease,box-shadow .12s ease,background .2s ease}.banner-chip[data-v-37a35e60]:hover{box-shadow:0 2px 10px rgba(0,0,0,.06)}.banner-chip[data-v-37a35e60]:active{transform:translateY(1px) scale(0.99)}
.banner-chip-open[data-v-a8d897e6]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:10px 16px;background:var(--tab-active);border:1px solid var(--line);border-top-left-radius:10px;border-top-right-radius:10px;font-weight:700;color:var(--ink-bright);cursor:pointer;-webkit-user-select:none;user-select:none}.emoji[data-v-a8d897e6]{font-size:1.2em;margin-right:8px}.close-icon[data-v-a8d897e6]{font-size:.9em;color:var(--ink)}
.cal-day-container[data-v-465be192]{position:relative;display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start;aspect-ratio:1/1;min-width:0;min-height:0}.cal-day-btn[data-v-465be192]{width:100%;height:100%;padding:6px;border:1px solid var(--line);border-radius:8px;background:var(--paper);cursor:pointer;-webkit-user-select:none;user-select:none;transition:background .2s ease,box-shadow .2s ease,transform .06s ease}.cal-day-btn[data-v-465be192]:hover{background:color-mix(in srgb,var(--paper) 92%,black 8%)}.cal-day-btn[data-v-465be192]:active{transform:translateY(1px)}.cal-day-btn.today[data-v-465be192]{outline:2px solid var(--tab-active);outline-offset:0;box-shadow:0 0 0 2px color-mix(in srgb,var(--tab-active) 35%,transparent) inset}.cal-day-btn.has-fest[data-v-465be192]{--fest-color:color-mix(in srgb,var(--tab-active) calc(var(--importance,1) * 20%),transparent);background:color-mix(in srgb,var(--fest-color) 50%,var(--paper) 50%);border-color:var(--fest-color)}.cal-day-btn[data-importance="5"][data-v-465be192]{--importance:5}.cal-day-btn[data-importance="4"][data-v-465be192]{--importance:4}.cal-day-btn[data-importance="3"][data-v-465be192]{--importance:3}.cal-day-btn[data-importance="2"][data-v-465be192]{--importance:2}.cal-day-btn[data-importance="1"][data-v-465be192]{--importance:1}.dnum[data-v-465be192]{font-weight:800;color:var(--ink);text-align:right;line-height:1}.cal-day-placeholder[data-v-465be192]{width:100%;height:100%;border-radius:8px;background:color-mix(in srgb,var(--paper) 95%,black 5%)}.fest-popover[data-v-465be192]{position:absolute;bottom:calc(100% + 8px);left:50%;transform:translateX(-50%);width:250px;padding:12px;background:var(--bg);border:1px solid var(--line);border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.1);z-index:10;pointer-events:none;display:flex;flex-direction:column;gap:8px}.fest-item[data-v-465be192]{border-top:1px solid var(--line);padding-top:8px}.fest-item[data-v-465be192]:first-child{border-top:none;padding-top:0}.fest-header[data-v-465be192]{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:6px}.fest-header strong[data-v-465be192]{font-weight:bold;color:var(--ink-bright)}.fest-host[data-v-465be192]{font-size:.85em;color:var(--muted)}.fest-customs[data-v-465be192]{list-style-type:disc;padding-left:20px;margin:0;font-size:.9em;color:var(--ink);display:flex;flex-direction:column;gap:4px}
.cal-content[data-v-40fd130e]{position:static;width:100%;max-height:none;margin-top:-1px;padding:12px;background:var(--paper);border:1px solid var(--line);border-top:0;border-bottom-left-radius:10px;border-bottom-right-radius:10px;box-shadow:none;overflow:visible}.cal-head[data-v-40fd130e]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--line)}.cal-title[data-v-40fd130e]{display:flex;align-items:baseline;gap:.5em;color:var(--ink)}.cal-title .month[data-v-40fd130e]{font-size:1.25em;font-weight:800}.cal-title .year[data-v-40fd130e]{font-size:.95em;color:var(--muted)}.cal-nav[data-v-40fd130e]{display:flex;gap:6px}.cal-btn[data-v-40fd130e]{cursor:pointer;-webkit-user-select:none;user-select:none;border:1px solid var(--line);background:var(--paper);border-radius:8px;padding:6px 10px;font-weight:700}.cal-btn[data-v-40fd130e]:active{transform:translateY(1px)}.cal-body[data-v-40fd130e]{padding:10px 12px 12px}.cal-week[data-v-40fd130e]{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:6px;margin-bottom:6px;color:var(--muted);font-weight:700}.cal-week .w[data-v-40fd130e]{text-align:center;padding:4px 0;border-bottom:1px dashed var(--line)}.cal-grid[data-v-40fd130e]{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:6px;align-items:stretch;position:relative}
.time-container[data-v-517ae222]{position:relative}

.banner-chip[data-v-1ca16986]{display:inline-flex;align-items:center;gap:.65em;padding:8px 14px;background:color-mix(in srgb,var(--paper) 90%,var(--tab-active) 10%);border:1px solid var(--line);border-radius:999px;font-weight:700;color:var(--ink);cursor:pointer;-webkit-user-select:none;user-select:none;transition:transform .08s ease,box-shadow .12s ease,background .2s ease;min-width:150px}.banner-chip[data-v-1ca16986]:hover:not(.banner-chip--disabled){box-shadow:0 2px 10px rgba(0,0,0,.06)}.banner-chip[data-v-1ca16986]:active:not(.banner-chip--disabled){transform:translateY(1px) scale(0.99)}.banner-chip--disabled[data-v-1ca16986]{cursor:not-allowed;opacity:.6}.emoji[data-v-1ca16986]{font-size:1.2em}.summary[data-v-1ca16986]{font-size:1em}
.banner-chip-open[data-v-08143b0d]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:12px 16px;background:var(--tab-active);border:1px solid var(--line);border-top-left-radius:10px;border-top-right-radius:10px;font-weight:700;color:var(--ink-bright);cursor:pointer;-webkit-user-select:none;user-select:none}.open-left[data-v-08143b0d]{display:flex;align-items:center;gap:10px}.open-text[data-v-08143b0d]{display:flex;flex-direction:column;gap:2px}.emoji[data-v-08143b0d]{font-size:1.2em}.title[data-v-08143b0d]{font-size:1em}.summary[data-v-08143b0d]{font-size:.78em;color:color-mix(in srgb,var(--ink-bright) 70%,white 30%)}.close-icon[data-v-08143b0d]{font-size:.9em;color:var(--ink)}
.weather-content[data-v-790cabf0]{width:100%;padding:16px;background:var(--paper);border:1px solid var(--line);border-top:0;border-bottom-left-radius:10px;border-bottom-right-radius:10px;color:var(--ink);display:flex;flex-direction:column;gap:16px}.current-weather[data-v-790cabf0]{display:flex;flex-direction:column;gap:10px}.current-header[data-v-790cabf0]{display:flex;align-items:center;justify-content:space-between;gap:10px}.header-left[data-v-790cabf0]{display:flex;align-items:baseline;gap:8px}.label[data-v-790cabf0]{font-weight:700}.date[data-v-790cabf0]{font-size:0.85em;color:var(--muted)}.temperature[data-v-790cabf0]{font-size:1.1em;font-variant-numeric:tabular-nums}.current-body .condition[data-v-790cabf0]{font-size:1em;font-weight:600}.current-body .narrative[data-v-790cabf0]{margin-top:2px;color:var(--muted);font-size:0.9em}.current-stats[data-v-790cabf0]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px;padding:0;margin:0;list-style:none}.current-stats li[data-v-790cabf0]{padding:8px 10px;background:color-mix(in srgb,var(--tab-active) 15%,transparent);border-radius:8px;display:flex;flex-direction:column;gap:4px;font-size:0.85em}.current-stats strong[data-v-790cabf0]{font-size:1.05em}.forecast-list[data-v-790cabf0]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px}.forecast-item[data-v-790cabf0]{padding:10px;border:1px solid color-mix(in srgb,var(--line) 70%,transparent);border-radius:8px;display:flex;flex-direction:column;gap:4px;background:color-mix(in srgb,var(--paper) 80%,var(--tab-active) 20%)}.forecast-item .condition[data-v-790cabf0]{font-weight:600}.forecast-item .temp[data-v-790cabf0]{font-size:0.95em}.forecast-item .meta[data-v-790cabf0]{font-size:0.8em;color:var(--muted)}.generated-at[data-v-790cabf0]{font-size:0.78em;color:var(--muted);text-align:right}

.weather-container[data-v-28493e2c]{position:relative}.weather-empty[data-v-28493e2c]{padding:16px;background:var(--paper);border:1px solid var(--line);border-top:0;border-bottom-left-radius:10px;border-bottom-right-radius:10px;color:var(--muted);font-size:0.95em}

.emoji[data-v-6184098d]{margin-right:8px;font-size:1.1em}.status-banner[data-v-6184098d]{display:flex;align-items:center;gap:12px;flex-wrap:wrap;margin:8px 10px 6px;padding:10px 12px;background:var(--paper);border:1px solid var(--line);border-radius:10px;box-shadow:0 1px 0 rgba(0,0,0,.03),0 6px 18px rgba(0,0,0,.05);position:relative}.status-banner .banner-title[data-v-6184098d]{display:flex;align-items:center;gap:8px;color:var(--muted);font-weight:700;margin-right:6px}.status-banner .banner-title .emoji[data-v-6184098d]{margin-right:0}.banner-sep[data-v-6184098d]{width:1px;height:18px;background:var(--line);align-self:center;margin:0 2px}:root[data-theme="dark"]{box-shadow:0 1px 0 rgba(0,0,0,.1),0 6px 18px rgba(0,0,0,.2)}
.theme-toggle[data-v-676236f6]{position:absolute;top:8px;right:8px;width:34px;height:34px;display:grid;place-items:center;border-radius:8px;border:1px solid var(--line);background:var(--paper);color:var(--muted);font-size:18px;cursor:pointer;-webkit-user-select:none;user-select:none;transition:transform .05s ease,box-shadow .15s ease,background .15s ease,border-color .15s ease;z-index:20}.theme-toggle[data-v-676236f6]:active{transform:translateY(1px)}.theme-toggle[data-v-676236f6]:focus-visible{outline:none;box-shadow:0 0 0 3px color-mix(in srgb,var(--control-focus) 25%,transparent);border-color:var(--control-focus)}:root[data-theme="light"],:root:not([data-theme]){box-shadow:0 2px 10px rgba(0,0,0,.05)}:root[data-theme="light"],:root:not([data-theme]){background:color-mix(in srgb,var(--paper) 88%,black 12%)}:root[data-theme="dark"]{border-color:color-mix(in srgb,var(--line) 70%,white 30%);background:color-mix(in srgb,var(--paper) 85%,white 0%);color:var(--ink);box-shadow:0 2px 12px rgba(0,0,0,.35)}:root[data-theme="dark"]{background:color-mix(in srgb,var(--paper) 75%,white 0%)}
.user-state-button-closed[data-v-89abe3c0]{padding:8px 12px;border:1px solid var(--line);border-radius:4px;background-color:var(--bg);color:var(--ink);cursor:pointer;width:100%}.user-state-button-closed[data-v-89abe3c0]:hover{background-color:var(--paper)}
.user-state-button-open[data-v-682280a6]{padding:12px 14px;border:1px solid var(--line);border-bottom-left-radius:0;border-bottom-right-radius:0;background-color:var(--bg);color:var(--ink);cursor:pointer;width:100%;box-shadow:0 2px 0 var(--line) inset;transition:padding .15s ease}.user-state-button-open[data-v-682280a6]:hover{background-color:var(--paper)}
.user-state-popup[data-v-9ec113e0]{position:static;width:100%;max-height:none;margin-top:-1px;padding:16px;background:var(--paper);border:1px solid var(--line);border-top:0;border-bottom-left-radius:10px;border-bottom-right-radius:10px;box-shadow:none;display:flex;flex-direction:column}.sidebar-content[data-v-9ec113e0]{overflow:visible}h4[data-v-9ec113e0]{display:flex;align-items:center;height:var(--duo-head-h);margin:0 0 10px;padding:0;line-height:1;font-size:1.1em;color:var(--muted);border-bottom:1px solid var(--line)}h4 .emoji[data-v-9ec113e0]{font-size:1em;line-height:1;display:inline-grid;place-items:center;width:1.25em;height:1.25em;margin-right:8px}p[data-v-9ec113e0]{margin:8px 0;font-size:.9em;line-height:1.5}p>span[data-v-9ec113e0]:last-child{flex:1 1 auto;min-width:0;white-space:normal;overflow-wrap:anywhere;word-break:break-word}
.user-state-container[data-v-0a721dc0]{position:relative}

.status-ui-container{position:relative;display:flex;flex-direction:column;margin:10px;border:1px solid var(--line);border-radius:4px;overflow-x:hidden;overflow-y:visible;background:var(--bg)}.status-main-content{flex:1;display:flex;flex-direction:column;min-height:0;overflow:visible}.status-duo{display:flex;flex-wrap:nowrap;align-items:flex-start;gap:10px;overflow-x:auto;overflow-y:visible;border-bottom:1px dashed var(--line);padding:12px;margin-bottom:12px;width:100%}@media (min-width:1100px){.status-ui-container{display:grid;grid-template-columns:380px minmax(0,1fr);grid-template-rows:auto;grid-auto-rows:auto}.status-duo{grid-column:1;grid-row:1;flex-direction:column;align-items:stretch;overflow-y:visible;overflow-x:hidden;border-right:1px dashed var(--line);border-bottom:none;padding:12px;margin-bottom:0;max-height:none}.status-main-content{grid-column:2}.status-duo>.user-state-container{flex:0 0 auto;border-right:none;border-bottom:1px solid var(--line)}}@media (max-width:768px){.status-ui-container{flex-direction:column;margin:5px}}
/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */:root{--duo-head-h:38px}*{box-sizing:border-box}body{margin:0;font-family:"Noto Serif SC",serif;color:var(--ink);font-size:14px;background:linear-gradient(var(--grid) 1px,transparent 1px),linear-gradient(90deg,var(--grid) 1px,transparent 1px),var(--bg);background-size:20px 20px}.preserve-format{white-space:pre-wrap;overflow-wrap:anywhere;word-break:break-word}.label{font-weight:600;color:var(--muted);min-width:90px;margin-right:5px}hr.dashed{border:none;border-top:1px dashed var(--line);margin:20px 0}html,body,.status-ui-container,.status-main-content,.status-tab-content-area,.role-ribbon-container{max-width:100%;overflow-x:hidden}#content_main,#main-content{max-width:100%;contain:inline-size}#main-content,#main-content *{max-width:100% !important}#main-content img,#main-content video{height:auto}#main-content table{display:block;overflow-x:auto}#main-content pre{white-space:pre-wrap;overflow-x:auto}.debug-console{font-family:ui-monospace,SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace;background:#0f0f0f;color:#e7e7e7;border:1px solid var(--line);border-radius:4px;padding:10px;height:260px;overflow:auto;white-space:pre-wrap;word-break:break-word}.debug-line{padding:2px 0;border-bottom:1px dashed hsla(0,0%,100%,.08)}.debug-badge{font-size:.75em;padding:2px 6px;border-radius:10px;margin-right:6px;background:#333;color:#eee}.debug-line.warn .debug-badge{background:#9b7b2f}.debug-line.error .debug-badge{background:#b2453d}.debug-stats{font-size:.85em;color:#cfcfcf;margin:6px 0 0;opacity:.9}:root,:root[data-theme=light]{--bg:#fffdf7;--paper:#fcfaf5;--ink:#4a3f35;--muted:#6b5a4b;--line:#d3c8b8;--tile:#e0d5c4;--pad:12px;--control-bg:#fff7e8;--control-border:#c9b59e;--control-focus:#b6782b;--btn-accent:#b76e2b;--btn-accent-hover:#a95f1e;--btn-muted:#efe8de;--btn-muted-border:#d3c8b8;--grid:rgba(224,213,196,0.1);--avatar-bg:#f5f1e8;--bar-bg:#f0ece4;--tab-active:#8c7b6a;--cal-cell-bg:var(--bg);--cal-cell-border:var(--line);--cal-hover-bg:var(--paper);@supports (color:color-mix(in lab,red,red)){--cal-hover-bg:color-mix(in srgb,var(--paper) 88%,black 12%)}--cal-festival-bg:var(--btn-accent);@supports (color:color-mix(in lab,red,red)){--cal-festival-bg:color-mix(in srgb,var(--btn-accent) 10%,white 90%)}--cal-festival-border:var(--btn-accent);@supports (color:color-mix(in lab,red,red)){--cal-festival-border:color-mix(in srgb,var(--btn-accent) 30%,white 70%)}--cal-festival-text:var(--btn-accent);@supports (color:color-mix(in lab,red,red)){--cal-festival-text:color-mix(in srgb,var(--btn-accent) 75%,black 25%)}--cal-today-ring:var(--control-focus)}:root[data-theme=dark]{--bg:#13110f;--paper:#1b1916;--ink:#efe8de;--muted:#b7a899;--line:#4b433a;--tile:#2a241e;--pad:12px;--control-bg:#1f1b16;--control-border:#5b4e41;--control-focus:#d89a4a;--btn-accent:#c57a33;--btn-accent-hover:#b56b24;--btn-muted:#2a241e;--btn-muted-border:#4b433a;--grid:rgba(255,255,255,0.04);--avatar-bg:#1f1b17;--bar-bg:#2a2520;--tab-active:#c8b49d;--cal-cell-bg:var(--paper);@supports (color:color-mix(in lab,red,red)){--cal-cell-bg:color-mix(in srgb,var(--paper) 92%,black 8%)}--cal-cell-border:var(--line);@supports (color:color-mix(in lab,red,red)){--cal-cell-border:color-mix(in srgb,var(--line) 85%,white 15%)}--cal-hover-bg:var(--paper);@supports (color:color-mix(in lab,red,red)){--cal-hover-bg:color-mix(in srgb,var(--paper) 80%,white 0%)}--cal-festival-bg:var(--btn-accent);@supports (color:color-mix(in lab,red,red)){--cal-festival-bg:color-mix(in srgb,var(--btn-accent) 14%,var(--paper) 86%)}--cal-festival-border:var(--btn-accent);@supports (color:color-mix(in lab,red,red)){--cal-festival-border:color-mix(in srgb,var(--btn-accent) 45%,var(--line) 55%)}--cal-festival-text:var(--btn-accent);@supports (color:color-mix(in lab,red,red)){--cal-festival-text:color-mix(in srgb,var(--btn-accent) 80%,white 20%)}--cal-today-ring:var(--control-focus)}@media (max-width:480px){.calendar-day .fest{font-size:.75em}}
</style></head><body><div id="app"></div></body></html>